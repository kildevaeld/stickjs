!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("orange"),require("templ"),require("collection"),require("orange.request"),require("orange.dom")):"function"==typeof define&&define.amd?define(["orange","templ","collection","orange.request","orange.dom"],t):"object"==typeof exports?exports.stick=t(require("orange"),require("templ"),require("collection"),require("orange.request"),require("orange.dom")):e.stick=t(e.orange,e.templ,e.collection,e.orange.request,e.orange.dom)}(this,function(e,t,n,r,o){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}n(1),n(51);var o=n(7);t.decorators=o,r(n(41)),r(n(1));var i=n(51);t.template=i,r(n(51))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(2)),r(n(44)),r(n(48)),r(n(50))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},s=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},c=n(3),u=n(6),l=n(7),f=n(24),h=n(38),p=n(41),d=n(8);p.decorator("route",function(){return function(e){if(!d.isDependencyType(e,d.DependencyType.Controller))throw new Error("[route] target not a controller")}});var y=function g(){r(this,g),this.execute=null,this.pushState=!1};t.RouterOptions=y;var v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),n.execute=n.execute||u.bind(this.__execute,this),this.router=new c.Router(n),this.container=t,this.router.history.start()}return o(e,[{key:"setTarget",value:function(e){"string"==typeof e&&(e=document.querySelector(e)),this.target=e}},{key:"swapElements",value:function(e,t){return this.swap?void this.swap(e,t):(e.innerHTML="",void e.appendChild(t))}},{key:"else",value:function(e){"function"!=typeof e&&(e=this.__handleController(e)),this.router.history.on("route:unmatched",e)}},{key:"route",value:function(e,t){return"function"==typeof t?this.router.route(e,t):u.isObject(t)&&this.router.route(e,this.__handleController(t)),this}},{key:"reload",value:function(){var e=this;setTimeout(function(){e.router.history.loadUrl()||e.router.history.trigger("route:unmatched")})}},{key:"navigate",value:function(e,t){this.router.navigate(e,t)}},{key:"__execute",value:function(e,t,n){this.container.hasHandler("$route")&&this.container.unregister("$route"),this.container.registerInstance("$route",{fragment:t,parameters:n}),u.callFunc(e,this,n)}},{key:"__handleController",value:function(e){var t=this;if(!this.container.hasHandler(e.controller,!0,!0))throw new Error("[router] controller");return function(){return s(t,void 0,void 0,regeneratorRuntime.mark(function n(){var t,r,o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t=void 0,t="string"==typeof e.target?document.querySelector(e.target):e.target&&e.target instanceof Element?e.target:"string"==typeof this.target?document.querySelector(this.target):this.target,null!=t){n.next=4;break}throw new Error("[router] target not defined");case 4:return n.next=6,this.container.get(e.controller);case 6:if(r=n.sent,null!=r&&(r instanceof f.ControllerFactory||r instanceof h.ModuleFactory)){n.next=9;break}throw new Error(e.controller+" not a controller");case 9:return n.next=11,r.create({template:e.template,parent:this.container});case 11:return o=n.sent,null!=this._currentController&&this._currentController.destroy(),this._currentController=r,n.next=16,r.container.get("template");case 16:i=n.sent,this.swapElements(t,i.section.render());case 18:case"end":return n.stop()}},n,this)}))}}},{key:"$destroy",value:function(){this.container.hasHandler("$route")&&this.container.unregister("$route"),this._currentController&&(this._currentController.destroy(),delete this._currentController)}},{key:"target",get:function(){return this._target},set:function(e){this._target=e}}]),e}();v=a([l.config(y),l.inject("$container","$routerProvider"),l.service("$router")],v),t.RouterService=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function m(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=n(4),l=n(5),f=n(6),h=/\((.*?)\)/g,p=/(\(\?)?:\w+/g,d=/\*\w+/g,y=/[\-{}\[\]+?.,\\\^$|#\s]/g,v=function(e){return!!e&&("object"===("undefined"==typeof e?"undefined":c(e))&&"[object RegExp]"===toString.call(e))},g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.history=new u.HistoryApi(e),n.options=e,n}return i(t,e),a(t,[{key:"route",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(v(e)||(e=this._routeToRegExp(e)),"function"==typeof t&&(r=t,t=""),!r)throw new Error("router: no handler");return this.history.route(e,function(o){var i=n._extractParameters(e,o);n.execute(r,o,i),n.trigger.apply(n,["route:"+t].concat(i)),n.trigger("route",t,i)}),this}},{key:"execute",value:function(e,t,n){e&&(this.options.execute?this.options.execute(e,t,n):f.callFunc(e,this,n))}},{key:"navigate",value:function(e,t){return this.history.navigate(e,t),this}},{key:"_routeToRegExp",value:function(e){return e=e.replace(y,"\\$&").replace(h,"(?:$1)?").replace(p,function(e,t){return t?e:"([^/?]+)"}).replace(d,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")}},{key:"_extractParameters",value:function(e,t){var n=e.exec(t).slice(1);return n.map(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}},{key:"$destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.history.off()}}]),t}(l.EventEmitter);t.Router=g},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),c=n(6),u=/^[#\/]|\s+$/g,l=/^\/+|\/+$/g,f=/\/$/,h=/[#].*$/,p=function y(){i(this,y)};t.Handler=p;var d=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.handlers=[],n._started=!1,"undefined"!=typeof window&&(n.location=window.location,n.history=window.history),n.checkUrl=c.bind(n.checkUrl,n),n.options=e||{},n}return o(t,e),a(t,[{key:"atRoot",value:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root}},{key:"getHash",value:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""}},{key:"getFragment",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e)if(this._wantsPushState||!this._wantsHashChange){e=decodeURI(this.location.pathname+this.location.search);var t=this.root.replace(f,"");e.indexOf(t)||(e=e.slice(t.length))}else e=this.getHash();return e.replace(u,"")}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.started)throw new Error("Router.history has already been started");this._started=!0,this.options=c.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState;var t=this.getFragment();this.root=("/"+this.root+"/").replace(l,"/"),this._wantsPushState?window.addEventListener("popstate",this.checkUrl,!1):this._wantsHashChange&&window.addEventListener("hashchange",this.checkUrl,!1),this.fragment=t;var n=this.location;if(this._wantsHashChange&&this._wantsPushState&&this.atRoot()&&n.hash&&(this.fragment=this.getHash().replace(u,""),this.history.replaceState({},document.title,this.root+this.fragment)),!this.options.silent)return this.loadUrl()}},{key:"stop",value:function(){window.removeEventListener("popstate",this.checkUrl),window.removeEventListener("hashchange",this.checkUrl),this._started=!1}},{key:"route",value:function(e,t){this.handlers.unshift({route:e,callback:t})}},{key:"checkUrl",value:function(){var e=this.getFragment();return e!==this.fragment&&void(this.loadUrl()||this.trigger("route:unmatched"))}},{key:"loadUrl",value:function(e){return e=this.fragment=this.getFragment(e),this.handlers.some(function(t){return!!t.route.test(e)&&(t.callback(e),!0)})}},{key:"navigate",value:function(e,t){if(!this.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(h,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._wantsPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace)}return t.trigger?this.loadUrl(e):void 0}}},{key:"_updateHash",value:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}},{key:"started",get:function(){return this._started}}]),t}(s.EventEmitter);t.HistoryApi=d},function(e,t){"use strict";function n(){return""+ ++s}function r(e,t){void 0===t&&(t=[]);var n=e.length,r=-1,o=t[0],i=t[1],a=t[2],s=t[3];switch(t.length){case 0:for(;++r<n;)e[r].handler.call(e[r].ctx);return;case 1:for(;++r<n;)e[r].handler.call(e[r].ctx,o);return;case 2:for(;++r<n;)e[r].handler.call(e[r].ctx,o,i);return;case 3:for(;++r<n;)e[r].handler.call(e[r].ctx,o,i,a);return;case 4:for(;++r<n;)e[r].handler.call(e[r].ctx,o,i,a,s);return;default:for(;++r<n;)e[r].handler.apply(e[r].ctx,t);return}}function o(e){return"function"==typeof e}function i(e){return e&&(e instanceof u||o(e.on)&&o(e.once)&&o(e.off)&&o(e.trigger))}var a=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},s=0,c=function(e){function t(t,n,r,o){e.call(this,t),this.message=t,this.method=n,this.klass=r,this.ctx=o}return a(t,e),t.prototype.toString=function(){var e="EventEmitterError";return this.method&&""!=this.method&&(e="EventEmitter#"+this.method),e+": "+this.message},t}(Error);t.EventEmitterError=c,t.callFunc=r,t.isFunction=o,t.isEventEmitter=i;var u=function(){function e(){}return Object.defineProperty(e.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t,n,r){void 0===r&&(r=!1);var o=(this._listeners||(this._listeners={}))[e]||(this._listeners[e]=[]);return o.push({name:e,once:r,handler:t,ctx:n||this}),this},e.prototype.once=function(e,t,n){return this.on(e,t,n,!0)},e.prototype.off=function(e,t){if(this._listeners=this._listeners||{},null==e)this._listeners={};else if(this._listeners[e]){var n=this._listeners[e];if(null==t)this._listeners[e]=[];else for(var r=0;r<n.length;r++){n[r];n[r].handler==t&&this._listeners[e].splice(r,1)}}return this},e.prototype.trigger=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this._listeners=this._listeners||{};var o=(this._listeners[t]||[]).concat(this._listeners.all||[]).concat(this._listeners["*"]||[]);e.debugCallback&&e.debugCallback(this.constructor.name,this.name,t,n,o);for(var i,a,s,c=(o.length,[]),u=[],l=0,f=o.length;l<f;l++)i=o[l],a=n,"all"==o[l].name||"*"==o[l].name?u.push(o[l]):c.push(o[l]),o[l].once===!0&&(s=this._listeners[o[l].name].indexOf(o[l]),this._listeners[o[l].name].splice(s,1));if(u.length){var h=[t].concat(n);this._executeListener(u,h)}return c.length&&this._executeListener(c,n),this},e.prototype._executeListener=function(t,n){e.executeListenerFunction(t,n)},e.prototype.listenTo=function(t,r,o,a,s){if(void 0===s&&(s=!1),!i(t)){if(e.throwOnError)throw new c("obj is not an EventEmitter",s?"listenToOnce":"listenTo",this,t);return this}var u,l,f;return u=this._listeningTo||(this._listeningTo={}),l=t.listenId||(t.listenId=n()),u[l]=t,f=s?"once":"on",t[f](r,o,this),this},e.prototype.listenToOnce=function(e,t,n,r){return this.listenTo(e,t,n,r,!0)},e.prototype.stopListening=function(t,n,r){if(t&&!i(t)){if(e.throwOnError)throw new c("obj is not an EventEmitter","stopListening",this,t);return this}var o=this._listeningTo;if(!o)return this;var a=!n&&!r;r||"object"!=typeof n||(r=this),t&&((o={})[t.listenId]=t);for(var s in o)t=o[s],t.off(n,r,this),!a&&Object.keys(t.listeners).length||delete this._listeningTo[s];return this},e.prototype.destroy=function(){this.stopListening(),this.off()},e.throwOnError=!0,e.executeListenerFunction=function(e,t){r(e,t)},e}();t.EventEmitter=u},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return function(t){var n=e||h.camelcase(t.name);d.Repository.add(f.DependencyType.Controller,n,t)}}function o(e){return function(t){var n=e||h.camelcase(t.name);d.Repository.add(f.DependencyType.Module,n,t)}}function i(e,t){return function(t){var n=e||h.camelcase(t.name);d.Repository.add(f.DependencyType.Service,n,t)}}function a(e){return function(e){}}function s(e){return function(t){p.Metadata.define(f.DIServiceConfig,e,t,void 0)}}function c(e){return function(t){p.Metadata.define(f.Metakey[f.Metakey.Template],e,t,void 0)}}function u(e){return function(t){g("defining component %s, target: %s",e,t.name),y.component(e,t)}}function l(e){return function(t){g("defining attribute %s, target: %s",e,t.name),y.attribute(e,t)}}var f=n(8),h=n(6),p=n(9),d=n(22),y=n(23),v=n(9);t.autoinject=v.autoinject,t.inject=v.inject,t.registration=v.registration,t["transient"]=v["transient"],t.singleton=v.singleton,t.instanceActivator=v.instanceActivator;var g=n(15)("stick:decorators");t.controller=r,t.module=o,t.service=i,t.factory=a,t.config=s,t.template=c,t.component=u,t.attribute=l},function(e,t,n){"use strict";function r(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=p.Metadata.getOwn(p.Metadata.paramTypes,e);if(!n){var r=e.toString().match(d);r&&(n=r[1].replace(/,/," ").split(" ").map(function(e){return e.replace(",","").trim()}).filter(function(e){return""!==e}),t&&p.Metadata.define(p.Metadata.paramTypes,n,e,void 0))}return n||[]}function o(e){var t=void 0;if(e.constructor===Array){var n=e.pop();t=e,e=n,e.inject=t}else{if("function"!=typeof e)return[e,null];if(t=h.result(e,"inject"),!t||0==t.length){var o=e;t=r(e),o.inject=t}}return[e,t]}function i(e){var t=void 0,n=void 0;try{t=e()}catch(r){n=r}return[t,n]}function a(e,t){var n=void 0,r=void 0,o=void 0,a=e.inject;if(!a)return h.Promise.resolve([]);for(n=0,r=a.length;n<r;n++){if(o=i(function(){return t.get(a[n])}),null!=o[1])return h.Promise.reject(o[1]);a[n]=o[0]}return h.Promise.all(a)}function s(e){return function(t){var n=y[y.DependencyType];p.Metadata.define(n,e,t,void 0)}}function c(e){var t=y[y.DependencyType],n=p.Metadata.getOwn(t,e,void 0);return n}function u(e,t){return c(e)===t}function l(e,t){var n=p.Metadata.instanceActivator;p.Metadata.define(n,t,e,void 0)}function f(e,t){var n=p.Metadata.dependencyResolver;p.Metadata.define(n,t,e,void 0)}var h=n(6),p=n(9),d=/function[^(]*\(([^)]*)\)/i;t.getFunctionParameters=r,function(e){e[e.Service=0]="Service",e[e.Module=1]="Module",e[e.Controller=2]="Controller",e[e.Factory=3]="Factory"}(t.DependencyType||(t.DependencyType={}));t.DependencyType;!function(e){e[e.DependencyType=0]="DependencyType",e[e.Template=1]="Template"}(t.Metakey||(t.Metakey={}));var y=t.Metakey;t.DIServiceConfig="mobyjs:service:config",t.getDependencies=o,t.resolveDependencies=a,t.setDependencyType=s,t.getDependencyType=c,t.isDependencyType=u,t.setActivator=l,t.setDependencyResolver=f},function(e,t,n){e.exports=n(10)},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function o(){}o.name||Object.defineProperty(Function.prototype,"name",{get:function(){var e=this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1];return Object.defineProperty(this,"name",{value:e}),e}}),t.Version="0.1.3",r(n(11)),r(n(18)),r(n(21)),r(n(12))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){return"di"+ ++d}function s(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=l.Metadata.getOwn(l.Metadata.paramTypes,e);if(!n){var r=e.toString().match(y);r&&(n=r[1].replace(/\W+/," ").split(" ").map(function(e){return e.replace(",","").trim()}).filter(function(e){return""!==e}),t&&l.Metadata.define(l.Metadata.paramTypes,n,e,void 0))}return n||[]}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(12),l=n(13),f=n(14),h=n(15),p=h("stick:di"),d=0,y=/function[^(]*\(([^)]*)\)/i;t.getFunctionParameters=s;var v=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="BadKeyError",n.message="key not registered with container",n}return i(t,e),t}(f.DIError);t.DIBadKeyError=v,t.emptyParameters=Object.freeze([]);var g=function(){function e(t){r(this,e),this._id=a(),this.entries=new Map,this.constructionInfo=t||new Map,p("Creating new container: %s",this.id)}return c(e,[{key:"makeGlobal",value:function(){return p("%s: Make global",this.id),e.instance=this,this}},{key:"autoRegister",value:function(e,t,n){var r;if(null===e||void 0===e)throw new v("no key");"function"==typeof e?(r=l.Metadata.get(l.Metadata.registration,e,n),void 0!==r?r.register(this,t||e,e):this.registerSingleton(t||e,e,n)):this.registerInstance(e,e)}},{key:"unregister",value:function(e){p("%s: Unregister key: %s",this.id,e),this.entries["delete"](e)}},{key:"hasHandler",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(null===e||void 0===e)throw new v;return this.entries.has(e)||t&&this.parent&&this.parent.hasHandler(e,t)}},{key:"get",value:function(t,n){p("%s: Get %s, target: %s",this.id,String(t),n);var r;if(null===t||void 0===t)throw new v;if(t===e)return this;if(t instanceof u.Resolver)return t.get(this);if(r=this.entries.get(t),void 0!==r)return r[0](this);if(this.parent&&this.parent.hasHandler(t))return p("%s: found key '%s' on parent",this.id,t),this.parent.get(t,n);if("string"==typeof t)throw f.createError("DIResolveError","no component registered for key: "+t);return this.autoRegister(t,n),r=this.entries.get(t),r[0](this)}},{key:"getAll",value:function(e){var t,n=this;if(null===e||void 0===e)throw new v;return t=this.entries.get(e),void 0!==t?t.map(function(e){return e(n)}):this.parent?this.parent.getAll(e):[]}},{key:"createChild",value:function(){var t=new e(this.constructionInfo);return t.parent=this,p("%s: Create child container: %s",this.id,t.id),t}},{key:"resolveDependencies",value:function(e,t){p("%s: Resolve dependencies for: %j",this.id,e.name);var n,r,o=this._getOrCreateConstructionSet(e,t),i=o.keys,a=new Array(i.length);try{for(n=0,r=i.length;n<r;++n)a[n]=this.get(i[n])}catch(s){var c="Error";throw n<r&&(c+=" The argument at index "+n+" (key:"+i[n]+") could not be satisfied."),p("resolve error %s",s),f.createError("DependencyError",c,[s])}return a}},{key:"invoke",value:function(e,t,n){var r=this._getOrCreateConstructionSet(e,n);try{var o,i;return i=r.dependencyResolver?r.dependencyResolver.resolveDependencies(e):this.resolveDependencies(e,n),void 0!==t&&Array.isArray(t)&&(i=i.concat(t)),p("%s: invoking '%s', with dependencies:",this.id,e.name,r.keys),r.activator.invoke(e,i,n,o)}catch(a){var s=r.activator instanceof u.ClassActivator?"instantiating":"invoking",c="Error "+s+" "+e.name+".";throw p("invoke error %s",a),c+=" Check the inner error for details.",f.createError("DIInvokeError",c,[a])}}},{key:"registerInstance",value:function(e,t){p("%s: Register instance %s",this.id,e),this.registerHandler(e,function(e){return t})}},{key:"registerTransient",value:function(e,t,n){p("%s: Register transient %s",this.id,e),this.registerHandler(e,function(e){return e.invoke(t,null,n)})}},{key:"registerSingleton",value:function(e,t,n){p("%s: Register singleton %s",this.id,e);var r;this.registerHandler(e,function(e){return r||(r=e.invoke(t,null,n))})}},{key:"registerHandler",value:function(e,t){this._getOrCreateEntry(e).push(t)}},{key:"_getOrCreateEntry",value:function(e){var t;if(null===e||void 0===e)throw new f.DIError("key cannot be null or undefined.  (Are you trying to inject something that doesn't exist with DI?)");return t=this.entries.get(e),void 0===t&&(t=[],this.entries.set(e,t)),t}},{key:"_getOrCreateConstructionSet",value:function(e,t){var n=this.constructionInfo.get(e);return void 0===n&&(n=this._createConstructionSet(e,t),this.constructionInfo.set(e,n)),n}},{key:"_createConstructionSet",value:function(e,n){var r={activator:l.Metadata.getOwn(l.Metadata.instanceActivator,e,n)||u.ClassActivator.instance,dependencyResolver:l.Metadata.getOwn(l.Metadata.dependencyResolver,e,n)||this};return void 0!==e.inject?("function"==typeof e.inject?r.keys=e.inject():r.keys=e.inject,r):(r.keys=l.Metadata.getOwn(l.Metadata.paramTypes,e,n)||s(e)||t.emptyParameters,r)}},{key:"root",get:function(){for(var e=this,t=e;t;)t=e.parent,t&&(e=t);return e}},{key:"id",get:function(){return this._id}}]),e}();t.DIContainer=g},function(e,t){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){o(this,e),this.key=t}return i(e,[{key:"register",value:function(e,t,n){e.registerTransient(this.key||t,n)}}]),e}();t.TransientRegistration=a;var s=function(){function e(t){var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];o(this,e),"boolean"==typeof t?this.registerInChild=t:(this.key=t,this.registerInChild=n)}return i(e,[{key:"register",value:function(e,t,n){var r=this.registerInChild?e:e.root;r.registerSingleton(this.key||t,n)}}]),e}();t.SingletonRegistration=s;var c=function(){function e(){o(this,e)}return i(e,[{key:"get",value:function(e){throw new Error("A custom Resolver must implement get(container) and return the resolved instance(s).")}}]),e}();t.Resolver=c;var u=function(e){function t(e){o(this,t);var r=n(this,Object.getPrototypeOf(t).call(this));return r.key=e,r}return r(t,e),i(t,[{key:"get",value:function(e){var t=this;return function(){return e.get(t.key)}}}],[{key:"of",value:function(e){return new t(e)}}]),t}(c);t.Lazy=u;var l=function(e){function t(e){o(this,t);var r=n(this,Object.getPrototypeOf(t).call(this));return r.key=e,r}return r(t,e),i(t,[{key:"get",value:function(e){return e.getAll(this.key)}}],[{key:"of",value:function(e){return new t(e)}}]),t}(c);t.All=l;var f=function(e){function t(e){var r=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];o(this,t);var i=n(this,Object.getPrototypeOf(t).call(this));return i.key=e,i.checkParent=r,i}return r(t,e),i(t,[{key:"get",value:function(e){return e.hasHandler(this.key,this.checkParent)?e.get(this.key):null}}],[{key:"of",value:function(e){var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return new t(e,n)}}]),t}(c);t.Optional=f;var h=function(e){function t(e){o(this,t);var r=n(this,Object.getPrototypeOf(t).call(this));return r.key=e,r}return r(t,e),i(t,[{key:"get",value:function(e){return e.parent?e.parent.get(this.key):null}}],[{key:"of",value:function(e){return new t(e)}}]),t}(c);t.Parent=h;var p=function(){function e(){o(this,e)}return i(e,[{key:"invoke",value:function(e,t){return Reflect.construct(e,t)}}]),e}();p.instance=new p,t.ClassActivator=p;var d=function(){function e(){o(this,e)}return i(e,[{key:"invoke",value:function(e,t){return e.apply(void 0,t)}}]),e}();d.instance=new d,t.FactoryActivator=d},function(e,t){(function(e){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e){var t;if(t="function"==typeof e.decorators?e.decorators():e.decorators,"function"!=typeof t._decorate)throw new Error("The return value of your decorator's method was not valid.");delete e.decorators,t._decorate(e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){return"undefined"!=typeof self?self:"undefined"!=typeof e?e:new Function("return this")()}(),a=Object.freeze({});t.metadataContainerKey="__metadata__","undefined"==typeof i.System&&(i.System={isFake:!0}),"undefined"==typeof i.System.forEachModule&&(i.System.forEachModule=function(){}),"undefined"==typeof i.Reflect&&(i.Reflect={}),"undefined"==typeof i.Reflect.getOwnMetadata&&(Reflect.getOwnMetadata=function(e,n,r){return((n[t.metadataContainerKey]||a)[r]||a)[e]}),"undefined"==typeof i.Reflect.defineMetadata&&(Reflect.defineMetadata=function(e,n,r,o){var i=r.hasOwnProperty(t.metadataContainerKey)?r[t.metadataContainerKey]:r[t.metadataContainerKey]={},a=i[o]||(i[o]={});a[e]=n}),"undefined"==typeof i.Reflect.metadata&&(Reflect.metadata=function(e,t){return function(n,r){Reflect.defineMetadata(e,t,n,r)}}),o(i.Reflect.construct)&&(Reflect.construct=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(n(t))))}),t.Metadata={global:i,noop:function(){},paramTypes:"design:paramtypes",properties:"design:properties",instanceActivator:"di:instance-activator",registration:"di:registration",dependencyResolver:"di:dependency-resolver",get:function(e,n,r){if(n){var o=t.Metadata.getOwn(e,n,r);return void 0===o?t.Metadata.get(e,Object.getPrototypeOf(n),r):o}},getOwn:function(e,t,n){if(t)return t.hasOwnProperty("decorators")&&r(t),Reflect.getOwnMetadata(e,t,n)},define:function(e,t,n,r){Reflect.defineMetadata(e,t,n,r)},getOrCreateOwn:function(e,n,r,o){var i=t.Metadata.getOwn(e,r,o);return void 0===i&&(i=new n,Reflect.defineMetadata(e,i,r,o)),i}}}).call(t,function(){return this}())},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t,n){var r=void 0;return r=n?new c(t,n):new s(t),r.name=e,r}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(e){n(this,t);var o=r(this,Object.getPrototypeOf(t).call(this,e));return o.message=e,o}return o(t,e),a(t,[{key:"toString",value:function(){return"["+this.name+": "+this.message+"]"}}]),t}(Error);t.DIError=s;var c=function(e){function t(e,o){n(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e));return i.errors=o,i}return o(t,e),a(t,[{key:"toString",value:function(){for(var e=this.errors,t=void 0;e.length>0;)t=e[e.length-1],e=t.errors||[];return null==t?"["+this.name+": "+this.message+"]":String.prototype.toString.call(t)}}]),t}(s);t.DIAggregateError=c,t.createError=i},function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments);
}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}}function s(){var e;try{e=t.storage.debug}catch(n){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(16),t.log=i,t.formatArgs=o,t.save=a,t.load=s,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(s())},function(e,t,n){function r(){return t.colors[l++%t.colors.length]}function o(e){function n(){}function o(){var e=o,n=+new Date,i=n-(u||n);e.diff=i,e.prev=u,e.curr=n,u=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;s++;var o=t.formatters[r];if("function"==typeof o){var i=a[s];n=o.call(e,i),a.splice(s,1),s--}return n}),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=o.log||t.log||console.log.bind(console);c.apply(e,a)}n.enabled=!1,o.enabled=!0;var i=t.enabled(e)?o:n;return i.namespace=e,i}function i(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&(e=n[o].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function s(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o,t.coerce=c,t.disable=a,t.enable=i,t.enabled=s,t.humanize=n(17),t.names=[],t.skips=[],t.formatters={};var u,l=0},function(e,t){function n(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return i(e,u,"day")||i(e,c,"hour")||i(e,s,"minute")||i(e,a,"second")||e+" ms"}function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;e.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t["long"]?o(e):r(e)}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(13)),r(n(19))},function(e,t,n){"use strict";var r=n(20);t.Decorators={configure:{parameterizedDecorator:function(e,n){t.Decorators[e]=function(){var t=new r.DecoratorApplicator;return t[e].apply(t,arguments)},r.DecoratorApplicator.prototype[e]=function(){var e=n.apply(null,arguments);return this.decorator(e)}},simpleDecorator:function(e,n){t.Decorators[e]=function(){return(new r.DecoratorApplicator).decorator(n)},r.DecoratorApplicator.prototype[e]=function(){return this.decorator(n)}}}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this._first=null,this._second=null,this._third=null,this._rest=null}return r(e,[{key:"decorator",value:function(e){return null===this._first?(this._first=e,this):null===this._second?(this._second=e,this):null===this._third?(this._third=e,this):(null===this._rest&&(this._rest=[]),this._rest.push(e),this)}},{key:"_decorate",value:function(e){var t,n,r;if(null!==this._first&&this._first(e),null!==this._second&&this._second(e),null!==this._third&&this._third(e),r=this._rest,null!==r)for(t=0,n=r.length;t<n;++t)r[t](e)}}]),e}();t.DecoratorApplicator=o},function(e,t,n){"use strict";function r(e){var t=function(e){e.inject=l.Metadata.getOwn(l.Metadata.paramTypes,e)||h.emptyParameters};return e?t(e):t}function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){e.inject=t}}function i(e,t){return function(n){l.Metadata.define(l.Metadata.registration,e,n,t)}}function a(e,t){return i(new f.TransientRegistration(e),t)}function s(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=arguments[2];return i(new f.SingletonRegistration(e,t),n)}function c(e,t){return function(n){l.Metadata.define(l.Metadata.instanceActivator,e,n,t)}}function u(){return c(f.FactoryActivator.instance)}var l=n(18),f=n(12),h=n(11);t.autoinject=r,t.inject=o,t.registration=i,t["transient"]=a,t.singleton=s,t.instanceActivator=c,t.factory=u,l.Decorators.configure.simpleDecorator("autoinject",r),l.Decorators.configure.parameterizedDecorator("inject",o),l.Decorators.configure.parameterizedDecorator("registration",i),l.Decorators.configure.parameterizedDecorator("transient",a),l.Decorators.configure.parameterizedDecorator("singleton",s),l.Decorators.configure.parameterizedDecorator("instanceActivator",c),l.Decorators.configure.parameterizedDecorator("factory",u)},function(e,t,n){"use strict";var r,o=n(8),i=n(6),a=n(9),s=n(15)("stick:container:repository");Function.prototype.toString;!function(e){function t(t,n,r){s("Adding dependency: %s, name: %s",o.DependencyType[t],n);var c=void 0;(c=i.find(e.items,function(e){return e.name==n}))&&e.items.splice(e.items.indexOf(c),1);var u=void 0;try{u=a.Metadata.get(o.DIServiceConfig,r)}catch(l){}if("function"==typeof r&&""==r.name)try{Object.defineProperty(r,"name",{value:n})}catch(l){}e.items.push({name:n,handler:r,type:t,config:u})}function n(e){return!!u(e)}function r(e,t){return!!c(e,t)}function c(t,n){return s("Get dependency: %s, name: %s",o.DependencyType[t],n),i.find(e.items,function(e){return e.name==n&&e.type==t})}function u(t){return i.find(e.items,function(e){return e.name==t})}e.items=[],e.add=t,e.hasAny=n,e.has=r,e.get=c,e.any=u}(r=t.Repository||(t.Repository={}))},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},c=n(6),u=n(5),l=n(25),f=n(26),h=n(15)("stick:factory:controller"),p=function(e,t,n){var r=document.createElement("controller");return r.setAttribute("name",t),n!=t&&r.setAttribute("as",n),r.appendChild(e),r},d=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(a.container=i,a.controller=n,a.name=e,a._id=c.uniqueId("ctrl"),"function"==typeof n&&""==n.name)try{Object.defineProperty(n,"name",{value:e})}catch(s){}return h("%s: Controller factory created: '%s', container %s",a.id,e,a.container.id),a}return i(t,e),a(t,[{key:"create",value:function(e){return s(this,void 0,Promise,regeneratorRuntime.mark(function t(){var n,r,o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.container.hasInstance(this.name)){t.next=2;break}return t.abrupt("return",c.Promise.resolve(this.container.get(this.name)));case 2:return this.container.registerSingleton(this.name,this.controller),n=e.contextName||this.name,t.next=6,this.container.get("$state");case 6:return r=t.sent,r=r.createChild(this.container,e.state),this.container.registerInstance("$state",r,!0),t.next=11,this.resolveTemplate(r,e);case 11:return o=t.sent,h("%s: Created template: %s",this.id,o.id),this.container.registerInstance("template",o,!0),h("%s: Instantiating controller '%s' as '%s'",this.id,this.name,n),t.next=17,this.container.get(this.name);case 17:return i=t.sent,r.set(n,i),o.setTarget(i),this.trigger("before:template:render"),t.next=23,o.render();case 23:return a=t.sent,11!==a.nodeType&&3!==a.nodeType||(a=1===a.children.length?3===a.firstChild.nodeType?p(a,this.name,n):a.firstChild:p(a,this.name,n)),this.container.registerInstance("$el",a,!0),"function"==typeof i.onTemplateRender&&i.onTemplateRender.call(i,a,o),this.trigger("template:render"),e.el&&(this.trigger("before:element:attached",e.el),e.el.innerHTML="",e.el.appendChild(a),"function"==typeof i.onElementAttached&&i.onElementAttached.call(i,a,e.el),this.trigger("element:attached",a,e.el)),t.abrupt("return",i);case 30:case"end":return t.stop()}},t,this)}))}},{key:"resolveTemplate",value:function(e,t){return s(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,o,i,a,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.container.get("$templateCreator");case 2:return r=n.sent,n.next=5,this.container.get("$templateResolver");case 5:if(o=n.sent,i=void 0,!t.el||t.template){n.next=12;break}a=t.el.innerHTML,i=c.Promise.resolve(a),n.next=22;break;case 12:if(!t.template){n.next=21;break}if(!(t.template instanceof f.Template)){n.next=18;break}return n.next=16,t.template.render(e,{container:this.container,parentView:t.parentView});case 16:return s=n.sent,n.abrupt("return",s);case 18:i=o(t.template),n.next=22;break;case 21:return n.abrupt("return",c.Promise.reject(new l.StickError("no element or template")));case 22:return n.next=24,i;case 24:return u=n.sent,n.abrupt("return",r(u,e));case 26:case"end":return n.stop()}},n,this)}))}},{key:"destroy",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h("%s: Destroying controller '%s'",this.id,this.name),e.next=3,this.container.get(this.name);case 3:t=e.sent,"function"==typeof t.onDestroy&&t.onDestroy.call(t),this.container.clear(),this.container.entries.clear();case 7:case"end":return e.stop()}},e,this)}))}},{key:"id",get:function(){return this._id}}]),t}(u.EventEmitter);t.ControllerFactory=d},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(e){function t(e){n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.message=e,o}return o(t,e),t}(Error);t.StickError=i;var a=function(e){function t(e,o){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.errors=o,i}return o(t,e),t}(i);t.StickDependencyError=a},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(27)),r(n(28)),r(n(30)),r(n(33)),r(n(34)),r(n(35)),r(n(37)),r(n(36)),r(n(29))},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t){n(this,e),this.nodeType=8,this.nodeValue=t}return e.prototype.render=function(e){return Promise.resolve(e.document.createComment(this.nodeValue))},e}();t.Comment=r,t.comment=function(e){return new r(e)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(29),i=function(){function e(t,n){r(this,e),this.nodeType=-200,this.vnode=t,this.bindingClass=n,this.vnode.parentNode=this}return e.prototype.render=function(e,t){return e.components.has(this.vnode.tagName)?this._renderComponent(e,t):this._renderElement(e,t)},e.prototype._renderElement=function(e,t){var n=this;return this.vnode.render(e,t).then(function(r){return t.push(new s(r,n.bindingClass,e)),r})},e.prototype._renderComponent=function(e,t){var n=this,r=[];return this.vnode.render(e,r).then(function(o){return t.push(new a(r[0],n.bindingClass,e)),o})},e}();t.Dynamic=i,t.dynamic=function(e,t){return new i(e,t)};var a=function(){function e(t,n,o){r(this,e),this.renderer=t,this.bindingClass=n,this.options=o}return e.prototype.generate=function(e,t){var n=this;return this.renderer.generate(e,t).then(function(){var e=t.bindings[t.bindings.length-1];t.bindings.splice(t.bindings.indexOf(e),0,new n.bindingClass(e,t))})},e}(),s=function(){function e(t,n,o){r(this,e),this.ref=t,this.bindingClass=n,this.options=o}return e.prototype.generate=function(e,t){return this._refPath||(this._refPath=o.getNodePath(this.ref)),t.bindings.push(new this.bindingClass(o.getNodeByPath(e,this._refPath),t)),Promise.resolve()},e}()},function(e,t){"use strict";function n(e,t){for(var n=e,r=0,o=t.length;r<o;r++)n=n.childNodes[t[r]];return n}function r(e){for(var t=[],n=e.parentNode,r=e;n;)for(t.unshift(Array.prototype.indexOf.call(n.childNodes,r)),r=n,n=n.parentNode;n&&n.nodeType>12;)n=n.parentNode;return t}t.getNodeByPath=n,t.getNodePath=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n,r){for(var o in n){var i=t.attributes.get(o),a=new i(e,o,n[o],r);a.update&&r.bindings.push(a)}}var i=n(6),a=n(31),s=n(32),c=function(){function e(t,n,o){r(this,e),this.nodeType=1,this.tagName=String(t).toLocaleLowerCase(),this.childNodes=o,this.attributes=n||{};for(var i=0;i<o.length;i++)o[i].parentNode=this}return e.prototype.render=function(e,t){var n=e.components;return n.has(this.tagName)?this._renderComponent(n.get(this.tagName),e,t):this._renderElement(e,t)},e.prototype.setAttributes=function(e,t){"string"==typeof e?this.attributes[e]=t:i.extend(this.attributes,e)},e.prototype._renderComponent=function(e,t,n){var r=new a.FragmentSection(t.document);return n.push(new u(e,r,this,this._splitAttributes(t),t)),Promise.resolve(r.render())},e.prototype._renderElement=function(e,t){var n=e.document.createElement(this.tagName),r=this._splitAttributes(e);for(var o in r.staticAttributes)n.setAttribute(o,r.staticAttributes[o]);var i=this.childNodes.map(function(n){return n.render(e,t)});return Promise.all(i).then(function(o){return o.forEach(function(e){n.appendChild(e)}),Object.keys(r.dynamicAttributes).length&&t.push(new l(new s.NodeSection(e.document,n),e,r.dynamicAttributes)),n})},e.prototype._splitAttributes=function(e){var t={},n={};if(e.attributes)for(var r in this.attributes){var o=e.attributes.get(r);!o||o.test&&!o.test(this,r,this.attributes[r])?n[r]=this.attributes[r]:t[r]=this.attributes[r]}else n=this.attributes;return{dynamicAttributes:t,staticAttributes:n}},e}();t.Element=c,t.element=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return new c(e,t,r)};var u=function(){function e(t,n,o,i,a){r(this,e),this.section=n,this.componentClass=t,this.element=o,this.options=a,this.attributes=i.staticAttributes,this.dynamicAttributes=i.dynamicAttributes}return e.prototype.generate=function(e,t){this._marker||(this._marker=this.section.createMarker());var n=new this.componentClass(this._marker.createSection(e),this.element,this.attributes,t);return Object.keys(this.dynamicAttributes).length&&o(n,this.options,this.dynamicAttributes,t),n.update&&t.bindings.push(n),n.initialize()},e}(),l=function(){function e(t,n,o){r(this,e),this.section=t,this.options=n,this.attributes=o}return e.prototype.generate=function(e,t){return this._marker||(this._marker=this.section.createMarker()),o(this._marker.findNode(e),this.options,this.attributes,t),Promise.resolve()},e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(29),i=function(){function e(t,n,o){if(r(this,e),this.document=t,this.start=n||t.createTextNode(""),this.end=o||t.createTextNode(""),!this.start.parentNode){var i=t.createDocumentFragment();i.appendChild(this.start),i.appendChild(this.end),this.__parent=i}}return e.prototype.appendChild=function(e){this.end.parentNode.insertBefore(e,this.end)},e.prototype.render=function(){return this.start.parentNode},e.prototype.remove=function(){var e=this.removeChildNodes();return e.insertBefore(this.start,e.childNodes[0]),e.appendChild(this.end),this},e.prototype.removeChildNodes=function(){for(var e=this.document.createDocumentFragment(),t=this.start,n=t.nextSibling,r=this.end;n!==r;)e.appendChild(n),n=t.nextSibling;return e},e.prototype.createMarker=function(){return new a(this.document,o.getNodePath(this.start),o.getNodePath(this.end))},e.prototype.clone=function(){var t;if(11===this.start.parentNode.nodeType)t=this.start.parentNode.cloneNode(!0);else{t=this.document.createDocumentFragment();for(var n=this._getChildNodes(),r=n.length,o=0;o<r;o++)t.appendChild(n[o].cloneNode(!0))}var i=t.childNodes[0],a=t.childNodes[t.childNodes.length-1];return new e(this.document,i,a)},e.prototype._getChildNodes=function(){for(var e=this.start,t=this.end.nextSibling,n=[];e!==t;)n.push(e),e=e.nextSibling;return n},e}();t.FragmentSection=i;var a=function(){function e(t,n,o){r(this,e),this.document=t,this.startPath=n,this.endPath=o}return e.prototype.createSection=function(e){return new i(this.document,o.getNodeByPath(e,this.startPath),o.getNodeByPath(e,this.endPath))},e}();t.FragmentSectionMarker=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(29),i=function(){function e(t,n){r(this,e),this.document=t,this.node=n}return e.prototype.createMarker=function(){return new a(this.document,o.getNodePath(this.node))},e.prototype.appendChild=function(e){this.node.appendChild(e)},e.prototype.render=function(){return this.node},e.prototype.remove=function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},e.prototype.removeChildren=function(){for(;this.node.childNodes.length;)this.node.removeChild(this.node.childNodes[0])},e.prototype.clone=function(){return new e(this.document,this.node.cloneNode(!0))},e}();t.NodeSection=i;var a=function(){function e(t,n){r(this,e),this.document=t,this.path=n}return e.prototype.createSection=function(e){return new i(this.document,this.findNode(e))},e.prototype.findNode=function(e){return o.getNodeByPath(e,this.path)},e}();t.NodeSectionMarker=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},o=function(){function e(t){n(this,e),this.nodeType=11,this.childNodes=t;for(var r=0;r<t.length;r++)t[r].parentNode=this}return e.prototype.render=function(e,t){return r(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,o,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=e.document.createDocumentFragment(),o=0,i=this.childNodes.length;case 2:if(!(o<i)){n.next=10;break}return n.next=5,this.childNodes[o].render(e,t);case 5:a=n.sent,r.appendChild(a);case 7:o++,n.next=2;break;case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n,this)}))},e}();t.Fragment=o,t.fragment=function(e){return new o(e)}},function(e,t,n){"use strict";function r(e,t){var n=void 0;if(11==t.nodeType){var r=new o.FragmentSection(e);r.appendChild(t),n=r}else n=new i.NodeSection(e,t);return n}var o=n(31),i=n(32);t.section=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return new c(e,t)}var i=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},a=n(34),s=n(36),c=function(){function e(t,n){r(this,e),this._renderers=[],this.vnode=t,this.options=n}return e.prototype.render=function(e,t){var n=this;return this.vnode.render(this.options,this._renderers).then(function(r){return n.section=a.section(n.options.document,r),n.view(e,t)})},e.prototype.view=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return i(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,o,i,a,c,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=this.section){n.next=2;break}throw new Error("must call render before view");case 2:r=this.section.clone(),o=this.options.viewClass||s.View;for(i in this.options)t[i]||(t[i]=this.options[i]);a=new o(r,this,e,t),c=0,u=this._renderers.length;case 7:if(!(c<u)){n.next=13;break}return n.next=10,this._renderers[c].generate(r.node||r.start.parentNode,a);case 10:c++,n.next=7;break;case 13:return n.abrupt("return",a);case 14:case"end":return n.stop()}},n,this)}))},e}();t.Template=c,t.template=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(5),s=function(e){function t(n,i,a,s){r(this,t);var c=o(this,e.call(this));return c.section=n,c.template=i,c.bindings=[],c._runloop=s.runloop,c.context=a,c}return i(t,e),t.prototype.update=function(){return Promise.all(this.bindings.map(function(e){return e.update()})).then(function(e){})},t.prototype.addListener=function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];return e.addEventListener(t,n,r),n},t.prototype.removeListener=function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];e.removeEventListener(t,n,r)},t.prototype.render=function(){return Promise.resolve(this.section.render())},t.prototype.remove=function(){for(var e=this.bindings,t=Array.isArray(e),n=0,e=t?e:e[Symbol.iterator]();;){var r;if(t){if(n>=e.length)break;r=e[n++]}else{if(n=e.next(),n.done)break;r=n.value}var o=r;o.destroy()}return this.section.remove()},t}(a.EventEmitter);t.View=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t){n(this,e),this.nodeType=-201,this.nodeValue=t}return e.prototype.render=function(e){return Promise.resolve(e.document.createTextNode(this.nodeValue))},e}();t.Text=r,t.text=function(e){return new r(e)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},u=n(8),l=n(5),f=n(22),h=n(25),p=n(9),d=n(6),y=n(26),v=n(39),g=n(24),m=n(15)("stick:factory:module"),b=function(e,t){var n=document.createElement("module");return n.setAttribute("name",t),n.appendChild(e),n},w=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(3!=arguments.length)throw new Error;if(a.name=e,a.module=n,a.container=i,"function"==typeof n&&""==n.name)try{Object.defineProperty(n,"name",{value:e})}catch(s){}return a._id=d.uniqueId("mod"),m("%s: Module factory created: '%s', container: %s",a.id,e,a.container.id),a.container.registerSingleton(e,n),a.container.registerInstance("$container",a.container),a}return i(t,e),s(t,[{key:"controller",value:function(e,t){var n=u.getDependencies(t),r=a(n,2),o=r[0],i=r[1];if(!o)throw new h.StickError("controller definition should be a function, function constructor or a object literal");var s=void 0;if("function"!=typeof o&&d.isObject(o)){var c=d.extend({},o);"function"==typeof o.initialize?(s=o.initialize,delete c.initialize):"function"==typeof o.constructor&&(s=o.constructor,delete c.constructor),i&&0!=i.length||u.getDependencies(s),d.assign(s.prototype,c)}else"function"==typeof o&&(s=o);if("function"!=typeof s)throw new h.StickError("controller defition should be a function or an object literal");u.setDependencyType(u.DependencyType.Controller)(s);var l=new g.ControllerFactory(e,s,this.container.createChild());return this.container.registerInstance(e,l,!0),m("%s: Register controller: '%s', %s",this.id,e,l.id),this}},{key:"service",value:function(e,t){var n=u.getDependencies(t),r=a(n,1),o=r[0];if(!o||"function"!=typeof o)throw new h.StickError("service should be a function");return u.setDependencyType(u.DependencyType.Service)(o),this.container.registerService(e,o),m("%s Register service %s",this.id,e),this}},{key:"factory",value:function(e,t){var n=u.getDependencies(t),r=a(n,1),o=r[0];if(!o)throw new h.StickError("factory");return m("%s Register factory %s",this.id,e),"function"==typeof o?(u.setDependencyType(u.DependencyType.Factory)(o),u.setActivator(o,p.FactoryActivator.instance),this.container.registerSingleton(e,o)):this.container.registerInstance(e,o),this}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,void 0,Promise,regeneratorRuntime.mark(function t(){var n,r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.container.hasInstance(this.name)){t.next=3;break}return m("%s: Resolving module %s",this.id,this.name),t.abrupt("return",this.container.get(this.name));case 3:return this.container.registerSingleton("$state",v.State),t.next=6,this.container.get("$state");case 6:if(n=t.sent,e.state&&n.set(e.state),m("%s: Creating module %s",this.id,this.name),!e.template&&!e.el){t.next=30;break}return t.next=12,this.resolveTemplate(n,e);case 12:return r=t.sent,m("%s: Created template: %s",this.id,r.id),this.container.registerInstance("template",r,!0),m("%s: Instantiating module '%s'",this.id,this.name),t.next=18,this.container.get(this.name);case 18:return o=t.sent,r.setTarget(o),this.trigger("before:template:render"),t.next=23,r.render();case 23:return i=t.sent,11!==i.nodeType&&3!==i.nodeType||(i=1===i.children.length?3===i.firstChild.nodeType?b(i,this.name):i.firstChild:b(i,this.name)),this.container.registerInstance("$el",i,!0),"function"==typeof o.onTemplateRender&&o.onTemplateRender.call(o,i,r),this.trigger("template:render"),e.el&&(this.trigger("before:element:attached",e.el),e.el.innerHTML="",e.el.appendChild(i),"function"==typeof o.onElementAttached&&o.onElementAttached.call(o,i,e.el),this.trigger("element:attached",i,e.el)),t.abrupt("return",o);case 30:return t.abrupt("return",this.container.get(this.name));case 31:case"end":return t.stop()}},t,this)}))}},{key:"configure",value:function(e){return c(this,void 0,Promise,regeneratorRuntime.mark(function t(){var n,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e,/Provider$/.test(e)?e=e.replace("Provider",""):n=e+"Provider",r=void 0,!this.container.hasHandler(n,!1,!1)){t.next=7;break}return t.abrupt("return",this.container.get(e));case 7:if(!f.Repository.has(u.DependencyType.Service,e)){t.next=12;break}if(o=f.Repository.get(u.DependencyType.Service,e),this.container.register(o),!this.container.hasHandler(n,!1,!1)){t.next=12;break}return t.abrupt("return",this.container.get(n));case 12:throw new Error("No provider for "+e.replace("Provider",""));case 13:case"end":return t.stop()}},t,this)}))}},{key:"resolveTemplate",value:function(e,t){return c(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,o,i,a,s,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.container.get("$templateCreator");case 2:return r=n.sent,n.next=5,this.container.get("$templateResolver");case 5:if(o=n.sent,i=void 0,!t.el||t.template){n.next=12;break}a=t.el.innerHTML,i=d.Promise.resolve(a),n.next=22;break;case 12:if(!t.template){n.next=21;break}if(!(t.template instanceof y.Template)){n.next=18;break}return n.next=16,t.template.render(e,{container:this.container});case 16:return s=n.sent,n.abrupt("return",s);case 18:i=o(t.template),n.next=22;break;case 21:return n.abrupt("return",d.Promise.reject(new h.StickError("no element or template")));case 22:return n.next=24,i;case 24:return c=n.sent,n.abrupt("return",r(c,e));case 26:case"end":return n.stop()}},n,this)}))}},{key:"destroy",value:function(){}},{key:"id",get:function(){return this._id}}]),t}(l.EventEmitter);t.ModuleFactory=w},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0
}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e===Object(e)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function g(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:g(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},f=n(40),h=n(6),p=n(7),d=n(15)("stick:state");t.get_atributes=function(e){var t=Object.keys(e),n={},r={};return t.map(function(t){return{key:t,value:e[t]}}).filter(function(t){return!!h.has(e,t.key)&&(!t.value||!h.isPromise(t.value)||(n[t.key]=t.value,delete e[t.key],!1))}).forEach(function(e){r[e.key]=e.value}),{attr:r,deferred:n}};var y=void 0,v=y=function(e){function n(e,t){r(this,n);var i=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return i._container=e,d("%s: State created",i.uid),i}return i(n,e),s(n,[{key:"get",value:function(e){var t=c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"get",this).call(this,e);return d("%s: Get attribute: %s",this.uid,e,t),t}},{key:"set",value:function(e,r){var o=this,i={array:!1},s={},u={};"string"==typeof e?null==r?u[e]=r:s[e]=r:a(e)&&(s=e);var l=t.get_atributes(s),f=l.attr,p=l.deferred;return h.isEmpty(p)||(d("%s: Resolve deferred values: %j",this.uid,Object.keys(p)),h.objectToPromise(p).then(function(e){o.set(e)})),h.isEmpty(f)||(d("%s: Set attributes: ",this.uid,f),c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"set",this).call(this,f,i)),h.isEmpty(u)||(d("%s: Unset attributes: %j",this.uid,Object.keys(u)),c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"set",this).call(this,u)),this}},{key:"createChild",value:function(e,t){e||(e=this.container.createChild());var n=new y(e,t);return n._parent=n,d("%s: Create child %s",this.uid,n.uid),n}},{key:"$destroy",value:function(){c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"destroy",this).call(this),d("%s: State destroyed",this.uid)}},{key:"parent",get:function(){return this._parent}},{key:"container",get:function(){return this._container}}]),n}(f.NestedModel);v=y=l([p.inject("$container")],v),t.State=v},function(e,t){e.exports=n},function(e,t,n){"use strict";function r(e,t){var n=f.getDependencies(t),r=l(n,1),o=r[0];if(!o||"function"!=typeof o)throw new h.StickError("service should be a function");p.Repository.add(f.DependencyType.Service,e,o)}function o(e,t){var n=f.getDependencies(t),r=l(n,1),o=r[0];if(!o)throw new h.StickError("factory");p.Repository.add(f.DependencyType.Factory,e,o)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null==t){var n=void 0;if(O.hasHandler(e))n=O.get(e);else{if(!p.Repository.has(f.DependencyType.Module,e))throw new h.StickError("no module named "+e);var r=p.Repository.get(f.DependencyType.Module,e);n=new y.ModuleFactory(e,r.handler,O.createChild()),O.registerInstance(e,n)}return n}var o=f.getDependencies(t),i=l(o,2),a=i[0],s=i[1];if(a){var c=void 0;if("function"!=typeof a&&d.isObject(a)){var u=d.extend({},a);"function"==typeof a.initialize?(c=a.initialize,delete u.initialize):"function"==typeof a.constructor&&(c=a.constructor,delete u.constructor),s&&0!=s.length?c.inject=s:f.getDependencies(c),d.assign(c.prototype,u)}else"function"==typeof a&&(c=a);if("function"!=typeof c)throw new h.StickError("controller defition should be a function or an object literal");var v=new y.ModuleFactory(e,c,O.createChild());return O.registerInstance(e,v,!0),v}throw new h.StickError("controller defition should be a function or an object literal")}function a(e,t){var n=void 0;if("function"==typeof t)n=t;else{if(!d.isObject(t)||"function"!=typeof t.initialize)throw new h.StickError("component should be a function or an object");n=d.inherits(g.BaseComponent,t)}w("defining component: %s",e),m.component(e,n)}function s(e,t){w("defining attribute: %s",e),m.attribute(e,t)}function c(e,t){if(d.has(b,e))throw new Error("decorator called "+e+" already defined!");b[e]=t}function u(e,t){w("defining modifier: %s",e),m.modifier(e,t)}var l=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=n(8),h=n(25),p=n(22),d=n(6),y=n(38),v=n(42),g=n(43),m=n(23),b=n(7),w=n(15)("stick"),_=n(22);t.Repository=_.Repository;var k=n(38);t.ModuleFactory=k.ModuleFactory,t.service=r,t.factory=o;var O=new v.Container;t.module=i,t.component=a,t.attribute=s,t.decorator=c,t.modifier=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function s(e,t,n){var r=void 0,o=void 0;try{r=y.callFunc(e,t,n)}catch(i){o=i}return[r,o]}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function m(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},f=n(9),h=n(25),p=n(22),d=n(8),y=n(6),v=n(24);a(n(9)),t.tryCatch=s;var g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.__instances=new Map,n}return i(t,e),c(t,[{key:"hasInstance",value:function(e){return this.__instances.has(e)}},{key:"hasHandler",value:function(e,n,r){var o=u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hasHandler",this).call(this,e,n);return!o&&r?p.Repository.hasAny(e):o}},{key:"get",value:function(e,n){return l(this,void 0,Promise,regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!==e&&void 0!==e){r.next=2;break}throw new f.DIBadKeyError;case 2:if(e!==f.DIContainer&&e!=t){r.next=4;break}return r.abrupt("return",this);case 4:if(!(e instanceof f.Resolver)){r.next=6;break}return r.abrupt("return",e.get(this));case 6:if(o=this.entries.get(e),void 0===o){r.next=9;break}return r.abrupt("return",o[0](this));case 9:if(!this.parent||!this.parent.hasHandler(e)){r.next=11;break}return r.abrupt("return",this.parent.get(e,n));case 11:if(o=p.Repository.any(e),null==o){r.next=15;break}return this.register(o),r.abrupt("return",this.entries.get(e)[0](this));case 15:if("string"!=typeof e){r.next=17;break}throw new h.StickDependencyError("no component registered for key: "+e);case 17:return this.autoRegister(e,n),o=this.entries.get(e),r.abrupt("return",o[0](this));case 20:case"end":return r.stop()}},r,this)}))}},{key:"registerSingleton",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.registerHandler(e,function(o){if(n.__instances.has(e))return n.__instances.get(e);var i=n.invoke(t,null,r);return y.isPromise(i)?i.then(function(t){return n.__instances.set(e,t),t}):(n.__instances.set(e,i),i)})}},{key:"registerService",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=void 0;o="string"==typeof e?e:e.name;var i=o+"Provider",a=f.Metadata.getOwn(d.DIServiceConfig,t,r);if(null!=a){if(this.hasHandler(i,!1,!1))throw new Error("Provider for '"+o+"' already defined");var s=new a;this.registerInstance(i,s)}return this.registerHandler(e,function(o){if(n.__instances.has(e))return n.__instances.get(e);var a=n.invoke(t,null,r);return n.__instances.set(e,a),n.unregister(i),a})}},{key:"registerInstance",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"registerInstance",this).call(this,e,n),r&&this.__instances.set(e,n)}},{key:"invoke",value:function(e,t,n){var r=this._getOrCreateConstructionSet(e,n);try{var o,i;return i=r.dependencyResolver?r.dependencyResolver.resolveDependencies(e):this.resolveDependencies(e,n),void 0!==t&&Array.isArray(t)&&(i=i.concat(t)),y.arrayToPromise(i).then(function(t){return r.activator.invoke(e,t,n,o)})}catch(a){var s=r.activator instanceof f.ClassActivator?"instantiating":"invoking",c="Error "+s+" "+e.name+".";throw c+=" Check the inner error for details.",new h.StickDependencyError(c,[a])}}},{key:"clear",value:function(){var e=this.__instances.keys(),t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.destroy(a)}}catch(s){n=!0,r=s}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null==e){var n=!0,r=!1,o=void 0;try{for(var i,a=this.__instances.keys()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.destroy(s,t)}}catch(c){r=!0,o=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw o}}return delete this.constructionInfo,void(this.constructionInfo=new Map)}var u=this.__instances.get(e);u?(t?t(u):"function"==typeof u.$destroy&&u.$destroy(),this.__instances["delete"](e),u=void 0):console.log("could not find key ",e)}},{key:"register",value:function(e){switch(e.type){case d.DependencyType.Controller:var t=new v.ControllerFactory(e.name,e.handler,this.createChild());this.registerInstance(e.name,t,!0);break;case d.DependencyType.Service:this.registerService(e.name,e.handler);break;case d.DependencyType.Factory:"function"==typeof e.handler?(d.setActivator(e.handler,f.FactoryActivator.instance),this.registerSingleton(e.name,e.handler)):this.registerInstance(e.name,e.handler)}}},{key:"createChild",value:function(){var e=new t;return e.parent=this,e}}]),t}(f.DIContainer);t.Container=g},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(6),c=n(26),u=n(5),l=function(e){function t(e,n,i,a){r(this,t);var u=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));u.update&&(u.update=s.bind(u.update,u)),u.section=e,u.vnode=n,u.attributes=i,u.view=a,u.document=a.template.options.document,n.childNodes&&(u.childTemplate=c.template(c.fragment(n.childNodes),a.template.options));for(var l in i)u.setAttribute(l,i[l]);u.view.container;return u}return i(t,e),a(t,[{key:"initialize",value:function(){return Promise.resolve()}},{key:"setAttribute",value:function(e,t){this.attributes[e]=t}},{key:"removeAttribute",value:function(e){this.attributes[e]=void 0}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"destroy",value:function(){var e=this;"function"==typeof e.onDestroy?e.onDestroy():"function"==typeof e.ondestroy&&e.ondestroy()}}]),t}(u.EventEmitter);t.BaseComponent=l},function(e,t,n){"use strict";function r(e){var t=document.getElementById(e);return null==t?s.Promise.reject(new Error("template with id: '"+e+"' not found")):s.Promise.resolve(t.innerHTML)}var o=n(41),i=n(45),a=n(23),s=n(6);t.templateResolver=r,o.factory("$templateResolver",function(){return r}),o.factory("$templateCreator",["$templateResolver","$container",function(e,t){return function(e,n){var r=a.compile(e,{viewClass:i.TemplateView});return r.render(n,{container:t})}}])},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function p(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:p(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=n(46),u=n(40),l=n(6),f=n(15)("stick:template:view"),h=function(e){function t(e,n,i,a){r(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,null,a));if(s._onModelChange=l.bind(s._onModelChange,s),s.context=i,a.delegator&&(s._delegator=a.delegator),a.container&&(s._container=a.container),s._target=a.target,s._id=l.uniqueId("templ"),!s.container)throw new Error("template view: no container set");return f("%s: Template view created with state %s",s.id,s.context.uid),s}return i(t,e),a(t,[{key:"setTarget",value:function(e){this._target=e}},{key:"_onModelChange",value:function(e){if(void 0==this.context)return void console.log("context is undefined",e,this);this.context.changed;this.updateLater()}},{key:"set",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r){if(!(this.context instanceof u.Model))return f("set value for %s on object",e),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n),this.updateLater();if(Array.isArray(e)||(e=e.split(/[,.]/)),"this"===e[0])return e.shift(),void(0===e.length?(this.root.context=n,this.root.update()):(this.root.set(e,n),this.root.update()));"root"===e[0]?(e.shift(),this.root.set(e,n)):(f("set value for %s on model",e),this.context.set(e.join("."),n))}this.updateLater()}},{key:"render",value:function(){return f("%s: Render",this.id),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}},{key:"update",value:function(){return f("%s: Update",this.id),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this)}},{key:"get",value:function(e){f("%s: Get value for key: %j",this.id,e,this.context),Array.isArray(e)||(e=e.split(/[,.]/));var n=void 0,r=this.context;return"$root"===e[0]&&(e.shift(),r=this.root.context),e=e.join("."),n||(n=this.context instanceof u.Model?r.get(e):s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"get",this).call(this,e),null==n&&null!=this.target&&(n=this.target[e],"function"==typeof n&&(n=l.bind(n,this.target)))),f("%s: Got value for key '%s': ",this.id,e,n),n}},{key:"remove",value:function(){this._context&&this._context instanceof u.Model&&this._context.off("change",this._onModelChange),f("%s: Remove",this.id),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this)}},{key:"$destroy",value:function(){f("%s: Destroy",this.id),this.remove(),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"id",get:function(){return this._id}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"container",get:function(){return this._container?this._container:this.parent?this.parent.container:void 0}},{key:"context",set:function(e){this._context&&this._context instanceof u.Model&&this._context.off("change",this._onModelChange),this._context=e,null!=e&&e instanceof u.Model&&e.on("change",this._onModelChange,this),this.updateLater()},get:function(){return this._context}},{key:"target",get:function(){return this._target?this._target:this.parent?this.parent.target:void 0}}]),t}(c.View);t.TemplateView=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){for(var r,o="string"==typeof t?t.split("."):t,i=e,a=0,s=o.length-1;a<s;a++)r=o[a],i[r]||(i[r]={}),i=i[r];return i[o[o.length-1]]=n,n}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(26),u=n(47),l=n(15),f=l("templ:view"),h=function(e){function t(n,i,a){var s=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];r(this,t);var c=o(this,e.call(this,n,i,a,s));return c.context=a,c._callers={},c._getters={},s.parent&&(c.parent=s.parent),s.delegator&&(c._delegator=s.delegator),c}return i(t,e),t.prototype.getDelegator=function(){if(this._delegator)return this._delegator;for(var e=this.parent;void 0!=e;){if(e._delegator)return e._delegator;e=e.parent}return null},t.prototype.addListener=function(t,n,r){var o=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=this.getDelegator();return i?i.addListener(t,n,r,o):"function"==typeof r?e.prototype.addListener.call(this,t,n,r,o):void 0},t.prototype.removeListener=function(t,n,r){var o=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=this.getDelegator();i?i.removeListener(t,n,r,o):"function"==typeof r&&e.prototype.removeListener.call(this,t,n,r,o)},t.prototype.get=function(e){if(this.context){var t,n="string"!=typeof e?e.join("."):e;try{var r;(r=this._getters[n])||(r=this._getters[n]=new Function("return this."+n)),t=r.call(this.context)}catch(o){t=void 0}return t=void 0!=t?t:this.parent?this.parent.get(e):void 0,f('get value "%s": %s',e,t),t}},t.prototype.set=function(e,t){if(f("set value %s on context %j",t,this.context),this.context){"string"==typeof e&&(e=e.split("."));a(this.context,e,t);this.updateLater()}},t.prototype.render=function(){var t=this;return e.prototype.render.call(this).then(function(e){return t.update()}).then(function(){return t.section.render()})},t.prototype.updateLater=function(){this._runloop.deferOnce(this)},t.prototype.ref=function(e,t,n){return f("reference %s, gettable: %o, settabble: %o",e,t,n),new u.Reference(this,e,t,n)},t.prototype.assign=function(e,t){return f("assignment %s %s",e,t),new u.Assignment(this,e,t)},t.prototype.call=function(e,t){var n;if(f('call keypath "%s", args: "%o"',e,t),"string"!=typeof e&&(e=e.join(".")),!(n=this._callers[e])){var r=["this"].concat(e.split("."));r.pop(),n=this._callers[e]=new Function("params","return this."+e+".apply("+r.join(".")+", params);")}return new u.Call(this,e,t)},s(t,[{key:"root",get:function(){if(null==this.parent)return this;for(var e=this,t=e;t;)t=t.parent,t&&(e=t);return e}}]),t}(c.View);t.View=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e&&(e instanceof f||"Call"===e.__classType)}function i(e){return e&&(e instanceof u||"Reference"===e.__classType)}function a(e){return e&&(e instanceof l||"Assignment"===e.__classType)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(6),u=function(){function e(t,n,o,i){r(this,e),this.gettable=o,this.settable=i,this.view=t,this.path=n}return e.prototype.value=function(e){return 0===arguments.length?this.gettable?this.view.get(this.path):void 0:void(this.settable&&this.view.set(this.path,e))},e.prototype.toString=function(){return this.view.get(this.path)||""},s(e,[{key:"__classType",get:function(){return"Reference"}}]),e}();t.Reference=u;var l=function(){function e(t,n,o){r(this,e),this.view=t,this.path=n,this.value=o,this.assign=c.bind(this.assign,this),this.toString=c.bind(this.toString,this)}return e.prototype.assign=function(){this.view.set(this.path,this.value.call(this))},e.prototype.toString=function(){var e=this.value.call(this);return e?String(e):""},s(e,[{key:"__classType",get:function(){return"Assignment"}}]),e}();t.Assignment=l;var f=function(){function e(t,n,o){r(this,e),this.view=t,this.keypath=n,this.params=o||[]}return e.prototype.call=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t||[];var r=this.view.get(this.keypath);return null==r||"function"!=typeof r?this.view.trigger("error",this,new Error("function does not exists or is not a function")):r.apply(this.view,this.params.concat(t))},e.prototype.toString=function(){var e=this.call();return e?String(e):""},s(e,[{key:"__classType",get:function(){return"Call"}}]),e}();t.Call=f,t.isCall=o,t.isReference=i,t.isAssignment=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},s=n(7),c=n(49),u=function(){function e(){r(this,e)}return o(e,[{key:"get",value:function(e){return c.get(e)}},{key:"post",value:function(e){return c.post(e)}},{key:"put",value:function(e){return c.put(e)}},{key:"del",value:function(e){return c.del(e)}}]),e}();u=a([s.service("$http")],u),t.HttpService=u},function(e,t){e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t,n,r){var o,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(a<3?o(s):a>3?o(t,n,s):o(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},s=n(7),c=n(5),u=function(){function e(){r(this,e),this.emitter=new c.EventEmitter}return o(e,[{key:"publish",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.emitter).trigger.apply(t,[e].concat(r))}},{key:"subscribe",value:function(e,t,n){this.emitter.on(e,t,n)}},{key:"unsubscribe",value:function(e,t){this.emitter.off(e,t)}}]),e}();u=a([s.service("$mediator")],u),t.Mediator=u},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}var o=n(41);r(n(45)),n(52);var i=n(56);o.component("hide",i.Hide),o.component("show",i.Show),o.component("unsafe",i.Unsafe),o.component("delegate",i.Delegate),r(n(43)),r(n(54));var a=n(47);t.Reference=a.Reference,t.Assignment=a.Assignment,t.Call=a.Call},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(53))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":s(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},u=n(54),l=n(7),f=n(47),h=n(6),p=["change","keyup","input"],d=n(15)("stick:template:attribute:value"),y=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"initialize",value:function(){this._onInput=h.bind(this._onInput,this,null);var e=!0,t=!1,n=void 0;try{for(var r,o=p[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.ref.addEventListener(i,this._onInput)}}catch(a){t=!0,n=a}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw n}}}},{key:"update",value:function(){var e=this.model=this.value;if(!e)return Promise.resolve();if(!(e&&e instanceof f.Reference))throw Promise.reject(new Error("input value must be a reference. Make sure you have <~> defined"));return e.gettable&&this._elementValue(this._parseValue(e.value())),Promise.resolve()}},{key:"_parseValue",value:function(e){if(null!=e&&""!==e)return e}},{key:"_onInput",value:function(e){clearInterval(this._autocompleteCheckInterval),!e||e.keyCode&&~[27].indexOf(e.keyCode)||e.stopPropagation();var t=this._parseValue(this._elementValue());if(this.model){if(h.equal(this.model.value(),t))return void d("input: no change");d("input changed %s",this.model.value(),t),this.model.value(t)}}},{key:"_elementValue",value:function(e){var t=this.ref,n=/checkbox/.test(t.type),r=/radio/.test(t.type),o=n||r,i=Object.prototype.hasOwnProperty.call(t,"value"),a=i||/input|textarea|checkbox/.test(t.nodeName.toLowerCase()),s=/select/i.test(t.nodeName);return arguments.length?(null==e?e="":clearInterval(this._autocompleteCheckInterval),void(o?r?String(e)===String(t.value)&&(t.checked=!0):t.checked=e:h.equal(this._elementValue(),e)||(a||s?t.value=e:t.innerHTML=e))):n?Boolean(t.checked):a||s?t.value||"":t.innerHTML||""}}]),t}(u.BaseAttribute);y=c([l.attribute("value")],y),t.ValueAttribute=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(55),s=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),t}(a.BaseAttribute);t.BaseAttribute=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t,r,o,i){n(this,e),this.ref=t,this.key=r,this.value=o,this.view=i,this.initialize()}return e.prototype.initialize=function(){},e.prototype.update=function(){return Promise.resolve()},e.prototype.destroy=function(){},e.test=function(){},e}();t.BaseAttribute=r},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(57)),r(n(58)),r(n(60)),r(n(61)),r(n(62)),r(n(63))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function v(e,t,n){null===e&&(e=Function.prototype);
var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:v(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},f=n(6),h=n(43),p=n(24),d=n(7),y=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"initialize",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.attributes.name&&(this.name=this.attributes.name,this.as=this.attributes.as||this.name);case 1:case"end":return e.stop()}},e,this)}))}},{key:"update",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.factory){e.next=7;break}if(!this.factory.container.hasHandler("template")){e.next=6;break}return e.next=4,this.factory.container.get("template");case 4:t=e.sent,t.update();case 6:return e.abrupt("return");case 7:if(!this.resolving){e.next=9;break}return e.abrupt("return");case 9:return this.resolving=!0,e.next=12,this.view.container.get(this.name);case 12:if(this.factory=e.sent,this.factory instanceof p.ControllerFactory){e.next=15;break}throw new Error(this.name+" is not a controller");case 15:if(n=this.childTemplate,this.attributes.template&&(n=this.attributes.template),r={},this.attributes.state){o=this.attributes.state;try{r=f.isString(o)?JSON.parse(o):Object(o)}catch(s){console.warn("Could not parse model tag")}}return e.next=21,this.factory.create({template:n,contextName:this.as,parentView:this.view,state:r});case 21:return i=e.sent,e.next=24,this.factory.container.get("$el");case 24:a=e.sent,this.section.appendChild(a),this.resolving=!1;case 27:case"end":return e.stop()}},e,this)}))}},{key:"destroy",value:function(){this.factory&&(this.factory.destroy(),this.factory=void 0),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(h.BaseComponent);y=u([d.component("controller")],y),t.Controller=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(47),c=n(6),u=n(59),l=n(43),f=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"initialize",value:function(){var e=this;return this._onEvent=c.bind(this._onEvent,this),this.childTemplate.render(this.view.context,{parent:this.view}).then(function(t){return e.subview=t,e.subview.render()}).then(function(t){e.el=e.document.createElement("div"),e.el.appendChild(t),e.section.appendChild(e.el);e.attributes.event||"click";u.delegate(e.el,e.attributes.selector,"click",e._onEvent)})}},{key:"update",value:function(){return Promise.resolve()}},{key:"_onEvent",value:function(e){var t=this.attributes.click;if(s.isAssignment(t)&&(t=t.assign),"function"!=typeof t)throw new Error("[event] value is not a function");t(e)}},{key:"onDestroy",value:function(){u.undelegate(this.el,this.attributes.selector,"click",this._onEvent),this.subview&&this.subview.$destroy()}}]),t}(l.BaseComponent);t.Delegate=f},function(e,t){e.exports=o},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(e instanceof h.Collection)e=e.models;else if(e instanceof d.TemplateView)return Promise.resolve();return new Promise(function(n,r){for(var o=[],i=0,a=e.length;i<a;i++)o.push(t(e[i],i));Promise.all(o).then(n)["catch"](r)})}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},f=n(7),h=n(40),p=n(43),d=n(45),y=n(47),v=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"initialize",value:function(){return this._children=[],this._collection=[],this.childTemplate.render(this.view.context,{parent:this.view}).then(function(e){})}},{key:"update",value:function(){var e=this,t=(this.as,this.each);this.key||"key",this.view;return t===this._collection||null==t?Promise.resolve():(y.isCall(t)&&(t=t.call()),this._collection&&this._collection instanceof h.Collection&&this.__removeEventListeners(this._collection),this._collection=t,this._update().then(function(){t instanceof h.Collection&&e.__addEventListeners(t)}))}},{key:"_update",value:function(){var e,t=this,n=this.as,o=this.view,i=0,a=this.filter||function(e){return!0};return s(this._collection,function(s,c){if(!a(s))return Promise.resolve();var u;if(n){var l;e=new h.NestedModel((l={},r(l,n,s),r(l,"self",t.view.context),l))}else e=s;return c>=t._children.length?t.childTemplate.view(e,{parent:o}).then(function(e){return t._children.push(e),t.section.appendChild(e.section.render()),i++,e.render().then(function(e){})}):(u=t._children[c],u.context=e,u.update(),i++,Promise.resolve())}).then(function(){t._children.splice(i).forEach(function(e){e.$destroy()})})}},{key:"_update2",value:function(){var e,t=this.as,n=this.view,o=0,i=this.filter||function(e){return!0};this._collection.forEach(function(a){if(i(a)){var s;if(t){var c;e=new h.NestedModel((c={},r(c,t,a),r(c,"self",this.view.context),c))}else e=a;o>=this._children.length?(s=this.childTemplate.view(e,{parent:n}),this._children.push(s),this.section.appendChild(s.render(e))):(s=this._children[o],s.context=e,s.update()),o++}},this),this._children.splice(o).forEach(function(e){e.$destroy()})}},{key:"__addEventListeners",value:function(e){e.on("add",this._update,this),e.on("remove",this._update,this),e.on("reset",this._update,this),e.on("filter",this._update,this)}},{key:"__removeEventListeners",value:function(e){e.off("remove",this._update),e.off("add",this._update),e.off("reset",this._update),e.off("filter",this._update)}},{key:"setAttribute",value:function(e,t){this[e]=t}},{key:"onDestroy",value:function(){this._collection&&"function"==typeof this._collection.destroy&&this._collection.destroy();var e=!0,t=!1,n=void 0;try{for(var r,o=this._children[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.$destroy()}}catch(a){t=!0,n=a}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw n}}}}]),t}(p.BaseComponent);v=l([f.component("repeat")],v),t.Repeat=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(43),c=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"update",value:function(){var e=this,t=this.attributes.when;if(this._shown===t)return this.subview&&this.subview.update(),Promise.resolve();if(this._shown=t,t){if(!this.subview)return this.childTemplate.render(this.view.context,{parent:this.view}).then(function(t){return e.subview=t,e.subview.render()}).then(function(t){e.section.appendChild(t)})}else this.subview&&this.subview.$destroy(),this.subview=void 0}},{key:"onDestroy",value:function(){this.subview&&this.subview.$destroy()}}]),t}(s.BaseComponent);t.Show=c;var u=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"update",value:function(){var e=this,t=this.attributes.when;if(this._hide===t)return this.subview&&this.subview.update(),Promise.resolve();if(this._hide=t,t)this.subview&&this.subview.$destroy(),this.subview=void 0;else if(!this.subview)return this.childTemplate.render(this.view.context,{parent:this.view}).then(function(t){return e.subview=t,e.subview.render()}).then(function(t){e.section.appendChild(t)})}},{key:"onDestroy",value:function(){this.subview&&this.subview.$destroy()}}]),t}(s.BaseComponent);t.Hide=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(43),u=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"update",value:function(){var e=this.attributes.html;if("object"===("undefined"==typeof e?"undefined":a(e))&&e.evaluate&&(e=void 0),this.currentValue&&this.currentValue===e)return void(this.currentValue.__isView&&this.currentValue.update(this.currentValue.context));if(this.currentValue&&this.currentValue.remove&&this.currentValue.remove(),this.currentValue=e,!e)return this.section.removeChildNodes();var t;if(e.render)e.remove(),t=e.render();else if(null!=e.nodeType)t=e;else{var n=this.document.createElement("div");n.innerHTML=String(e),t=this.document.createDocumentFragment();for(var r=Array.prototype.slice.call(n.childNodes),o=0,i=r.length;o<i;o++)t.appendChild(r[o])}this.section.removeChildNodes(),this.section.appendChild(t)}}]),t}(c.BaseComponent);t.Unsafe=u},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function s(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t)).next())})},f=n(43),h=n(7),p=n(40),d=n(47),y=function(e){function t(){var e;o(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return s.resolving=!1,s}return a(t,e),s(t,[{key:"getContext",value:function(){var e=this.attributes.context;if(e){if(e instanceof d.Call&&(e=e.call()),this.attributes.as){var t=this.attributes.as;e=new p.NestedModel(r({},t,e))}}else e=this.view.context;return e}},{key:"update",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.subview){e.next=3;break}return this.subview.context!==this.view.context&&(this.subview.context=this.getContext()),e.abrupt("return",this.subview.update());case 3:if(!this.resolving){e.next=5;break}return e.abrupt("return");case 5:if(this.resolving=!0,t=this.attributes.template,n=this.getContext(),t&&""!=t){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.view.container.get("$templateCreator");case 12:return r=e.sent,e.next=15,this.view.container.get("$templateResolver");case 15:return o=e.sent,e.next=18,o(t);case 18:return i=e.sent,e.next=21,r(i,n);case 21:return a=e.sent,a.parent=this.view,this.subview=a,e.t0=this.section,e.next=27,a.render();case 27:e.t1=e.sent,e.t0.appendChild.call(e.t0,e.t1),this.resolving=!1;case 30:case"end":return e.stop()}},e,this)}))}},{key:"onDestroy",value:function(){this.subview&&this.subview.$destroy()}}]),t}(f.BaseComponent);y=u([h.component("view")],y),t.View=y}])});