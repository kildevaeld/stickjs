!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.stick=e():t.stick=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}n(1),n(82);var i=n(6),o=n(15);e.utils=i,e.decorators=o,r(n(74)),r(n(64)),e.ready=i.domReady()},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(2)),r(n(77)),r(n(79)),r(n(80)),r(n(81))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=function(t,e,n,r){var i,s=arguments.length,a=3>s?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(3>s?i(a):s>3?i(e,n,a):i(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},c=n(3),u=n(6),l=n(15),f=n(60),h=n(62),p=n(74),d=n(16);p.decorator("route",function(){return function(t){if(!d.isDependencyType(t,d.DependencyType.Controller))throw new Error("[route] target not a controller")}});var y=function g(){r(this,g),this.execute=null,this.pushState=!1};e.RouterOptions=y;var v=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t),n.execute=n.execute||u.bind(this.__execute,this),this.router=new c.Router(n),this.container=e,this.router.history.start()}return i(t,[{key:"setTarget",value:function(t){"string"==typeof t&&(t=document.querySelector(t)),this.target=t}},{key:"swapElements",value:function(t,e){return this.swap?void this.swap(t,e):(t.innerHTML="",void t.appendChild(e))}},{key:"else",value:function(t){"function"!=typeof t&&(t=this.__handleController(t)),this.router.history.on("route:unmatched",t)}},{key:"route",value:function(t,e){return"function"==typeof e?this.router.route(t,e):u.isObject(e)&&this.router.route(t,this.__handleController(e)),this}},{key:"reload",value:function(){var t=this;setTimeout(function(){t.router.history.loadUrl()})}},{key:"navigate",value:function(t,e){this.router.navigate(t,e)}},{key:"__execute",value:function(t,e,n){this.container.hasHandler("$route")&&this.container.unregister("$route"),this.container.registerInstance("$route",{fragment:e,parameters:n}),u.callFunc(t,this,n)}},{key:"__handleController",value:function(t){var e=this;if(!this.container.hasHandler(t.controller,!0,!0))throw new Error("[router] controller");return function(){return a(e,void 0,void 0,regeneratorRuntime.mark(function n(){var e,r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=void 0,e="string"==typeof t.target?document.querySelector(t.target):t.target&&t.target instanceof Element?t.target:"string"==typeof this.target?document.querySelector(this.target):this.target,null!=e){n.next=4;break}throw new Error("[router] target not defined");case 4:return n.next=6,this.container.get(t.controller);case 6:if(r=n.sent,null!=r&&(r instanceof f.ControllerFactory||r instanceof h.ModuleFactory)){n.next=9;break}throw new Error(t.controller+" not a controller");case 9:return n.next=11,r.create({template:t.template,parent:this.container});case 11:return i=n.sent,null!=this._currentController&&this._currentController.destroy(),this._currentController=r,n.next=16,r.container.get("template");case 16:o=n.sent,this.swapElements(e,o.render());case 18:case"end":return n.stop()}},n,this)}))}}},{key:"$destroy",value:function(){this.container.hasHandler("$route")&&this.container.unregister("$route"),this._currentController&&(this._currentController.destroy(),delete this._currentController)}},{key:"target",get:function(){return this._target},set:function(t){this._target=t}}]),t}();v=s([l.config(y),l.inject("$container","$routerProvider"),l.service("$router")],v),e.RouterService=v},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function m(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:m(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=n(4),l=n(5),f=n(6),h=/\((.*?)\)/g,p=/(\(\?)?:\w+/g,d=/\*\w+/g,y=/[\-{}\[\]+?.,\\\^$|#\s]/g,v=function(t){return t?"object"===("undefined"==typeof t?"undefined":c(t))&&"[object RegExp]"===toString.call(t):!1},g=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];r(this,e);var n=i(this,Object.getPrototypeOf(e).call(this));return n.history=new u.HistoryApi(t),n.options=t,n}return o(e,t),s(e,[{key:"route",value:function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];if(v(t)||(t=this._routeToRegExp(t)),"function"==typeof e&&(r=e,e=""),!r)throw new Error("router: no handler");return this.history.route(t,function(i){var o=n._extractParameters(t,i);n.execute(r,i,o),n.trigger.apply(n,["route:"+e].concat(o)),n.trigger("route",e,o)}),this}},{key:"execute",value:function(t,e,n){t&&(this.options.execute?this.options.execute(t,e,n):f.callFunc(t,this,n))}},{key:"navigate",value:function(t,e){return this.history.navigate(t,e),this}},{key:"_routeToRegExp",value:function(t){return t=t.replace(y,"\\$&").replace(h,"(?:$1)?").replace(p,function(t,e){return e?t:"([^/?]+)"}).replace(d,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")}},{key:"_extractParameters",value:function(t,e){var n=t.exec(e).slice(1);return n.map(function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}},{key:"$destroy",value:function(){a(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.history.off()}}]),e}(l.EventEmitter);e.Router=g},function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(5),c=n(6),u=/^[#\/]|\s+$/g,l=/^\/+|\/+$/g,f=/\/$/,h=/[#].*$/,p=function y(){o(this,y)};e.Handler=p;var d=function(t){function e(t){o(this,e);var n=r(this,Object.getPrototypeOf(e).call(this));return n.handlers=[],n._started=!1,"undefined"!=typeof window&&(n.location=window.location,n.history=window.history),n.checkUrl=c.bind(n.checkUrl,n),n.options=t||{},n}return i(e,t),s(e,[{key:"atRoot",value:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root}},{key:"getHash",value:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""}},{key:"getFragment",value:function(t){arguments.length<=1||void 0===arguments[1]?!1:arguments[1];if(null==t)if(this._wantsPushState||!this._wantsHashChange){t=decodeURI(this.location.pathname+this.location.search);var e=this.root.replace(f,"");t.indexOf(e)||(t=t.slice(e.length))}else t=this.getHash();return t.replace(u,"")}},{key:"start",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.started)throw new Error("Router.history has already been started");this._started=!0,this.options=c.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState;var e=this.getFragment();this.root=("/"+this.root+"/").replace(l,"/"),this._wantsPushState?window.addEventListener("popstate",this.checkUrl,!1):this._wantsHashChange&&window.addEventListener("hashchange",this.checkUrl,!1),this.fragment=e;var n=this.location;return this._wantsHashChange&&this._wantsPushState&&this.atRoot()&&n.hash&&(this.fragment=this.getHash().replace(u,""),this.history.replaceState({},document.title,this.root+this.fragment)),this.options.silent?void 0:this.loadUrl()}},{key:"stop",value:function(){window.removeEventListener("popstate",this.checkUrl),window.removeEventListener("hashchange",this.checkUrl),this._started=!1}},{key:"route",value:function(t,e){this.handlers.unshift({route:t,callback:e})}},{key:"checkUrl",value:function(){var t=this.getFragment();return t===this.fragment?!1:void(this.loadUrl()||this.trigger("route:unmatched"))}},{key:"loadUrl",value:function(t){return t=this.fragment=this.getFragment(t),this.handlers.some(function(e){return e.route.test(t)?(e.callback(t),!0):void 0})}},{key:"navigate",value:function(t,e){if(!this.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(h,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._wantsPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace)}return e.trigger?this.loadUrl(t):void 0}}},{key:"_updateHash",value:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}},{key:"started",get:function(){return this._started}}]),e}(a.EventEmitter);e.HistoryApi=d},function(t,e){"use strict";function n(){return""+ ++i}function r(t,e){void 0===e&&(e=[]);var n=t.length,r=-1,i=e[0],o=e[1],s=e[2],a=e[3];switch(e.length){case 0:for(;++r<n;)t[r].handler.call(t[r].ctx);return;case 1:for(;++r<n;)t[r].handler.call(t[r].ctx,i);return;case 2:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o);return;case 3:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s);return;case 4:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s,a);return;default:for(;++r<n;)t[r].handler.apply(t[r].ctx,e);return}}var i=0;e.callFunc=r;var o=function(){function t(){}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){void 0===r&&(r=!1);var i=(this._listeners||(this._listeners={}))[t]||(this._listeners[t]=[]);return i.push({name:t,once:r,handler:e,ctx:n||this}),this},t.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},t.prototype.off=function(t,e){if(this._listeners=this._listeners||{},null==t)this._listeners={};else if(this._listeners[t]){var n=this._listeners[t];if(null==e)this._listeners[t]=[];else for(var r=0;r<n.length;r++){n[r];n[r].handler==e&&this._listeners[t].splice(r,1)}}},t.prototype.trigger=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=(this._listeners||(this._listeners={}))[e]||(this._listeners[e]=[]).concat(this._listeners.all||[]);t.debugCallback&&t.debugCallback(this.constructor.name,this.name,e,n);for(var s,a,c,u=(o.length,[]),l=0,f=o.length;f>l;l++)s=o[l],a=n,"all"==s.name?(a=[e].concat(n),r([s],a)):u.push(s),s.once===!0&&(c=this._listeners[s.name].indexOf(s),this._listeners[s.name].splice(c,1));return u.length&&this._executeListener(u,n),this},t.prototype._executeListener=function(t,e){var n=r;this.constructor.executeListenerFunction&&(n=this.constructor.executeListenerFunction),n(t,e)},t.prototype.listenTo=function(t,e,r,i,o){void 0===o&&(o=!1);var s,a,c;return s=this._listeningTo||(this._listeningTo={}),a=t.listenId||(t.listenId=n()),s[a]=t,c=o?"once":"on",t[c](e,r,this),this},t.prototype.listenToOnce=function(t,e,n,r){return this.listenTo(t,e,n,r,!0)},t.prototype.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;var i=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t.listenId]=t);for(var o in r)t=r[o],t.off(e,n,this),!i&&Object.keys(t.listeners).length||delete this._listeningTo[o];return this},t.prototype.destroy=function(){this.stopListening(),this.off()},t}();e.EventEmitter=o},function(t,e,n){function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(7)),r(n(9)),r(n(11)),r(n(8)),r(n(10)),r(n(12)),r(n(13)),r(n(14))},function(t,e,n){function r(t){return t.filter(function(e,n){for(n+=1;n<t.length;n+=1)if(l.equal(e,t[n]))return!1;return!0})}function i(t,e){for(var n=0,r=t.length;r>n;n++)if(e(t[n]))return!0;return!1}function o(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function s(t,e,n){for(var r=0,i=t.length;i>r;r++)if(e.call(n,t[r]))return t[r];return null}function a(t,e,n){return Array.prototype.slice.call(t,e,n)}function c(t){return t.reduce(function(t,e){return t.concat(Array.isArray(e)?c(e):e)},[])}function u(t,e,n){var r="function"==typeof e?e:function(t){return t[e]};return t.map(function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}).map(function(t){return t.value})}var l=n(8);e.unique=r,e.any=i,e.indexOf=o,e.find=s,e.slice=a,e.flatten=c,e.sortBy=u},function(t,e,n){function r(){var t;if(window.hasOwnProperty("XMLHttpRequest"))return new XMLHttpRequest;try{return new ActiveXObject("msxml2.xmlhttp.6.0")}catch(e){t=e}try{return new ActiveXObject("msxml2.xmlhttp.3.0")}catch(e){t=e}try{return new ActiveXObject("msxml2.xmlhttp")}catch(e){t=e}return t}function i(t){return void 0===t&&(t=""),t+ ++v}function o(t,e,n){Array.isArray(n)||(n=[n]),n.forEach(function(n){"function"==typeof e[n]&&(t[n]=s(e[n],e))})}function s(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if("function"!=typeof t)throw new Error("method not at function");if(null!=g)return g.call.apply(g,[t,e].concat(n));n=n||[];var i=function(){},o=function(){var r=this instanceof i?this:e;return a(t,r,n.concat(d.slice(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o}function a(t,e,n){switch(void 0===n&&(n=[]),n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);default:return t.apply(e,n)}}function c(t,e){return h(t,e,[],[])}function u(t,e,n){var r=y.camelcase("on-"+e.replace(":","-"));t[r]&&"function"==typeof t[r]&&a(t[r],t,n),"function"==typeof t.trigger&&(n=[e].concat(n),a(t.trigger,t,n))}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];if(p.isObject(r)&&r[t])return r[t]}return null}function f(t,e,n){var r;r=e&&p.has(e,"constructor")?e.constructor:function(){return t.apply(this,arguments)},p.extend(r,t,n);var i=function(){this.constructor=r};return i.prototype=t.prototype,r.prototype=new i,e&&p.extend(r.prototype,e),r.__super__=t.prototype,r}function h(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;var i=toString.call(t);if(i!=toString.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!==+t?e!==+e:0===t?1/t===1/e:t===+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return r[o]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!("function"==typeof s&&s instanceof s&&"function"==typeof a&&a instanceof a))return!1;n.push(t),r.push(e);var c=0,u=!0;if("[object Array]"===i){if(c=t.length,u=c===e.length)for(;c--&&(u=h(t[c],e[c],n,r)););}else{for(var l in t)if(p.has(t,l)&&(c++,!(u=p.has(e,l)&&h(t[l],e[l],n,r))))break;if(u){for(l in e)if(p.has(e,l)&&!c--)break;u=!c}}return n.pop(),r.pop(),u}var p=n(9),d=n(7),y=n(10),v=0,g=Function.prototype.bind;e.ajax=r,e.uniqueId=i,e.proxy=o,e.bind=s,e.callFunc=a,e.equal=c,e.triggerMethodOn=u,e.getOption=l,e.inherits=f,e.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}()},function(t,e,n){function r(t,e){void 0===e&&(e=".");var n={};for(var i in t){var s=t[i];if(!s||s.constructor!==Object&&s.constructor!==Array||o(s))n[i]=s;else{console.log("VAL",s);var a=r(s);for(var c in a){var u=a[c];n[i+e+c]=u}}}return n}function i(t){return t===Object(t)}function o(t){return 0===Object.keys(t).length}function s(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!i(t))return t;for(var r,o,s=0;s<e.length;s++)if(r=e[s],i(r))for(o in r)c(r,o)&&(t[o]=r[o]);return t}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var r=Object(t),i=0,o=e.length;o>i;i++){var s=e[i];if(void 0!==s&&null!==s){s=Object(s);for(var a=Object.keys(Object(s)),c=0,u=a.length;u>c;c++){var l=a[c],f=Object.getOwnPropertyDescriptor(s,l);void 0!==f&&f.enumerable&&(r[l]=s[l])}}}return r}function c(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){for(var n,r={},i=0;i<e.length;i++)n=e[i],c(t,n)&&(r[n]=t[n]);return r}function l(t,e){var n={};for(var r in t)~e.indexOf(r)||(n[r]=t[r]);return n}function f(t,e,n,r){var i=t[e];return"function"==typeof i?y.callFunc(i,n,r||[]):i}function h(t){var e=[];for(var n in t)c(t,n)&&e.push(t[n]);return e}function p(t,e,n){for(var r,i,o=[],s=0,a=t.length;a>s;s++)r=t[s],i=v.any(e,function(t){return n(t,r)}),i&&o.push(r);return o}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[e.length-1],i=e.length,o=y.equal;"function"==typeof r&&(o=r,i--);for(var s=0;i>s;s++){var a=e[s];if(t=p(t,a,o),0===t.length)break}return t}var y=n(8),v=n(7);e.objToPaths=r,e.isObject=i,e.isEmpty=o,e.extend=s,e.assign=a,e.has=c,e.pick=u,e.omit=l,e.result=f,e.values=h,e.intersection=d},function(t,e){function n(t){return"string"==typeof t}function r(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function i(t,e){var n=t.substring(0,Math.min(e,t.length));return n+(n.length==t.length?"":"...")}function o(t,e){void 0===e&&(e=!1);var n=e?1e3:1024;if(Math.abs(t)<n)return t+" B";var r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1;do t/=n,++i;while(Math.abs(t)>=n&&i<r.length-1);return t.toFixed(1)+" "+r[i]}e.isString=n,e.camelcase=r,e.truncate=i,e.humanFileSize=o},function(t,e,n){(function(t){function r(t){return t&&"function"==typeof t.then}function i(t){return t?r(t)?t:"function"==typeof t?o.call(this,t):Array.isArray(t)?s.call(this,t):p.isObject(t)?a.call(this,t):e.Promise.resolve(t):t}function o(t){var n=this;return new e.Promise(function(e,r){t.call(n,function(t,n){return t?r(t):(arguments.length>2&&(n=d.slice(arguments,1)),void e(n))})})}function s(t){return e.Promise.all(t.map(i,this))}function a(t){function n(t,e){o[e]=void 0,a.push(t.then(function(t){o[e]=t}))}for(var o=new t.constructor,s=Object.keys(t),a=[],c=0;c<s.length;c++){var u=s[c],l=i.call(this,t[u]);l&&r(l)?n(l,u):o[u]=t[u]}return e.Promise.all(a).then(function(){return o})}function c(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o={};return o.promise=new e.Promise(function(t,e){o.resolve=t,o.reject=e,o.done=function(n,r){return n?e(n):void t(r)}}),"function"==typeof t?(y.callFunc(t,n,r.concat([o.done])),o.promise):o}function u(t,e,n){t.then(function(t){e.call(n,null,t)})["catch"](function(t){e.call(n,t)})}function l(t){var e=c();return null==t?y.nextTick(e.resolve):setTimeout(e.resolve,t),e.promise}function f(t,e,n,r){return void 0===r&&(r=!1),h(t,e,n,r).then(function(){})}function h(t,n,i,o){return void 0===o&&(o=!1),new e.Promise(function(e,s){function a(h,p){if(h&&!o)return s(h);if(h&&l.push(h),c===u)return l.length?s(d.flatten(l)):e(f);var y=n.call(i,t[c++]);r(y)?y.then(function(t){f.push(t),a(null,t)},a):a(y instanceof Error?y:null)}var c=0,u=t.length,l=[],f=[];a(null)})}var p=n(9),d=n(7),y=n(8);e.Promise="undefined"==typeof window?t.Promise:window.Promise,e.isPromise=r,e.toPromise=i,e.thunkToPromise=o,e.arrayToPromise=s,e.objectToPromise=a,e.deferred=c,e.callback=u,e.delay=l,e.eachAsync=f,e.mapAsync=h}).call(e,function(){return this}())},function(t,e,n){function r(t,e){return v.call(t,e)}function i(t,e,n,r){void 0===r&&(r=!1),g.call(t,e,n,r)}function o(t,e,n){m.call(t,e,n)}function s(t,e,n,o,s){var a=t,c=function(t){var n=t.target||t.srcElement;if(!t.delegateTarget)for(;n&&n!=a;n=n.parentNode)r(n,e)&&(t.delegateTarget=n,o(t))},u=!!~_.indexOf(n);return i(t,n,c,u),O.push({eventName:n,handler:c,listener:o,selector:e}),c}function a(t,e,n,r){for(var i=O.slice(),s=0,a=i.length;a>s;s++){var c=i[s],u=c.eventName===n&&(r?c.listener===r:!0)&&(e?c.selector===e:!0);u&&(o(t,c.eventName,c.handler),O.splice(d.indexOf(i,c),1))}}function c(t,e){if(t.classList)for(var n=e.split(" "),r=0,i=n.length;i>r;r++)t.classList.contains(n[r].trim())||t.classList.add(n[r].trim());else t.className=d.unique(t.className.split(" ").concat(e.split(" "))).join(" ")}function u(t,e){if(t.classList)for(var n=e.split(" "),r=0,i=n.length;i>r;r++)t.classList.remove(n[r].trim());else for(var o,n=t.className.split(" "),s=e.split(" "),r=0,i=s.length;i>r;r++)o=n.indexOf(s[r]),~o&&(n=n.splice(o,1))}function l(t,e){if(t.classList)return t.classList.contains(e);var n=new RegExp("\b"+e);return n.test(t.className)}function f(t){if("selectionStart"in t)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange(),n=document.selection.createRange().text.length;return e.moveStart("character",-t.value.length),e.text.length-n}}function h(t,e,n,r){var s=x.transitionEnd||(x.transitionEnd=b()),a=function(r){o(t,s,a),e.call(n,r)};i(t,s,a)}function p(t,e,n,r){var s=x.animationEnd||(x.animationEnd=w()),a=function(r){o(t,s,a),e.call(n,r)};i(t,s,a)}var d=n(7),y="undefined"!=typeof Element&&Element.prototype||{},v=y.matches||y.webkitMatchesSelector||y.mozMatchesSelector||y.msMatchesSelector||y.oMatchesSelector||function(t){var e=(this.parentNode||document).querySelectorAll(t)||[];return!!~d.indexOf(e,this)},g=y.addEventListener||function(t,e){return this.attachEvent("on"+t,e)},m=y.removeEventListener||function(t,e){return this.detachEvent("on"+t,e)},b=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return e[n];return null},w=function(){var t=document.createElement("bootstrap"),e={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd oanimationend",animation:"animationend"};for(var n in e)if(void 0!==t.style[n])return e[n];return null};e.matches=r,e.addEventListener=i,e.removeEventListener=o;var _="focus blur change".split(" "),O=[];e.delegate=s,e.undelegate=a,e.addClass=c,e.removeClass=u,e.hasClass=l,e.selectionStart=f;var x={animationEnd:null,transitionEnd:null};e.transitionEnd=h,e.animationEnd=p,e.domReady=function(){var t,e=[],n=document,r=n.documentElement.doScroll,i="DOMContentLoaded",o=(r?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return o||n.addEventListener(i,t=function(){for(n.removeEventListener(i,t),o=!0;t=e.shift();)t()}),function(t){o?setTimeout(t,0):e.push(t)}}},function(t,e,n){function r(t){for(var e,n,r,i,o={},s=decodeURIComponent,a=t.split("&"),c=0,u=a.length;u>c;c++){var l=a[c];e=l.split("="),n=e[0],r=e[1],null==r&&(r=!0),n=s(n),r=s(r),i=o[n],Array.isArray(i)?i.push(r):i?o[n]=[i,r]:o[n]=r}return o}function i(t){return"?"+Object.keys(t).reduce(function(e,n){return e.push(n+"="+encodeURIComponent(t[n])),e},[]).join("&")}var o=n(8),s=n(10),a=n(9),c=n(11),u=/^application\/json/,l=/^file:/;e.queryStringToParams=r,e.queryParam=i;var f=function(t,e){return t.status>=200&&t.status<300||304===t.status||0===t.status&&l.test(e)||0===t.status&&"file:"===window.location.protocol},h=function(){function t(t,e){this._method=t,this._url=e,this._headers={},this._params={},this._xhr=o.ajax()}return t.prototype.send=function(t){return this._data=t,this},t.prototype.withCredentials=function(t){return this._xhr.withCredentials=t,this},t.prototype.end=function(t){var e=this;this._data=t||this._data;var n=c.deferred();this._xhr.addEventListener("readystatechange",function(){return e._xhr.readyState===XMLHttpRequest.DONE?f(e._xhr,e._url)?void n.resolve(e._xhr.responseText):n.reject(new Error("server responded with: "+e._xhr.status)):void 0}),t=this._data;var r=this._url;if(t&&t===Object(t)&&"GET"==this._method){var o=i(t);r+=o}r=this._apply_params(r),this._xhr.open(this._method,r,!0);for(var s in this._headers)this._xhr.setRequestHeader(s,this._headers[s]);return this._xhr.send(t),n.promise},t.prototype.json=function(t){var e=this;return this.header("content-type","application/json; charset=utf-8"),s.isString(t)||(t=JSON.stringify(t)),this.end(t).then(function(t){var n=e._xhr.getResponseHeader("content-type");if(u.test(n)&&""!==t){var r=JSON.parse(t);return r}throw new Error("json")})},t.prototype.progress=function(t){return this._xhr.addEventListener("progress",t),this},t.prototype.header=function(t,e){return s.isString(t)&&s.isString(e)?this._headers[t]=e:a.isObject(t)&&a.extend(this._headers,t),this},t.prototype.params=function(t){return a.extend(this._params,t),this},t.prototype._apply_params=function(t){var e={},n=t.indexOf("?");if(n>-1&&(e=a.extend(e,r(t.substr(n+1))),t=t.substr(0,n)),a.extend(e,this._params),!a.isEmpty(e)){var o=-1===t.indexOf("?")?"?":"&";t+=o+i(e)}return t},t}();e.Request=h,e.request={},["get","post","put","delete","patch","head"].forEach(function(t){e.request["delete"===t?"del":t]=function(e){return new h(t.toUpperCase(),e)}})},function(t,e,n){function r(t){return o.create(t)}var i=n(8),o=function(){function t(t){this.enabled=!1,this.namespace=t}return t.enable=function(t,e){for(var n in this.loggers)e&&n===e?this.loggers[n].enabled=t:e||(this.loggers[n].enabled=t)},t.create=function(e){var n;return this.loggers[e]?n=this.loggers[e].debug:(n=new t(e),this.loggers[e]=n),i.bind(n.debug,n)},t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(this.enabled){e[0]=this._coerce(e[0]),"string"!=typeof e[0]&&(e=["%o"].concat(e));var r=0;e[0]=e[0].replace(/%([a-z%])/g,function(n,i){if("%%"===n)return n;r++;var o=t.formatters[i];if("function"==typeof o){var s=e[r];n=o.call(self,s),e.splice(r,1),r--}return n}),e=this._formatArgs(e),this._log.apply(this,e)}},t.prototype._log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.prototype._coerce=function(t){return t instanceof Error?t.stack||t.message:t},t.prototype._formatArgs=function(t){var e=this.prefix?this.prefix+":":"";return t[0]="["+e+":"+this.namespace+"] "+t[0],t},t.loggers={},t.formatters={j:function(t){return JSON.stringify(t)}},t}();e.Debug=o,e.debug=r},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function i(t){return function(e){var n=t||h.camelcase(e.name);d.Repository.add(f.DependencyType.Controller,n,e)}}function o(t){return function(e){var n=t||h.camelcase(e.name);d.Repository.add(f.DependencyType.Module,n,e)}}function s(t,e){return function(e){var n=t||h.camelcase(e.name);d.Repository.add(f.DependencyType.Service,n,e)}}function a(t){return function(e){p.Metadata.define(f.DIServiceConfig,t,e,void 0)}}function c(t){return function(e){p.Metadata.define(f.Metakey[f.Metakey.Template],t,e,void 0)}}function u(t){return function(e){y.component(t,e)}}function l(t){return function(e){y.attribute(t,e)}}var f=n(16),h=n(6),p=n(17),d=n(30),y=n(31);r(n(29)),e.controller=i,e.module=o,e.service=s,e.config=a,e.template=c,e.component=u,e.attribute=l},function(t,e,n){"use strict";function r(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=p.Metadata.getOwn(p.Metadata.paramTypes,t);if(!n){var r=t.toString().match(d);r&&(n=r[1].replace(/,/," ").split(" ").map(function(t){return t.replace(",","").trim()}).filter(function(t){return""!==t}),e&&p.Metadata.define(p.Metadata.paramTypes,n,t,void 0))}return n||[]}function i(t){var e=void 0;if(t.constructor===Array){var n=t.pop();e=t,t=n,t.inject=e}else{if("function"!=typeof t)return[t,null];if(e=h.result(t,"inject"),!e||0==e.length){var i=t;i.__metadata__&&i.__metadata__.undefined["design:paramtypes"]&&delete i.__metadata__.undefined["design:paramtypes"],e=r(t),i.inject=e}}return[t,e]}function o(t){var e=void 0,n=void 0;try{e=t()}catch(r){n=r}return[e,n]}function s(t,e){var n=void 0,r=void 0,i=void 0,s=t.inject;if(!s)return h.Promise.resolve([]);for(n=0,r=s.length;r>n;n++){if(i=o(function(){return e.get(s[n])}),null!=i[1])return h.Promise.reject(i[1]);s[n]=i[0]}return h.Promise.all(s)}function a(t){return function(e){var n=y[y.DependencyType];p.Metadata.define(n,t,e,void 0)}}function c(t){var e=y[y.DependencyType],n=p.Metadata.getOwn(e,t,void 0);return n}function u(t,e){return c(t)===e}function l(t,e){var n=p.Metadata.instanceActivator;p.Metadata.define(n,e,t,void 0)}function f(t,e){var n=p.Metadata.dependencyResolver;p.Metadata.define(n,e,t,void 0)}var h=n(6),p=n(17),d=/function[^(]*\(([^)]*)\)/i;e.getFunctionParameters=r,function(t){t[t.Service=0]="Service",t[t.Module=1]="Module",t[t.Controller=2]="Controller",t[t.Factory=3]="Factory"}(e.DependencyType||(e.DependencyType={}));e.DependencyType;!function(t){t[t.DependencyType=0]="DependencyType",t[t.Template=1]="Template"}(e.Metakey||(e.Metakey={}));var y=e.Metakey;e.DIServiceConfig="mobyjs:service:config",e.getDependencies=i,e.resolveDependencies=s,e.setDependencyType=a,e.getDependencyType=c,
e.isDependencyType=u,e.setActivator=l,e.setDependencyResolver=f},function(t,e,n){t.exports=n(18)},function(t,e,n){"use strict";function r(t,e){var n=e({},t);return delete n["default"],n}function i(t,e){for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var i=n[r],o=Object.getOwnPropertyDescriptor(e,i);o&&o.configurable&&void 0===t[i]&&Object.defineProperty(t,i,o)}return t}function o(){}Object.defineProperty(e,"__esModule",{value:!0}),o.name||Object.defineProperty(Function.prototype,"name",{get:function(){var t=this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1];return Object.defineProperty(this,"name",{value:t}),t}});var s="0.1.0";e.Version=s;var a=n(19);i(e,r(a,i));var c=n(26);i(e,r(c,i));var u=n(29);i(e,r(u,i));var l=n(20);i(e,r(l,i))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(){return"di"+ ++h}function s(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=u.Metadata.getOwn(u.Metadata.paramTypes,t);if(!n){var r=t.toString().match(p);r&&(n=r[1].replace(/\W+/," ").split(" ").map(function(t){return t.replace(",","").trim()}).filter(function(t){return""!==t}),e&&u.Metadata.define(u.Metadata.paramTypes,n,t,void 0))}return n||[]}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.getFunctionParameters=s;var c=n(20),u=n(21),l=n(22),f=n(23)("stick:di"),h=0,p=/function[^(]*\(([^)]*)\)/i,d=function(t){function e(n){r(this,e),t.call(this,n),this.name="BadKeyError",this.message="key not registered with container"}return i(e,t),e}(l.DIError);e.DIBadKeyError=d;var y=Object.freeze([]);e.emptyParameters=y;var v=function(){function t(e){r(this,t),this._id=o(),this.entries=new Map,this.constructionInfo=e||new Map,f("Creating new container: %s",this.id)}return t.prototype.makeGlobal=function(){return f("%s: Make global",this.id),t.instance=this,this},t.prototype.autoRegister=function(t,e,n){var r;if(null===t||void 0===t)throw new d("no key");"function"==typeof t?(r=u.Metadata.get(u.Metadata.registration,t,n),void 0!==r?r.register(this,e||t,t):this.registerSingleton(e||t,t,n)):this.registerInstance(t,t)},t.prototype.unregister=function(t){f("%s: Unregister key: %s",this.id,t),this.entries["delete"](t)},t.prototype.hasHandler=function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];if(null===t||void 0===t)throw new d;return this.entries.has(t)||e&&this.parent&&this.parent.hasHandler(t,e)},t.prototype.get=function(e,n){f("%s: Get %s, target: %s",this.id,e,n);var r;if(null===e||void 0===e)throw new d;if(e===t)return this;if(e instanceof c.Resolver)return e.get(this);if(r=this.entries.get(e),void 0!==r)return r[0](this);if(this.parent&&this.parent.hasHandler(e))return f("%s: found key '%s' on parent",this.id,e),this.parent.get(e,n);if("string"==typeof e)throw(0,l.createError)("DIResolveError","no component registered for key: "+e);return this.autoRegister(e,n),r=this.entries.get(e),r[0](this)},t.prototype.getAll=function(t){var e,n=this;if(null===t||void 0===t)throw new d;return e=this.entries.get(t),void 0!==e?e.map(function(t){return t(n)}):this.parent?this.parent.getAll(t):[]},t.prototype.createChild=function(){var e=new t(this.constructionInfo);return e.parent=this,f("%s: Create child container: %s",this.id,e.id),e},t.prototype.resolveDependencies=function(t,e){f("%s: Resolve dependencies for: %j",this.id,t.name);var n,r,i=this._getOrCreateConstructionSet(t,e),o=i.keys,s=new Array(o.length);try{for(n=0,r=o.length;r>n;++n)s[n]=this.get(o[n])}catch(a){var c="Error";throw r>n&&(c+=" The argument at index "+n+" (key:"+o[n]+") could not be satisfied."),(0,l.createError)("DependencyError",c,[a])}return s},t.prototype.invoke=function(t,e,n){var r=this._getOrCreateConstructionSet(t,n);try{var i,o;return o=r.dependencyResolver?r.dependencyResolver.resolveDependencies(t):this.resolveDependencies(t,n),void 0!==e&&Array.isArray(e)&&(o=o.concat(e)),f("%s: invoking '%s', with dependencies:",this.id,t.name,o),r.activator.invoke(t,o,n,i)}catch(s){var a=r.activator instanceof c.ClassActivator?"instantiating":"invoking",u="Error "+a+" "+t.name+".";throw u+=" Check the inner error for details.",(0,l.createError)("DIInvokeError",u,[s])}},t.prototype.registerInstance=function(t,e){f("%s: Register instance %s",this.id,t),this.registerHandler(t,function(t){return e})},t.prototype.registerTransient=function(t,e,n){f("%s: Register transient %s",this.id,t),this.registerHandler(t,function(t){return t.invoke(e,null,n)})},t.prototype.registerSingleton=function(t,e,n){f("%s: Register singleton %s",this.id,t);var r;this.registerHandler(t,function(t){return r||(r=t.invoke(e,null,n))})},t.prototype.registerHandler=function(t,e){this._getOrCreateEntry(t).push(e)},t.prototype._getOrCreateEntry=function(t){var e;if(null===t||void 0===t)throw new l.DIError("key cannot be null or undefined.  (Are you trying to inject something that doesn't exist with DI?)");return e=this.entries.get(t),void 0===e&&(e=[],this.entries.set(t,e)),e},t.prototype._getOrCreateConstructionSet=function(t,e){var n=this.constructionInfo.get(t);return void 0===n&&(n=this._createConstructionSet(t,e),this.constructionInfo.set(t,n)),n},t.prototype._createConstructionSet=function(t,e){var n={activator:u.Metadata.getOwn(u.Metadata.instanceActivator,t,e)||c.ClassActivator.instance,dependencyResolver:u.Metadata.getOwn(u.Metadata.dependencyResolver,t,e)||this};return void 0!==t.inject?("function"==typeof t.inject?n.keys=t.inject():n.keys=t.inject,n):(n.keys=u.Metadata.getOwn(u.Metadata.paramTypes,t,e)||s(t)||y,n)},a(t,[{key:"root",get:function(){for(var t=this,e=t;e;)e=t.parent,e&&(t=e);return t}},{key:"id",get:function(){return this._id}}]),t}();e.DIContainer=v},function(t,e){"use strict";function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(e){r(this,t),this.key=e}return t.prototype.register=function(t,e,n){t.registerTransient(this.key||e,n)},t}();e.TransientRegistration=i;var o=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];r(this,t),"boolean"==typeof e?this.registerInChild=e:(this.key=e,this.registerInChild=n)}return t.prototype.register=function(t,e,n){var r=this.registerInChild?t:t.root;r.registerSingleton(this.key||e,n)},t}();e.SingletonRegistration=o;var s=function(){function t(){r(this,t)}return t.prototype.get=function(t){throw new Error("A custom Resolver must implement get(container) and return the resolved instance(s).")},t}();e.Resolver=s;var a=function(t){function e(n){r(this,e),t.call(this),this.key=n}return n(e,t),e.prototype.get=function(t){var e=this;return function(){return t.get(e.key)}},e.of=function(t){return new e(t)},e}(s);e.Lazy=a;var c=function(t){function e(n){r(this,e),t.call(this),this.key=n}return n(e,t),e.prototype.get=function(t){return t.getAll(this.key)},e.of=function(t){return new e(t)},e}(s);e.All=c;var u=function(t){function e(n){var i=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];r(this,e),t.call(this),this.key=n,this.checkParent=i}return n(e,t),e.prototype.get=function(t){return t.hasHandler(this.key,this.checkParent)?t.get(this.key):null},e.of=function(t){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return new e(t,n)},e}(s);e.Optional=u;var l=function(t){function e(n){r(this,e),t.call(this),this.key=n}return n(e,t),e.prototype.get=function(t){return t.parent?t.parent.get(this.key):null},e.of=function(t){return new e(t)},e}(s);e.Parent=l;var f=function(){function t(){r(this,t)}return t.prototype.invoke=function(t,e){return Reflect.construct(t,e)},t}();e.ClassActivator=f,f.instance=new f;var h=function(){function t(){r(this,t)}return t.prototype.invoke=function(t,e){return t.apply(void 0,e)},t}();e.FactoryActivator=h,h.instance=new h},function(t,e){(function(t){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t){var e;if(e="function"==typeof t.decorators?t.decorators():t.decorators,"function"!=typeof e._decorate)throw new Error("The return value of your decorator's method was not valid.");delete t.decorators,e._decorate(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=Function.prototype.bind,o=function(){return"undefined"!=typeof self?self:"undefined"!=typeof t?t:new Function("return this")()}(),s=Object.freeze({}),a="__metadata__";e.metadataContainerKey=a,"undefined"==typeof o.System&&(o.System={isFake:!0}),"undefined"==typeof o.System.forEachModule&&(o.System.forEachModule=function(){}),"undefined"==typeof o.Reflect&&(o.Reflect={}),"undefined"==typeof o.Reflect.getOwnMetadata&&(Reflect.getOwnMetadata=function(t,e,n){return((e[a]||s)[n]||s)[t]}),"undefined"==typeof o.Reflect.defineMetadata&&(Reflect.defineMetadata=function(t,e,n,r){var i=n.hasOwnProperty(a)?n[a]:n[a]={},o=i[r]||(i[r]={});o[t]=e}),"undefined"==typeof o.Reflect.metadata&&(Reflect.metadata=function(t,e){return function(n,r){Reflect.defineMetadata(t,e,n,r)}}),Reflect.construct=function(t,e){return new(i.apply(t,[null].concat(n(e))))};var c={global:o,noop:function(){},paramTypes:"design:paramtypes",properties:"design:properties",instanceActivator:"di:instance-activator",registration:"di:registration",dependencyResolver:"di:dependency-resolver",get:function(t,e,n){if(e){var r=c.getOwn(t,e,n);return void 0===r?c.get(t,Object.getPrototypeOf(e),n):r}},getOwn:function(t,e,n){return e?(e.hasOwnProperty("decorators")&&r(e),Reflect.getOwnMetadata(t,e,n)):void 0},define:function(t,e,n,r){Reflect.defineMetadata(t,e,n,r)},getOrCreateOwn:function(t,e,n,r){var i=c.getOwn(t,n,r);return void 0===i&&(i=new e,Reflect.defineMetadata(t,i,n,r)),i}};e.Metadata=c}).call(e,function(){return this}())},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e,n){var r=void 0;return r=n?new s(e,n):new o(e),r.name=t,r}Object.defineProperty(e,"__esModule",{value:!0}),e.createError=i;var o=function(t){function e(r){n(this,e),t.call(this,r),this.message=r}return r(e,t),e.prototype.toString=function(){return"["+this.name+": "+this.message+"]"},e}(Error);e.DIError=o;var s=function(t){function e(r,i){n(this,e),t.call(this,r),this.errors=i}return r(e,t),e.prototype.toString=function(){return"["+this.name+": "+this.message+"], errors:"+this.errors},e}(o);e.DIAggregateError=s},function(t,e,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var t=arguments,n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var i=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r),t}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(n){}}function a(){var t;try{t=e.storage.debug}catch(n){}return t}function c(){try{return window.localStorage}catch(t){}}e=t.exports=n(24),e.log=o,e.formatArgs=i,e.save=s,e.load=a,e.useColors=r,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){return JSON.stringify(t)},e.enable(a())},function(t,e,n){function r(){return e.colors[l++%e.colors.length]}function i(t){function n(){}function i(){var t=i,n=+new Date,o=n-(u||n);t.diff=o,t.prev=u,t.curr=n,u=n,null==t.useColors&&(t.useColors=e.useColors()),null==t.color&&t.useColors&&(t.color=r());var s=Array.prototype.slice.call(arguments);s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;a++;var i=e.formatters[r];if("function"==typeof i){var o=s[a];n=i.call(t,o),s.splice(a,1),a--}return n}),"function"==typeof e.formatArgs&&(s=e.formatArgs.apply(t,s));var c=i.log||e.log||console.log.bind(console);c.apply(t,s)}n.enabled=!1,i.enabled=!0;var o=e.enabled(t)?i:n;return o.namespace=t,o}function o(t){e.save(t);for(var n=(t||"").split(/[\s,]+/),r=n.length,i=0;r>i;i++)n[i]&&(t=n[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var n,r;for(n=0,r=e.skips.length;r>n;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;r>n;n++)if(e.names[n].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=i,e.coerce=c,e.disable=s,e.enable=o,e.enabled=a,e.humanize=n(25),e.names=[],e.skips=[],e.formatters={};var u,l=0},function(t,e){function n(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function i(t){return o(t,u,"day")||o(t,c,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,n){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,l=365.25*u;t.exports=function(t,e){return e=e||{},"string"==typeof t?n(t):e["long"]?i(t):r(t)}},function(t,e,n){"use strict";function r(t,e){var n=e({},t);return delete n["default"],n}function i(t,e){for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var i=n[r],o=Object.getOwnPropertyDescriptor(e,i);o&&o.configurable&&void 0===t[i]&&Object.defineProperty(t,i,o)}return t}Object.defineProperty(e,"__esModule",{value:!0});var o=n(21);i(e,r(o,i));var s=n(27);i(e,r(s,i))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28),i={configure:{parameterizedDecorator:function(t,e){i[t]=function(){var e=new r.DecoratorApplicator;return e[t].apply(e,arguments)},r.DecoratorApplicator.prototype[t]=function(){var t=e.apply(null,arguments);return this.decorator(t)}},simpleDecorator:function(t,e){i[t]=function(){return(new r.DecoratorApplicator).decorator(e)},r.DecoratorApplicator.prototype[t]=function(){return this.decorator(e)}}}};e.Decorators=i},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){n(this,t),this._first=null,this._second=null,this._third=null,this._rest=null}return t.prototype.decorator=function(t){return null===this._first?(this._first=t,this):null===this._second?(this._second=t,this):null===this._third?(this._third=t,this):(null===this._rest&&(this._rest=[]),this._rest.push(t),this)},t.prototype._decorate=function(t){var e,n,r;if(null!==this._first&&this._first(t),null!==this._second&&this._second(t),null!==this._third&&this._third(t),r=this._rest,null!==r)for(e=0,n=r.length;n>e;++e)r[e](t)},t}();e.DecoratorApplicator=r},function(t,e,n){"use strict";function r(t){var e=function(t){t.inject=l.Metadata.getOwn(l.Metadata.paramTypes,t)||h.emptyParameters};return t?e(t):e}function i(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return function(t){t.inject=e}}function o(t,e){return function(n){l.Metadata.define(l.Metadata.registration,t,n,e)}}function s(t,e){return o(new f.TransientRegistration(t),e)}function a(t,e,n){return void 0===e&&(e=!1),o(new f.SingletonRegistration(t,e),n)}function c(t,e){return function(n){l.Metadata.define(l.Metadata.instanceActivator,t,n,e)}}function u(){return c(f.FactoryActivator.instance)}Object.defineProperty(e,"__esModule",{value:!0}),e.autoinject=r,e.inject=i,e.registration=o,e["transient"]=s,e.singleton=a,e.instanceActivator=c,e.factory=u;var l=n(26),f=n(20),h=n(19);l.Decorators.configure.simpleDecorator("autoinject",r),l.Decorators.configure.parameterizedDecorator("inject",i),l.Decorators.configure.parameterizedDecorator("registration",o),l.Decorators.configure.parameterizedDecorator("transient",s),l.Decorators.configure.parameterizedDecorator("singleton",a),l.Decorators.configure.parameterizedDecorator("instanceActivator",c),l.Decorators.configure.parameterizedDecorator("factory",u)},function(t,e,n){"use strict";var r,i=n(16),o=n(6),s=n(17);Function.prototype.toString;!function(t){function e(e,n,r){var a=void 0;(a=o.find(t.items,function(t){return t.name==n}))&&t.items.splice(t.items.indexOf(a),1);var c=s.Metadata.get(i.DIServiceConfig,r);if("function"==typeof r&&""==r.name)try{Object.defineProperty(r,"name",{value:n})}catch(u){}t.items.push({name:n,handler:r,type:e,config:c})}function n(t){return!!c(t)}function r(t,e){return!!a(t,e)}function a(e,n){return o.find(t.items,function(t){return t.name==n&&t.type==e})}function c(e){return o.find(t.items,function(t){return t.name==e})}t.items=[],t.add=e,t.hasAny=n,t.has=r,t.get=a,t.any=c}(r=e.Repository||(e.Repository={}))},function(t,e,n){"use strict";function r(t,e){"function"!=typeof e&&(e=p.extendClass(f.BaseAttribute,e)),f[t]=e}function i(t,e){"function"!=typeof e&&(e=p.extendClass(l.BaseComponent,e)),l[t]=e}function o(t,e){h[t]=e}function s(t){p.Debug.enable(t)}function a(t,e){var n=u,r=y.compile(t),i=r(n.fragment,n.element,n.text,n.comment,n.dynamic,v.binding);return n.template(i,p.extend({document:document,viewClass:d.View,attributes:new c.Repository(f),components:new c.Repository(l),modifiers:h},e||{}))}var c=n(32),u=n(33),l=n(46),f=n(50),h=n(56),p=n(38),d=n(49),y=n(57),v=n(59);e.version="$$version$$",e.attribute=r,e.component=i,e.modifier=o,e.debugging=s,e.compile=a},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.values=e||{}}return t.prototype.set=function(t,e){this.values[t]=e},t.prototype.get=function(t){return this.values[t]},t.prototype.has=function(t){return!!this.get(t)},t.prototype["delete"]=function(t){delete this.values[t]},t}();e.Repository=r},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(34)),r(n(35)),r(n(37)),r(n(41)),r(n(42)),r(n(43)),r(n(45)),r(n(44)),r(n(36))},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.nodeType=8,this.nodeValue=e}return t.prototype.render=function(t){return t.document.createComment(this.nodeValue)},t}();e.Comment=r,e.comment=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(36),o=function(){function t(e,n){r(this,t),this.nodeType=-200,this.vnode=e,this.bindingClass=n,this.vnode.parentNode=this}return t.prototype.render=function(t,e){return t.components.has(this.vnode.tagName)?this._renderComponent(t,e):this._renderElement(t,e)},t.prototype._renderElement=function(t,e){var n=this.vnode.render(t,e);return e.push(new a(n,this.bindingClass,t)),n},t.prototype._renderComponent=function(t,e){var n=[],r=this.vnode.render(t,n);return e.push(new s(n[0],this.bindingClass,t)),r},t}();e.Dynamic=o,e.dynamic=function(t,e){return new o(t,e)};var s=function(){function t(e,n,i){r(this,t),this.renderer=e,this.bindingClass=n,this.options=i}return t.prototype.generate=function(t,e){this.renderer.generate(t,e);var n=e.bindings[e.bindings.length-1];e.bindings.splice(e.bindings.indexOf(n),0,new this.bindingClass(n,e))},t}(),a=function(){function t(e,n,i){r(this,t),this.ref=e,this.bindingClass=n,this.options=i}return t.prototype.generate=function(t,e){this._refPath||(this._refPath=i.getNodePath(this.ref)),e.bindings.push(new this.bindingClass(i.getNodeByPath(t,this._refPath),e))},t}()},function(t,e){"use strict";function n(t,e){for(var n=t,r=0,i=e.length;i>r;r++)n=n.childNodes[e[r]];return n}function r(t){for(var e=[],n=t.parentNode,r=t;n;)for(e.unshift(Array.prototype.indexOf.call(n.childNodes,r)),r=n,n=n.parentNode;n&&n.nodeType>12;)n=n.parentNode;return e}e.getNodeByPath=n,e.getNodePath=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n,r){for(var i in n){var o=e.attributes.get(i),s=new o(t,i,n[i],r);s.update&&r.bindings.push(s)}}var o=n(38),s=n(39),a=n(40),c=function(){function t(e,n,i){r(this,t),this.nodeType=1,this.tagName=String(e).toLocaleLowerCase(),this.childNodes=i,this.attributes=n||{};for(var o=0;o<i.length;o++)i[o].parentNode=this}return t.prototype.render=function(t,e){var n=t.components;return n.has(this.tagName)?this._renderComponent(n.get(this.tagName),t,e):this._renderElement(t,e)},t.prototype.setAttributes=function(t,e){"string"==typeof t?this.attributes[t]=e:o.extend(this.attributes,t)},t.prototype._renderComponent=function(t,e,n){var r=new s.FragmentSection(e.document);return n.push(new u(t,r,this,this._splitAttributes(e),e)),r.render()},t.prototype._renderElement=function(t,e){var n=t.document.createElement(this.tagName),r=this._splitAttributes(t);for(var i in r.staticAttributes)n.setAttribute(i,r.staticAttributes[i]);for(var o=this.childNodes,s=Array.isArray(o),c=0,o=s?o:o[Symbol.iterator]();;){var u;if(s){if(c>=o.length)break;u=o[c++]}else{if(c=o.next(),c.done)break;u=c.value}var f=u;n.appendChild(f.render(t,e))}return Object.keys(r.dynamicAttributes).length&&e.push(new l(new a.NodeSection(t.document,n),t,r.dynamicAttributes)),n},t.prototype._splitAttributes=function(t){var e={},n={};if(t.attributes)for(var r in this.attributes){var i=t.attributes.get(r);!i||i.test&&!i.test(this,r,this.attributes[r])?n[r]=this.attributes[r]:e[r]=this.attributes[r]}else n=this.attributes;return{dynamicAttributes:e,staticAttributes:n}},t}();e.Element=c,e.element=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;n>i;i++)r[i-2]=arguments[i];return new c(t,e,r)};var u=function(){function t(e,n,i,o,s){r(this,t),this.section=n,this.componentClass=e,this.element=i,this.options=s,this.attributes=o.staticAttributes,this.dynamicAttributes=o.dynamicAttributes}return t.prototype.generate=function(t,e){this._marker||(this._marker=this.section.createMarker());var n=new this.componentClass(this._marker.createSection(t),this.element,this.attributes,e);Object.keys(this.dynamicAttributes).length&&i(n,this.options,this.dynamicAttributes,e),n.update&&e.bindings.push(n)},t}(),l=function(){function t(e,n,i){r(this,t),this.section=e,this.options=n,this.attributes=i}return t.prototype.generate=function(t,e){this._marker||(this._marker=this.section.createMarker()),i(this._marker.findNode(t),this.options,this.attributes,e)},t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){for(var e=void 0,n=void 0,r=arguments.length,i=Array(r>1?r-1:0),o=1;r>o;o++)i[o-1]=arguments[o];for(var s=i,a=Array.isArray(s),c=0,s=a?s:s[Symbol.iterator]();;){if(a){if(c>=s.length)break;e=s[c++]}else{if(c=s.next(),c.done)break;e=c.value}if(e===Object(e))for(n in e)t[n]=e[n]}return t}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return Array.prototype.slice.apply(t,n)}function o(t,e,n){var i;i=e&&Object.prototype.hasOwnProperty.call(e,"constructor")?e.constructor:function(){return t.apply(this,arguments)},r(i,t,n);var o=function(){this.constructor=i};return o.prototype=t.prototype,i.prototype=new o,e&&r(i.prototype,e),i.__super__=t.prototype,i}function s(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;n>o;o++)r[o-2]=arguments[o];if("function"!=typeof t)throw new Error("method not at function");if(null!=u)return u.call.apply(u,[t,e].concat(r));r=r||[];var s=function(){},a=function(){var n=this instanceof s?this:e;return t.apply(n,r.concat(i(arguments)))};return s.prototype=this.prototype,a.prototype=new s,a}function a(t){return l.create(t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.extend=r,e.slice=i,e.extendClass=o;var u=Function.prototype.bind;e.bind=s;var l=function(){function t(e){n(this,t),this.enabled=!1,this.namespace=e}return t.enable=function(t,e){for(var n in this.loggers)e&&n===e?this.loggers[n].enabled=t:e||(this.loggers[n].enabled=t)},t.create=function(e){var n=void 0;return this.loggers[e]?n=this.loggers[e].debug:(n=new t(e),this.loggers[e]=n),s(n.debug,n)},t.prototype.debug=function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];if(this.enabled){n[0]=this._coerce(n[0]),"string"!=typeof n[0]&&(n=["%o"].concat(n));var i=0;n[0]=n[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;i++;var o=t.formatters[r];if("function"==typeof o){var s=n[i];e=o.call(self,s),n.splice(i,1),i--}return e}),n=this._formatArgs(n),this._log.apply(this,n)}},t.prototype._log=function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return"object"===("undefined"==typeof console?"undefined":c(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.prototype._coerce=function(t){return t instanceof Error?t.stack||t.message:t},t.prototype._formatArgs=function(t){return t[0]="[templ:"+this.namespace+"] "+t[0],t},t}();l.loggers={},l.formatters={j:function(t){return JSON.stringify(t)}},e.Debug=l,e.debug=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(36),o=function(){function t(e,n,i){if(r(this,t),this.document=e,this.start=n||e.createTextNode(""),this.end=i||e.createTextNode(""),!this.start.parentNode){var o=e.createDocumentFragment();o.appendChild(this.start),o.appendChild(this.end),this.__parent=o}}return t.prototype.appendChild=function(t){this.end.parentNode.insertBefore(t,this.end)},t.prototype.render=function(){return this.start.parentNode},t.prototype.remove=function(){var t=this.removeChildNodes();return t.insertBefore(this.start,t.childNodes[0]),t.appendChild(this.end),this},t.prototype.removeChildNodes=function(){for(var t=this.document.createDocumentFragment(),e=this.start,n=e.nextSibling,r=this.end;n!==r;)t.appendChild(n),n=e.nextSibling;return t},t.prototype.createMarker=function(){return new s(this.document,i.getNodePath(this.start),i.getNodePath(this.end))},t.prototype.clone=function(){var e;if(11===this.start.parentNode.nodeType)e=this.start.parentNode.cloneNode(!0);else{e=this.document.createDocumentFragment();for(var n=this._getChildNodes(),r=n.length,i=0;r>i;i++)e.appendChild(n[i].cloneNode(!0))}var o=e.childNodes[0],s=e.childNodes[e.childNodes.length-1];return new t(this.document,o,s)},t.prototype._getChildNodes=function(){for(var t=this.start,e=this.end.nextSibling,n=[];t!==e;)n.push(t),t=t.nextSibling;return n},t}();e.FragmentSection=o;var s=function(){function t(e,n,i){r(this,t),this.document=e,this.startPath=n,this.endPath=i}return t.prototype.createSection=function(t){return new o(this.document,i.getNodeByPath(t,this.startPath),i.getNodeByPath(t,this.endPath))},t}();e.FragmentSectionMarker=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(36),o=function(){function t(e,n){r(this,t),this.document=e,this.node=n}return t.prototype.createMarker=function(){return new s(this.document,i.getNodePath(this.node))},t.prototype.appendChild=function(t){this.node.appendChild(t)},t.prototype.render=function(){return this.node},t.prototype.remove=function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},t.prototype.removeChildren=function(){for(;this.node.childNodes.length;)this.node.removeChild(this.node.childNodes[0])},t.prototype.clone=function(){return new t(this.document,this.node.cloneNode(!0))},t}();e.NodeSection=o;var s=function(){function t(e,n){r(this,t),this.document=e,this.path=n}return t.prototype.createSection=function(t){return new o(this.document,this.findNode(t))},t.prototype.findNode=function(t){return i.getNodeByPath(t,this.path)},t}();e.NodeSectionMarker=s},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.nodeType=11,this.childNodes=e;for(var r=0;r<e.length;r++)e[r].parentNode=this}return t.prototype.render=function(t,e){for(var n=t.document.createDocumentFragment(),r=0,i=this.childNodes.length;i>r;r++)n.appendChild(this.childNodes[r].render(t,e));return n},t}();e.Fragment=r,e.fragment=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t,e){var n=void 0;if(11==e.nodeType){var r=new i.FragmentSection(t);r.appendChild(e),n=r}else n=new o.NodeSection(t,e);return n}var i=n(39),o=n(40);e.section=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return new a(t,e)}var o=n(42),s=n(44),a=function(){function t(e,n){r(this,t),this._renderers=[],this.vnode=e;var i=e.render(n,this._renderers);this.section=o.section(n.document,i),this.options=n}return t.prototype.view=function e(t,n){for(var r=this.section.clone(),i=this.options.viewClass||s.View,e=new i(r,this,t,n),o=this._renderers,a=Array.isArray(o),c=0,o=a?o:o[Symbol.iterator]();;){var u;if(a){if(c>=o.length)break;u=o[c++]}else{if(c=o.next(),c.done)break;u=c.value}var l=u;l.generate(r.node||r.start.parentNode,e)}return e},t}();e.Template=a,e.template=i},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,r,i,o){n(this,t),this.section=e,this.template=r,this.context=i,this.bindings=[]}return t.prototype.update=function(){for(var t=this.bindings,e=Array.isArray(t),n=0,t=e?t:t[Symbol.iterator]();;){var r;if(e){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var i=r;i.update()}},t.prototype.addListener=function(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];return t.addEventListener(e,n,r),
n},t.prototype.removeListener=function(t,e,n){var r=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];t.removeEventListener(e,n,r)},t.prototype.render=function(){return this.section.render()},t.prototype.remove=function(){for(var t=this.bindings,e=Array.isArray(t),n=0,t=e?t:t[Symbol.iterator]();;){var r;if(e){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var i=r;i.destroy()}return this.section.remove()},t}();e.View=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.nodeType=-201,this.nodeValue=e}return t.prototype.render=function(t){return t.document.createTextNode(this.nodeValue)},t}();e.Text=r,e.text=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(47)),r(n(48))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(43),o=n(41),s=function(){function t(e,n,s,a){r(this,t),this.section=e,this.vnode=n,this.attributes=s,this.view=a,this.document=a.template.options.document,n.childNodes&&(this.childTemplate=i.template(o.fragment(n.childNodes),a.template.options));for(var c in s)this.setAttribute(c,s[c]);this.initialize()}return t.prototype.initialize=function(){},t.prototype.setAttribute=function(t,e){this.attributes[t]=e},t.prototype.removeAttribute=function(t){this.attributes[t]=void 0},t.prototype.destroy=function(){},t}();e.BaseComponent=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){if(t)if(t.forEach)t.forEach(e);else for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)}var a=n(47),c=n(49),u=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a._children=[],a}return o(e,t),e.prototype.update=function(){var t,e=this.as,n=this.each,r=this.key||"key",i=0,o=this,a=this.view;n instanceof c.Call&&(n=n.call()),s(n,function(n,s){var c;e?(t={},t[r]=s,t[e]=n):t=n,t.parent=o.view.context,i>=o._children.length?(c=o.childTemplate.view(t,{parent:a}),o._children.push(c),o.section.appendChild(c.render(t))):(c=o._children[i],c.context=t,c.update()),i++}),this._children.splice(i).forEach(function(t){t.remove()})},e.prototype.setAttribute=function(t,e){this[t]=e},e}(a.BaseComponent);e.Repeat=u,e.repeat=u},function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,n){for(var r,i="string"==typeof e?e.split("."):e,o=t,s=0,a=i.length-1;a>s;s++)r=i[s],o[r]||(o[r]={}),o=o[r];return o[i[i.length-1]]=n,n}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(38),u=n(33),l=c.debug("view"),f=function(){function t(e,n,r,i){o(this,t),this.gettable=r,this.settable=i,this.view=e,this.path=n}return t.prototype.value=function(t){return 0===arguments.length?this.gettable?this.view.get(this.path):void 0:void(this.settable&&this.view.set(this.path,t))},t.prototype.toString=function(){return this.view.get(this.path)||""},t}();e.Reference=f;var h=function(){function t(e,n,r){o(this,t),this.view=e,this.path=n,this.value=r,this.assign=c.bind(this.assign,this),this.toString=c.bind(this.toString,this)}return t.prototype.assign=function(t){this.view.set(this.path,this.value.call(this))},t.prototype.toString=function(){var t=this.value.call(this);return t?String(t):""},t}();e.Assignment=h;var p=function(){function t(e,n,r){o(this,t),this.view=e,this.keypath=n,this.params=r}return t.prototype.call=function(){var t=this.view.get(this.keypath);if(null==t||"function"!=typeof t)throw new Error("not exists or not function");return t.apply(this.view,this.params)},t.prototype.toString=function(){var t=this.call();return t?String(t):""},t}();e.Call=p;var d=function(t){function e(n,i,s){var a=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];o(this,e);var c=r(this,t.call(this,n,i,s,a));return c.context=s,c._callers={},c._getters={},a.parent&&(c.parent=a.parent),a.delegator&&(c._delegator=a.delegator),c}return i(e,t),e.prototype.getDelegator=function(){if(this._delegator)return this._delegator;for(var t=this.parent;void 0!=t;){if(t._delegator)return t._delegator;t=t.parent}return null},e.prototype.addListener=function(e,n,r){var i=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],o=this.getDelegator();return o?o.addListener(e,n,r,i):"function"==typeof r?t.prototype.addListener.call(this,e,n,r,i):void 0},e.prototype.removeListener=function(e,n,r){var i=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],o=this.getDelegator();o?o.removeListener(e,n,r,i):"function"==typeof r&&t.prototype.removeListener.call(this,e,n,r,i)},e.prototype.get=function(t){if(this.context){var e,n="string"!=typeof t?t.join("."):t;try{var r;(r=this._getters[n])||(r=this._getters[n]=new Function("return this."+n)),e=r.call(this.context)}catch(i){e=void 0}return e=void 0!=e?e:this.parent?this.parent.get(t):void 0,l('get value "%s": %s',t,e),e}},e.prototype.set=function(t,e){if(l("set value %s on context %j",e,this.context),this.context){"string"==typeof t&&(t=t.split("."));s(this.context,t,e);this.update()}},e.prototype.render=function(){this.update();var e=t.prototype.render.call(this);return e},e.prototype.ref=function(t,e,n){return l("reference %s, gettable: %o, settabble: %o",t,e,n),new f(this,t,e,n)},e.prototype.assign=function(t,e){return l("assignment %s %s",t,e),new h(this,t,e)},e.prototype.call=function(t,e){var n;if(l('call keypath "%s", args: "%o"',t,e),"string"!=typeof t&&(t=t.join(".")),!(n=this._callers[t])){var r=["this"].concat(t.split("."));r.pop(),n=this._callers[t]=new Function("params","return this."+t+".apply("+r.join(".")+", params);")}return new p(this,t,e)},a(e,[{key:"root",get:function(){if(null==this.parent)return this;for(var t=this,e=t;e;)e=e.parent,e&&(t=e);return t}}]),e}(u.View);e.View=d},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var i=n(51),o=n(53),s=n(54),a=n(55);r(n(52)),e.value=i.ValueAttribute,e.onclick=o.ClickAttribute,e.onenter=o.OnEnterAttribute,e.onescape=o.OnEscapeAttribute,e.onchange=o.ChangeAttribute,e.onscroll=o.ScrollAttribute,e.onfocus=o.OnFocusAttribute,e.onblur=o.BlurAttribute,e.checked=i.ValueAttribute,e.style=s.StyleAttribute,e.focus=a.FocusAttribute},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(52),a=n(49),c=n(38),u=["change","keyup","input"],l=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._onInput=c.bind(this._onInput,this,null);for(var t=u,e=Array.isArray(t),n=0,t=e?t:t[Symbol.iterator]();;){var r;if(e){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var i=r;this.ref.addEventListener(i,this._onInput)}},e.prototype.update=function(){var t=this.model=this.value;if(t){if(!(t&&t instanceof a.Reference))throw new Error("input value must be a reference. Make sure you have <~> defined");t.gettable&&this._elementValue(this._parseValue(t.value()))}},e.prototype._parseValue=function(t){return null!=t&&""!==t?t:void 0},e.prototype._onInput=function(t){clearInterval(this._autocompleteCheckInterval),!t||t.keyCode&&~[27].indexOf(t.keyCode)||t.stopPropagation();var e=this._parseValue(this._elementValue());this.model&&String(this.model.value())!=String(e)&&this.model.value(e)},e.prototype._elementValue=function(t){var e=this.ref,n=/checkbox/.test(e.type),r=/radio/.test(e.type),i=n||r,o=Object.prototype.hasOwnProperty.call(e,"value"),s=o||/input|textarea|checkbox/.test(e.nodeName.toLowerCase()),a=/select/i.test(e.nodeName);return arguments.length?(null==t?t="":clearInterval(this._autocompleteCheckInterval),void(i?r?String(t)===String(e.value)&&(e.checked=!0):e.checked=t:String(t)!==this._elementValue()&&(s||a?e.value=t:e.innerHTML=t))):n?Boolean(e.checked):s||a?e.value||"":e.innerHTML||""},e}(s.BaseAttribute);e.ValueAttribute=l},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,r,i,o){n(this,t),this.ref=e,this.key=r,this.value=i,this.view=o,this.initialize()}return t.prototype.initialize=function(){},t.prototype.update=function(){},t.prototype.destroy=function(){},t.test=function(){},t}();e.BaseAttribute=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(52),c=n(49),u=n(38),l=u.debug("attributes:event"),f=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._onEvent=u.bind(this._onEvent,this)},e.prototype._onEvent=function(t){var e=void 0;if(e=this.value instanceof c.Assignment?this.value.assign:this.value,"function"!=typeof e&&!(e instanceof c.Call))throw new Error("[event] value is not a function or a Callable");l("fired event: %s",this._event),e instanceof c.Call?e.call():e(t)},e.prototype.destroy=function(){l("removed event listener %s: %o",this._event,this.value),this.view.removeListener(this.ref,this._event,this._onEvent)},s(e,[{key:"event",set:function(t){this._event&&(l("added event listener %s: %o",this._event,this.value),this.view.removeListener(this.ref,this._event,this._onEvent)),this._event=t,l("added event listener %s: %o",this._event,this.value),this.view.addListener(this.ref,this._event,this._onEvent)},get:function(){return this._event}}]),e}(a.BaseAttribute);e.EventAttribute=f;var h=function(t){function e(n,o,s,a){r(this,e);var c=i(this,t.call(this,n,o,s,a));return c.keyCodes=[],c.event="keydown",c}return o(e,t),e.prototype._onEvent=function(e){~this.keyCodes.indexOf(e.keyCode)&&t.prototype._onEvent.call(this,e)},e}(f);e.KeyCodeAttribute=h;var p=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.event="change",a}return o(e,t),e}(f);e.ChangeAttribute=p;var d=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.event="click",a}return o(e,t),e}(f);e.ClickAttribute=d;var y=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.event="scroll",a}return o(e,t),e}(f);e.ScrollAttribute=y;var v=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.event="focus",a}return o(e,t),e}(f);e.OnFocusAttribute=v;var g=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.event="blur",a}return o(e,t),e}(f);e.BlurAttribute=g;var m=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.keyCodes=[13],a}return o(e,t),e}(h);e.OnEnterAttribute=m;var b=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,t.call.apply(t,[this].concat(o)));return a.KeyCodes=[27],a}return o(e,t),e}(h);e.OnEscapeAttribute=b},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(52),a=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._currentStyles={}},e.prototype.update=function(){var t=this.value;if("string"==typeof t)return void this.ref.setAttribute("style",t);var e={};for(var n in t){var r=t[n];r!==this._currentStyles[n]&&(e[n]=this._currentStyles[n]=r||"")}for(var i in e)this.ref.style[i]=e[i]},e}(s.BaseAttribute);e.StyleAttribute=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(52),a=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){},e.prototype.update=function(){if(this.value&&this.ref.focus){var t=this;setTimeout(function(){t.ref.focus()},1)}},e}(s.BaseAttribute);e.FocusAttribute=a},function(t,e){"use strict";function n(t){return String(t).toUpperCase()}function r(t){return String(t).toLowerCase()}function i(t){var e;return e=String(t),e.substr(0,1).toUpperCase()+e.substr(1)}function o(t,e,n){return JSON.stringify.apply(JSON,arguments)}function s(t){return s(t)}e.uppercase=n,e.lowercase=r,e.titlecase=i,e.json=o,e.isNaN=s,e.round=Math.round},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){var n=o(t);return new Function("return "+n)()}function o(t){var e=new c;return e.transpile(t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=n(58);e.compile=i,e.transpile=o;var c=function(){function t(){r(this,t);for(var e in this)"_"===e.charAt(0)&&(this[e]=this[e].bind(this));this.transpile=this.transpile.bind(this)}return t.prototype.transpile=function(t){return this._root(a.parser.parse(t))},t.prototype._root=function(t){var e="(function(fragment, element, text, comment, dynamic, createBindingClass) {",n="fragment(["+this._children(t)+"])";return e+="'use strict';return "+n,e+="})"},t.prototype._expression=function(t){return this["_"+t[0]](t)},t.prototype._element=function(t){var e={},n=[];return t[2].forEach(function(r,i){var o=r[1],s=r[2],a=o.split(".");a.length>1?(e[a[0]]||(t=e[a[0]]=["element",a[0],[],[["element",t[1],n,t[3]]]]),e[a[0]][2].push([r[0],a[1],s])):n.push(r)}),this._element2(t)},t.prototype._doctype=function(t){return"text('<!DOCTYPE "+t[1]+">')"},t.prototype._children=function(t){for(t=t.concat();t.length;){var e=t[t.length-1];if("text"!==e[0])break;if(e[1]=e[1].replace(/[\s\r\n\t]+$/,""),!/^[\s\r\n\t]*$/.test(e[1]))break;t.pop()}return t.map(this._expression).join(", ")},t.prototype._element2=function(t){var e="element('"+t[1]+"'",n=[];e+=", {";e+=t[2].map(function(t){var e=t[1],r=t[2];return!r.length||1===r.length&&"string"===r[0][0]?"'"+e+"':"+(r.length?this._expression(r[0]):"true"):void n.push(t)}.bind(this)).filter(function(t){return!!t}).join(","),e+="}";var r=this._children(t[3]);if(r.length&&(e+=", "+r),e+=")",n.length){var i="",o="";n.forEach(function(t){var e=t[0];if(i+="this","block"===e)i+=".ref.nodeValue = "+this._expression(t[1]);else if("attribute"===e){var n=t[2].map(function(t){return"("+this._expression(t)+")"}.bind(this)).join("+");i+=".setAttribute('"+t[1]+"', "+n+");"}else"property"===e&&(i+=".setProperty('"+t[1]+"', "+this._expression(t[2])+");")}.bind(this)),i.length&&(i="function(context) {"+i+"}"),o.length&&(o="function() { var self = this; "+o+"}"),(i.length||o.length)&&(e="dynamic("+e+",",e+="createBindingClass("+(o.length?o:"void 0")+", "+(i?i:"void 0")+")",e+=")")}return e},t.prototype.__addReference=function(t){var e="_"+ ++this._refCounter;return this._refs[e]=t,e},t.prototype._block=function(t){var e="dynamic(text(), createBindingClass(void 0, function(context) {";return e+="this.ref.nodeValue = "+this._expression(t[1])+";",e+"}))"},t.prototype._text=function(t){return"text('"+t[1]+"')"},t.prototype._comment=function(t){return"comment('"+t[1]+"')"},t.prototype._hash=function(t){var e=t[1],n=[];for(var r in e)n.push("'"+r+"':"+this._expression(e[r]));return"{"+n.join(",")+"}"},t.prototype._script=function(t){return this._expression(t[1])},t.prototype._referenceKeyPath=function(t){var e=[],n=!1;return t.forEach(function(t){"string"!=typeof t?(n=!0,e.push(this._expression(t))):e.push(t)}.bind(this)),e=n?"["+e.map(function(e,n){return"string"==typeof t[n]?"'"+e+"'":e}).join(",")+"]":"'"+e.join(".")+"'"},t.prototype._reference=function(t){var e=this._referenceKeyPath(t[1]);if(t[2]){var n=!!~t[2].indexOf("<~"),r=!!~t[2].indexOf("~>");return"this.view.ref("+e+", "+n+", "+r+")"}return"this.view.get("+e+")"},t.prototype._string=function(t){return"'"+t[1]+"'"},t.prototype._operator=function(t){return this._expression(t[2])+t[1]+this._expression(t[3])},t.prototype._condition=function(t){return this._expression(t[1])+"?"+this._expression(t[2])+":"+this._expression(t[3])},t.prototype._literal=function(t){return t[1]},t.prototype._not=function(t){return"!"+this._expression(t[1])},t.prototype._negative=function(t){return"-"+this._expression(t[1])},t.prototype._call=function(t){var e="this.view.call("+this._referenceKeyPath(t[1][1])+", [";return e+=t[2].map(this._expression).join(","),e+"])"},t.prototype._modifier=function(t){return"this.options.modifiers."+t[1]+"("+t[2].map(this._expression).join(",")+")"},t.prototype._assign=function(t){return'this.view.assign("'+t[1][1]+'", function () { return '+this._expression(t[2])+";})"},t.prototype._group=function(t){return"("+this._expression(t[1])+")"},t.prototype.__findExpressions=function(t,e){var n=[];return this.__traverse(e,function(e){e[0]===t&&n.push(e)}),n},t.prototype.__traverse=function(t,e){e(t),t.forEach(function(t){t&&"object"===("undefined"==typeof t?"undefined":s(t))&&this.__traverse(t,e)}.bind(this))},t}()},function(t,e){"use strict";e.parser=function(){function t(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}function e(t,n,r,i){this.message=t,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}function n(t){function n(){return t.substring(Ai,Ci)}function r(e){throw a(null,[{type:"other",description:e}],t.substring(Ai,Ci),o(Ai,Ci))}function i(e){var n,r,i=ji[e];if(i)return i;for(n=e-1;!ji[n];)n--;for(i=ji[n],i={line:i.line,column:i.column,seenCR:i.seenCR};e>n;)r=t.charAt(n),"\n"===r?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),n++;return ji[e]=i,i}function o(t,e){var n=i(t),r=i(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function s(t){Ei>Ci||(Ci>Ei&&(Ei=Ci,Pi=[]),Pi.push(t))}function a(t,n,r,i){function o(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}function s(t,e){function n(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}var r,i,o,s=new Array(t.length);for(o=0;o<t.length;o++)s[o]=t[o].description;return r=t.length>1?s.slice(0,-1).join(", ")+" or "+s[t.length-1]:s[0],i=e?'"'+n(e)+'"':"end of input","Expected "+r+" but "+i+" found."}return null!==n&&o(n),new e(null!==t?t:s(n,r),n,r,i)}function c(){var t;return t=u()}function u(){var t,e;return t=Ci,e=f(),e!==bt&&(Ai=t,e=Ot(e)),t=e}function l(){var e,n,r,i,o,a;if(e=Ci,t.substr(Ci,9)===xt?(n=xt,Ci+=9):(n=bt,0===Si&&s(kt)),n!==bt)if(r=ft(),r!==bt){if(i=[],Ct.test(t.charAt(Ci))?(o=t.charAt(Ci),Ci++):(o=bt,0===Si&&s(At)),o!==bt)for(;o!==bt;)i.push(o),Ct.test(t.charAt(Ci))?(o=t.charAt(Ci),Ci++):(o=bt,0===Si&&s(At));else i=bt;i!==bt?(o=ft(),o!==bt?(62===t.charCodeAt(Ci)?(a=jt,Ci++):(a=bt,0===Si&&s(Et)),a!==bt?(Ai=e,n=Pt(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;else Ci=e,e=bt;return e}function f(){var t,e,n;for(t=Ci,e=[],n=y(),n===bt&&(n=p(),n===bt&&(n=g(),n===bt&&(n=h(),n===bt&&(n=m(),n===bt&&(n=P())))));n!==bt;)e.push(n),n=y(),n===bt&&(n=p(),n===bt&&(n=g(),n===bt&&(n=h(),n===bt&&(n=m(),n===bt&&(n=P())))));return e!==bt&&(Ai=t,e=St(e)),t=e}function h(){var e,n,r,i,o,a,c;if(e=Ci,n=ft(),n!==bt)if(t.substr(Ci,4)===Rt?(r=Rt,Ci+=4):(r=bt,0===Si&&s(Tt)),r!==bt){if(i=[],o=Ci,a=Ci,Si++,t.substr(Ci,3)===Mt?(c=Mt,Ci+=3):(c=bt,0===Si&&s(Dt)),Si--,c===bt?a=void 0:(Ci=a,a=bt),a!==bt?(c=lt(),c!==bt?(Ai=o,a=Nt(c),o=a):(Ci=o,o=bt)):(Ci=o,o=bt),o!==bt)for(;o!==bt;)i.push(o),o=Ci,a=Ci,Si++,t.substr(Ci,3)===Mt?(c=Mt,Ci+=3):(c=bt,0===Si&&s(Dt)),Si--,c===bt?a=void 0:(Ci=a,a=bt),a!==bt?(c=lt(),c!==bt?(Ai=o,a=Nt(c),o=a):(Ci=o,o=bt)):(Ci=o,o=bt);else i=bt;i!==bt?(t.substr(Ci,3)===Mt?(o=Mt,Ci+=3):(o=bt,0===Si&&s(Dt)),o!==bt?(a=ft(),a!==bt?(Ai=e,n=Lt(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;else Ci=e,e=bt;return e===bt&&(e=l()),e}function p(){var e,n,r,i,o,a,c,u;if(e=Ci,n=ft(),n!==bt)if(t.substr(Ci,7)===Ft?(r=Ft,Ci+=7):(r=bt,0===Si&&s(It)),r!==bt)if(i=x(),i!==bt)if(62===t.charCodeAt(Ci)?(o=jt,Ci++):(o=bt,0===Si&&s(Et)),o!==bt){if(a=[],c=d(),c!==bt)for(;c!==bt;)a.push(c),c=d();else a=bt;a!==bt?(t.substr(Ci,9)===$t?(c=$t,Ci+=9):(c=bt,0===Si&&s(Bt)),c!==bt?(u=ft(),u!==bt?(Ai=e,n=Ht(i,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;else Ci=e,e=bt;else Ci=e,e=bt;else Ci=e,e=bt;return e}function d(){var e,n,r;return e=Ci,n=Ci,Si++,t.substr(Ci,9)===$t?(r=$t,Ci+=9):(r=bt,0===Si&&s(Bt)),Si--,r===bt?n=void 0:(Ci=n,n=bt),n!==bt?(r=lt(),r!==bt?(Ai=e,n=Ut(),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e}function y(){var e,n,r,i,o,a;return e=Ci,60===t.charCodeAt(Ci)?(n=qt,Ci++):(n=bt,0===Si&&s(zt)),n!==bt?(t.substr(Ci,4)===Vt?(r=Vt,Ci+=4):(r=bt,0===Si&&s(Jt)),r===bt&&(t.substr(Ci,4)===Kt?(r=Kt,Ci+=4):(r=bt,0===Si&&s(Gt)),r===bt&&(t.substr(Ci,2)===Zt?(r=Zt,Ci+=2):(r=bt,0===Si&&s(Xt)),r===bt&&(t.substr(Ci,3)===Yt?(r=Yt,Ci+=3):(r=bt,0===Si&&s(Wt)),r===bt&&(t.substr(Ci,7)===Qt?(r=Qt,Ci+=7):(r=bt,0===Si&&s(te)),r===bt&&(t.substr(Ci,5)===ee?(r=ee,Ci+=5):(r=bt,0===Si&&s(ne)),r===bt&&(t.substr(Ci,2)===re?(r=re,Ci+=2):(r=bt,0===Si&&s(ie)),r===bt&&(t.substr(Ci,3)===oe?(r=oe,Ci+=3):(r=bt,0===Si&&s(se)),r===bt&&(t.substr(Ci,5)===ae?(r=ae,Ci+=5):(r=bt,0===Si&&s(ce)),r===bt&&(t.substr(Ci,6)===ue?(r=ue,Ci+=6):(r=bt,0===Si&&s(le)),r===bt&&(t.substr(Ci,4)===fe?(r=fe,Ci+=4):(r=bt,0===Si&&s(he)),r===bt&&(t.substr(Ci,4)===pe?(r=pe,Ci+=4):(r=bt,0===Si&&s(de)),r===bt&&(t.substr(Ci,5)===ye?(r=ye,Ci+=5):(r=bt,0===Si&&s(ve)),r===bt&&(t.substr(Ci,6)===ge?(r=ge,Ci+=6):(r=bt,0===Si&&s(me)),r===bt&&(t.substr(Ci,5)===be?(r=be,Ci+=5):(r=bt,0===Si&&s(we)),r===bt&&(t.substr(Ci,3)===_e?(r=_e,Ci+=3):(r=bt,0===Si&&s(Oe))))))))))))))))),r!==bt?(i=x(),i!==bt?(62===t.charCodeAt(Ci)?(o=jt,Ci++):(o=bt,0===Si&&s(Et)),o===bt&&(t.substr(Ci,2)===xe?(o=xe,Ci+=2):(o=bt,0===Si&&s(ke))),o===bt&&(o=null),o!==bt?(a=v(),a===bt&&(a=null),a!==bt?(Ai=e,n=Ce(r,i,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function v(){var e,n,r,i,o;return e=Ci,n=ft(),n!==bt?(t.substr(Ci,2)===Ae?(r=Ae,Ci+=2):(r=bt,0===Si&&s(je)),r!==bt?(t.substr(Ci,4)===Vt?(i=Vt,Ci+=4):(i=bt,0===Si&&s(Jt)),i===bt&&(t.substr(Ci,4)===Kt?(i=Kt,Ci+=4):(i=bt,0===Si&&s(Gt)),i===bt&&(t.substr(Ci,2)===Zt?(i=Zt,Ci+=2):(i=bt,0===Si&&s(Xt)),i===bt&&(t.substr(Ci,3)===Yt?(i=Yt,Ci+=3):(i=bt,0===Si&&s(Wt)),i===bt&&(t.substr(Ci,7)===Qt?(i=Qt,Ci+=7):(i=bt,0===Si&&s(te)),i===bt&&(t.substr(Ci,5)===ee?(i=ee,Ci+=5):(i=bt,0===Si&&s(ne)),i===bt&&(t.substr(Ci,2)===re?(i=re,Ci+=2):(i=bt,0===Si&&s(ie)),i===bt&&(t.substr(Ci,3)===oe?(i=oe,Ci+=3):(i=bt,0===Si&&s(se)),i===bt&&(t.substr(Ci,5)===ae?(i=ae,Ci+=5):(i=bt,0===Si&&s(ce)),i===bt&&(t.substr(Ci,6)===ue?(i=ue,Ci+=6):(i=bt,0===Si&&s(le)),i===bt&&(t.substr(Ci,4)===fe?(i=fe,Ci+=4):(i=bt,0===Si&&s(he)),i===bt&&(t.substr(Ci,4)===pe?(i=pe,Ci+=4):(i=bt,0===Si&&s(de)),i===bt&&(t.substr(Ci,5)===ye?(i=ye,Ci+=5):(i=bt,0===Si&&s(ve)),i===bt&&(t.substr(Ci,6)===ge?(i=ge,Ci+=6):(i=bt,0===Si&&s(me)),i===bt&&(t.substr(Ci,5)===be?(i=be,Ci+=5):(i=bt,0===Si&&s(we)),i===bt&&(t.substr(Ci,3)===_e?(i=_e,Ci+=3):(i=bt,0===Si&&s(Oe))))))))))))))))),i!==bt?(62===t.charCodeAt(Ci)?(o=jt,Ci++):(o=bt,0===Si&&s(Et)),o!==bt?(Ai=e,n=Ee(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function g(){var t,e,n,r;return t=Ci,e=w(),e!==bt?(n=f(),n!==bt?(r=k(),r!==bt?(Ai=t,e=Pe(e,n,r),t=e):(Ci=t,t=bt)):(Ci=t,t=bt)):(Ci=t,t=bt),t===bt&&(t=_()),t}function m(){var t,e,n;if(t=Ci,e=[],n=b(),n!==bt)for(;n!==bt;)e.push(n),n=b();else e=bt;return e!==bt&&(Ai=t,e=Se(e)),t=e}function b(){var e,n,r;return e=Ci,n=Ci,Si++,60===t.charCodeAt(Ci)?(r=qt,Ci++):(r=bt,0===Si&&s(zt)),r===bt&&(t.substr(Ci,2)===Re?(r=Re,Ci+=2):(r=bt,0===Si&&s(Te))),Si--,r===bt?n=void 0:(Ci=n,n=bt),n!==bt?(r=lt(),r!==bt?(Ai=e,n=Ut(),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e}function w(){var e,n,r,i,o,a;return e=Ci,n=ft(),n!==bt?(60===t.charCodeAt(Ci)?(r=qt,Ci++):(r=bt,0===Si&&s(zt)),r!==bt?(i=O(),i!==bt?(62===t.charCodeAt(Ci)?(o=jt,Ci++):(o=bt,0===Si&&s(Et)),o!==bt?(a=ft(),a!==bt?(Ai=e,n=Me(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function _(){var e,n,r,i,o,a;return e=Ci,n=ft(),n!==bt?(60===t.charCodeAt(Ci)?(r=qt,Ci++):(r=bt,0===Si&&s(zt)),r!==bt?(i=O(),i!==bt?(t.substr(Ci,2)===xe?(o=xe,Ci+=2):(o=bt,0===Si&&s(ke)),o!==bt?(a=ft(),a!==bt?(Ai=e,n=De(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function O(){var t,e,n;return t=Ci,e=C(),e!==bt?(n=x(),n!==bt?(Ai=t,e=Ne(e,n),t=e):(Ci=t,t=bt)):(Ci=t,t=bt),t}function x(){var t,e,n,r;if(t=Ci,e=ft(),e!==bt){for(n=[],r=A();r!==bt;)n.push(r),r=A();n!==bt?(r=ft(),r!==bt?(Ai=t,e=Le(n),t=e):(Ci=t,t=bt)):(Ci=t,t=bt)}else Ci=t,t=bt;return t}function k(){var e,n,r,i;return e=Ci,t.substr(Ci,2)===Ae?(n=Ae,Ci+=2):(n=bt,0===Si&&s(je)),n!==bt?(r=C(),r!==bt?(62===t.charCodeAt(Ci)?(i=jt,Ci++):(i=bt,0===Si&&s(Et)),i!==bt?(Ai=e,n=Ee(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function C(){var e,n,r,i;if(e=Ci,n=ft(),n!==bt){if(r=[],Fe.test(t.charAt(Ci))?(i=t.charAt(Ci),Ci++):(i=bt,0===Si&&s(Ie)),i!==bt)for(;i!==bt;)r.push(i),Fe.test(t.charAt(Ci))?(i=t.charAt(Ci),Ci++):(i=bt,0===Si&&s(Ie));else r=bt;r!==bt?(Ai=e,n=$e(r),e=n):(Ci=e,e=bt)}else Ci=e,e=bt;return e}function A(){var e,n,r,i,o,a;return e=Ci,n=C(),n!==bt?(r=ft(),r!==bt?(61===t.charCodeAt(Ci)?(i=Be,Ci++):(i=bt,0===Si&&s(He)),i!==bt?(o=ft(),o!==bt?(a=j(),a!==bt?(Ai=e,n=Ue(n,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=Ci,n=C(),n!==bt?(r=ft(),r!==bt?(61===t.charCodeAt(Ci)?(i=Be,Ci++):(i=bt,0===Si&&s(He)),i!==bt?(o=ft(),o!==bt?(a=E(),a!==bt?(Ai=e,n=qe(n,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=Ci,n=C(),n!==bt&&(Ai=e,n=ze(n)),e=n)),e}function j(){var e,n,r,i,o,a,c,u;if(e=Ci,34===t.charCodeAt(Ci)?(n=Ve,Ci++):(n=bt,0===Si&&s(Je)),n!==bt){if(r=[],i=E(),i===bt){if(i=Ci,o=[],a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Ke.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(Ge)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt),a!==bt)for(;a!==bt;)o.push(a),a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Ke.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(Ge)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt);else o=bt;o!==bt&&(Ai=i,o=Ze()),i=o}for(;i!==bt;)if(r.push(i),i=E(),i===bt){if(i=Ci,o=[],a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Ke.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(Ge)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt),a!==bt)for(;a!==bt;)o.push(a),a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Ke.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(Ge)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt);else o=bt;o!==bt&&(Ai=i,o=Ze()),i=o}r!==bt?(34===t.charCodeAt(Ci)?(i=Ve,Ci++):(i=bt,0===Si&&s(Je)),i!==bt?(Ai=e,n=Xe(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;if(e===bt)if(e=Ci,39===t.charCodeAt(Ci)?(n=Ye,Ci++):(n=bt,0===Si&&s(We)),n!==bt){if(r=[],i=E(),i===bt){if(i=Ci,o=[],a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Qe.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(tn)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt),a!==bt)for(;a!==bt;)o.push(a),a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Qe.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(tn)),u!==bt?(c=[c,u],a=c):(Ci=a,
a=bt)):(Ci=a,a=bt);else o=bt;o!==bt&&(Ai=i,o=Ze()),i=o}for(;i!==bt;)if(r.push(i),i=E(),i===bt){if(i=Ci,o=[],a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Qe.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(tn)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt),a!==bt)for(;a!==bt;)o.push(a),a=Ci,c=Ci,Si++,t.substr(Ci,2)===Re?(u=Re,Ci+=2):(u=bt,0===Si&&s(Te)),Si--,u===bt?c=void 0:(Ci=c,c=bt),c!==bt?(Qe.test(t.charAt(Ci))?(u=t.charAt(Ci),Ci++):(u=bt,0===Si&&s(tn)),u!==bt?(c=[c,u],a=c):(Ci=a,a=bt)):(Ci=a,a=bt);else o=bt;o!==bt&&(Ai=i,o=Ze()),i=o}r!==bt?(39===t.charCodeAt(Ci)?(i=Ye,Ci++):(i=bt,0===Si&&s(We)),i!==bt?(Ai=e,n=Xe(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;return e}function E(){var e,n,r,i,o,a;return e=Ci,t.substr(Ci,2)===Re?(n=Re,Ci+=2):(n=bt,0===Si&&s(Te)),n!==bt?(r=ft(),r!==bt?(i=S(),i!==bt?(o=ft(),o!==bt?(t.substr(Ci,2)===en?(a=en,Ci+=2):(a=bt,0===Si&&s(nn)),a!==bt?(Ai=e,n=rn(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function P(){var t,e;return t=Ci,e=E(),e!==bt&&(Ai=t,e=on(e)),t=e}function S(){var e,n,r,i,o,a;return e=Ci,n=M(),n!==bt?(63===t.charCodeAt(Ci)?(r=sn,Ci++):(r=bt,0===Si&&s(an)),r!==bt?(i=S(),i!==bt?(58===t.charCodeAt(Ci)?(o=cn,Ci++):(o=bt,0===Si&&s(un)),o!==bt?(a=S(),a!==bt?(Ai=e,n=ln(n,i,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=M()),e}function R(){var e,n,r,i;return e=Ci,40===t.charCodeAt(Ci)?(n=fn,Ci++):(n=bt,0===Si&&s(hn)),n!==bt?(r=T(),r!==bt?(41===t.charCodeAt(Ci)?(i=pn,Ci++):(i=bt,0===Si&&s(dn)),i!==bt?(Ai=e,n=yn(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=Ci,t.substr(Ci,2)===vn?(n=vn,Ci+=2):(n=bt,0===Si&&s(gn)),n!==bt&&(Ai=e,n=mn()),e=n),e}function T(){var e,n,r,i,o,a;if(e=Ci,n=S(),n!==bt){for(r=[],i=Ci,44===t.charCodeAt(Ci)?(o=bn,Ci++):(o=bt,0===Si&&s(wn)),o!==bt?(a=S(),a!==bt?(o=[o,a],i=o):(Ci=i,i=bt)):(Ci=i,i=bt);i!==bt;)r.push(i),i=Ci,44===t.charCodeAt(Ci)?(o=bn,Ci++):(o=bt,0===Si&&s(wn)),o!==bt?(a=S(),a!==bt?(o=[o,a],i=o):(Ci=i,i=bt)):(Ci=i,i=bt);r!==bt?(Ai=e,n=_n(n,r),e=n):(Ci=e,e=bt)}else Ci=e,e=bt;return e}function M(){var e,n,r,i;return e=Ci,n=I(),n!==bt?(61===t.charCodeAt(Ci)?(r=Be,Ci++):(r=bt,0===Si&&s(He)),r!==bt?(i=M(),i!==bt?(Ai=e,n=On(n,i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=D()),e}function D(){var e,n,r,i;return e=Ci,n=N(),n!==bt?(t.substr(Ci,2)===xn?(r=xn,Ci+=2):(r=bt,0===Si&&s(kn)),r===bt&&(t.substr(Ci,2)===Cn?(r=Cn,Ci+=2):(r=bt,0===Si&&s(An)),r===bt&&(t.substr(Ci,3)===jn?(r=jn,Ci+=3):(r=bt,0===Si&&s(En)),r===bt&&(t.substr(Ci,2)===Pn?(r=Pn,Ci+=2):(r=bt,0===Si&&s(Sn)),r===bt&&(t.substr(Ci,3)===Rn?(r=Rn,Ci+=3):(r=bt,0===Si&&s(Tn)),r===bt&&(t.substr(Ci,2)===Mn?(r=Mn,Ci+=2):(r=bt,0===Si&&s(Dn)),r===bt&&(t.substr(Ci,3)===Nn?(r=Nn,Ci+=3):(r=bt,0===Si&&s(Ln)),r===bt&&(t.substr(Ci,2)===Fn?(r=Fn,Ci+=2):(r=bt,0===Si&&s(In)),r===bt&&(62===t.charCodeAt(Ci)?(r=jt,Ci++):(r=bt,0===Si&&s(Et)),r===bt&&(t.substr(Ci,3)===$n?(r=$n,Ci+=3):(r=bt,0===Si&&s(Bn)),r===bt&&(t.substr(Ci,2)===Hn?(r=Hn,Ci+=2):(r=bt,0===Si&&s(Un)),r===bt&&(60===t.charCodeAt(Ci)?(r=qt,Ci++):(r=bt,0===Si&&s(zt)),r===bt&&(43===t.charCodeAt(Ci)?(r=qn,Ci++):(r=bt,0===Si&&s(zn)),r===bt&&(45===t.charCodeAt(Ci)?(r=Vn,Ci++):(r=bt,0===Si&&s(Jn)),r===bt&&(37===t.charCodeAt(Ci)?(r=Kn,Ci++):(r=bt,0===Si&&s(Gn)),r===bt&&(42===t.charCodeAt(Ci)?(r=Zn,Ci++):(r=bt,0===Si&&s(Xn)),r===bt&&(47===t.charCodeAt(Ci)?(r=Yn,Ci++):(r=bt,0===Si&&s(Wn)))))))))))))))))),r!==bt?(i=D(),i!==bt?(Ai=e,n=Qn(n,r,i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=N()),e}function N(){var t,e,n,r;return t=Ci,e=ft(),e!==bt?(n=L(),n!==bt?(r=ft(),r!==bt?(Ai=t,e=tr(n),t=e):(Ci=t,t=bt)):(Ci=t,t=bt)):(Ci=t,t=bt),t}function L(){var t,e,n,r;if(t=Ci,e=$(),e!==bt){for(n=[],r=F();r!==bt;)n.push(r),r=F();n!==bt?(Ai=t,e=er(e,n),t=e):(Ci=t,t=bt)}else Ci=t,t=bt;return t===bt&&(t=X(),t===bt&&(t=I())),t}function F(){var e,n,r,i,o,a;return e=Ci,124===t.charCodeAt(Ci)?(n=nr,Ci++):(n=bt,0===Si&&s(rr)),n!==bt?(r=ft(),r!==bt?(i=et(),i!==bt?(o=R(),o===bt&&(o=null),o!==bt?(a=ft(),a!==bt?(Ai=e,n=ir(i,o),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function I(){var t,e,n,r;return t=Ci,e=ft(),e!==bt?(n=B(),n!==bt?(r=ft(),r!==bt?(Ai=t,e=or(n),t=e):(Ci=t,t=bt)):(Ci=t,t=bt)):(Ci=t,t=bt),t}function $(){var e,n,r;return e=Ci,33===t.charCodeAt(Ci)?(n=sr,Ci++):(n=bt,0===Si&&s(ar)),n!==bt?(r=$(),r!==bt?(Ai=e,n=cr(n,r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=Ci,33===t.charCodeAt(Ci)?(n=sr,Ci++):(n=bt,0===Si&&s(ar)),n===bt&&(45===t.charCodeAt(Ci)?(n=Vn,Ci++):(n=bt,0===Si&&s(Jn))),n!==bt?(r=$(),r!==bt?(Ai=e,n=ur(n,r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(e=z(),e===bt&&(e=X(),e===bt&&(e=I())))),e}function B(){var t;return t=q(),t===bt&&(t=nt(),t===bt&&(t=H(),t===bt&&(t=at(),t===bt&&(t=Y())))),t}function H(){var e,n,r,i,o,a;if(e=Ci,n=Ci,45===t.charCodeAt(Ci)?(r=Vn,Ci++):(r=bt,0===Si&&s(Jn)),r===bt&&(r=null),r!==bt){if(i=Ci,o=[],lr.test(t.charAt(Ci))?(a=t.charAt(Ci),Ci++):(a=bt,0===Si&&s(fr)),a!==bt)for(;a!==bt;)o.push(a),lr.test(t.charAt(Ci))?(a=t.charAt(Ci),Ci++):(a=bt,0===Si&&s(fr));else o=bt;o!==bt?(a=U(),a===bt&&(a=null),a!==bt?(o=[o,a],i=o):(Ci=i,i=bt)):(Ci=i,i=bt),i===bt&&(i=U()),i!==bt?(r=[r,i],n=r):(Ci=n,n=bt)}else Ci=n,n=bt;return n!==bt&&(Ai=e,n=hr(n)),e=n}function U(){var e,n,r,i;if(e=Ci,46===t.charCodeAt(Ci)?(n=pr,Ci++):(n=bt,0===Si&&s(dr)),n!==bt){if(r=[],lr.test(t.charAt(Ci))?(i=t.charAt(Ci),Ci++):(i=bt,0===Si&&s(fr)),i!==bt)for(;i!==bt;)r.push(i),lr.test(t.charAt(Ci))?(i=t.charAt(Ci),Ci++):(i=bt,0===Si&&s(fr));else r=bt;r!==bt?(n=[n,r],e=n):(Ci=e,e=bt)}else Ci=e,e=bt;return e}function q(){var e,n,r,i;return e=Ci,40===t.charCodeAt(Ci)?(n=fn,Ci++):(n=bt,0===Si&&s(hn)),n!==bt?(r=S(),r!==bt?(41===t.charCodeAt(Ci)?(i=pn,Ci++):(i=bt,0===Si&&s(dn)),i!==bt?(Ai=e,n=yr(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function z(){var t,e;return t=Ci,e=V(),e===bt&&(e=J(),e===bt&&(e=Z(),e===bt&&(e=K(),e===bt&&(e=G())))),e!==bt&&(Ai=t,e=vr(e)),t=e}function V(){var e,n;return e=Ci,t.substr(Ci,4)===gr?(n=gr,Ci+=4):(n=bt,0===Si&&s(mr)),n===bt&&(t.substr(Ci,5)===br?(n=br,Ci+=5):(n=bt,0===Si&&s(wr))),n!==bt&&(Ai=e,n=_r(n)),e=n}function J(){var e,n;return e=Ci,t.substr(Ci,9)===Or?(n=Or,Ci+=9):(n=bt,0===Si&&s(xr)),n!==bt&&(Ai=e,n=kr()),e=n}function K(){var e,n;return e=Ci,t.substr(Ci,3)===Cr?(n=Cr,Ci+=3):(n=bt,0===Si&&s(Ar)),n!==bt&&(Ai=e,n=jr()),e=n}function G(){var e,n;return e=Ci,t.substr(Ci,8)===Er?(n=Er,Ci+=8):(n=bt,0===Si&&s(Pr)),n!==bt&&(Ai=e,n=Sr()),e=n}function Z(){var e,n;return e=Ci,t.substr(Ci,4)===Rr?(n=Rr,Ci+=4):(n=bt,0===Si&&s(Tr)),n===bt&&(t.substr(Ci,4)===Mr?(n=Mr,Ci+=4):(n=bt,0===Si&&s(Dr))),n!==bt&&(Ai=e,n=Nr()),e=n}function X(){var t,e,n;return t=Ci,e=I(),e!==bt?(n=R(),n!==bt?(Ai=t,e=Lr(e,n),t=e):(Ci=t,t=bt)):(Ci=t,t=bt),t}function Y(){var e,n,r,i,o,a;if(e=Ci,94===t.charCodeAt(Ci)?(n=Fr,Ci++):(n=bt,0===Si&&s(Ir)),n===bt&&(t.substr(Ci,2)===$r?(n=$r,Ci+=2):(n=bt,0===Si&&s(Br)),n===bt&&(t.substr(Ci,3)===Hr?(n=Hr,Ci+=3):(n=bt,0===Si&&s(Ur)),n===bt&&(126===t.charCodeAt(Ci)?(n=qr,Ci++):(n=bt,0===Si&&s(zr)),n===bt&&(t.substr(Ci,2)===Vr?(n=Vr,Ci+=2):(n=bt,0===Si&&s(Jr)))))),n===bt&&(n=null),n!==bt)if(r=ft(),r!==bt)if(i=et(),i!==bt){for(o=[],a=W();a!==bt;)o.push(a),a=W();o!==bt?(a=ft(),a!==bt?(Ai=e,n=Kr(n,i,o),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;else Ci=e,e=bt;else Ci=e,e=bt;return e}function W(){var t;return t=Q(),t===bt&&(t=tt()),t}function Q(){var e,n,r;return e=Ci,46===t.charCodeAt(Ci)?(n=pr,Ci++):(n=bt,0===Si&&s(dr)),n!==bt?(r=et(),r!==bt?(Ai=e,n=Gr(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e}function tt(){var e,n,r,i;return e=Ci,91===t.charCodeAt(Ci)?(n=Zr,Ci++):(n=bt,0===Si&&s(Xr)),n!==bt?(r=S(),r!==bt?(93===t.charCodeAt(Ci)?(i=Yr,Ci++):(i=bt,0===Si&&s(Wr)),i!==bt?(Ai=e,n=Qr(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function et(){var e,n,r;if(e=Ci,n=[],ti.test(t.charAt(Ci))?(r=t.charAt(Ci),Ci++):(r=bt,0===Si&&s(ei)),r!==bt)for(;r!==bt;)n.push(r),ti.test(t.charAt(Ci))?(r=t.charAt(Ci),Ci++):(r=bt,0===Si&&s(ei));else n=bt;return n!==bt&&(Ai=e,n=ni(n)),e=n}function nt(){var e,n,r,i,o,a;return e=Ci,123===t.charCodeAt(Ci)?(n=ri,Ci++):(n=bt,0===Si&&s(ii)),n!==bt?(r=ft(),r!==bt?(i=rt(),i===bt&&(i=null),i!==bt?(o=ft(),o!==bt?(125===t.charCodeAt(Ci)?(a=oi,Ci++):(a=bt,0===Si&&s(si)),a!==bt?(Ai=e,n=ai(i),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function rt(){var t,e;return t=Ci,e=it(),e!==bt&&(Ai=t,e=ci(e)),t=e}function it(){var e,n,r,i,o,a;if(e=Ci,n=ot(),n!==bt){for(r=[],i=Ci,44===t.charCodeAt(Ci)?(o=bn,Ci++):(o=bt,0===Si&&s(wn)),o!==bt?(a=it(),a!==bt?(o=[o,a],i=o):(Ci=i,i=bt)):(Ci=i,i=bt);i!==bt;)r.push(i),i=Ci,44===t.charCodeAt(Ci)?(o=bn,Ci++):(o=bt,0===Si&&s(wn)),o!==bt?(a=it(),a!==bt?(o=[o,a],i=o):(Ci=i,i=bt)):(Ci=i,i=bt);r!==bt?(Ai=e,n=ui(n,r),e=n):(Ci=e,e=bt)}else Ci=e,e=bt;return e}function ot(){var e,n,r,i,o,a;return e=Ci,n=ft(),n!==bt?(r=st(),r!==bt?(i=ft(),i!==bt?(58===t.charCodeAt(Ci)?(o=cn,Ci++):(o=bt,0===Si&&s(un)),o!==bt?(a=S(),a===bt&&(a=null),a!==bt?(Ai=e,n=li(r,a),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt)):(Ci=e,e=bt),e}function st(){var t,e;return t=Ci,e=at(),e!==bt&&(Ai=t,e=fi(e)),t=e,t===bt&&(t=Ci,e=et(),e!==bt&&(Ai=t,e=hi(e)),t=e),t}function at(){var e,n,r,i;if(Si++,e=Ci,34===t.charCodeAt(Ci)?(n=Ve,Ci++):(n=bt,0===Si&&s(Je)),n!==bt){for(r=[],i=ct();i!==bt;)r.push(i),i=ct();r!==bt?(34===t.charCodeAt(Ci)?(i=Ve,Ci++):(i=bt,0===Si&&s(Je)),i!==bt?(Ai=e,n=di(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;if(e===bt)if(e=Ci,39===t.charCodeAt(Ci)?(n=Ye,Ci++):(n=bt,0===Si&&s(We)),n!==bt){for(r=[],i=ut();i!==bt;)r.push(i),i=ut();r!==bt?(39===t.charCodeAt(Ci)?(i=Ye,Ci++):(i=bt,0===Si&&s(We)),i!==bt?(Ai=e,n=di(r),e=n):(Ci=e,e=bt)):(Ci=e,e=bt)}else Ci=e,e=bt;return Si--,e===bt&&(n=bt,0===Si&&s(pi)),e}function ct(){var e,n,r;return e=Ci,n=Ci,Si++,34===t.charCodeAt(Ci)?(r=Ve,Ci++):(r=bt,0===Si&&s(Je)),r===bt&&(92===t.charCodeAt(Ci)?(r=yi,Ci++):(r=bt,0===Si&&s(vi))),Si--,r===bt?n=void 0:(Ci=n,n=bt),n!==bt?(r=lt(),r!==bt?(Ai=e,n=gi(),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(t.substr(Ci,2)===mi?(e=mi,Ci+=2):(e=bt,0===Si&&s(bi))),e}function ut(){var e,n,r;return e=Ci,n=Ci,Si++,39===t.charCodeAt(Ci)?(r=Ye,Ci++):(r=bt,0===Si&&s(We)),r===bt&&(92===t.charCodeAt(Ci)?(r=yi,Ci++):(r=bt,0===Si&&s(vi))),Si--,r===bt?n=void 0:(Ci=n,n=bt),n!==bt?(r=lt(),r!==bt?(Ai=e,n=gi(),e=n):(Ci=e,e=bt)):(Ci=e,e=bt),e===bt&&(t.substr(Ci,2)===wi?(e=wi,Ci+=2):(e=bt,0===Si&&s(_i))),e}function lt(){var e;return t.length>Ci?(e=t.charAt(Ci),Ci++):(e=bt,0===Si&&s(Oi)),e}function ft(){var e,n;for(e=[],xi.test(t.charAt(Ci))?(n=t.charAt(Ci),Ci++):(n=bt,0===Si&&s(ki));n!==bt;)e.push(n),xi.test(t.charAt(Ci))?(n=t.charAt(Ci),Ci++):(n=bt,0===Si&&s(ki));return e}function ht(t){return t.replace(/(^\s+)|(\s+$)/,"").replace(/[\r\n]/g,"\\n")}function pt(t){return t.replace(/[ \r\n\t]+/g," ")}function dt(t){return t=t.filter(function(t){return!/^[\n\t\r]+$/.test(t.value)}),1===t.length&&"string"===t[0].type?t[0]:t}function yt(t){function e(t){for(var e,n=t.length;n--&&(e=t[n],"textNode"==e.type&&!/\S/.test(e.value)&&!e.decoded);)t.splice(n,1);return t}return e(e(t.reverse()).reverse())}function vt(t){return t.replace(/[\n\r]+/g,"\\n").replace(/'/g,"\\'")}var gt,mt=arguments.length>1?arguments[1]:{},bt={},wt={Start:c},_t=c,Ot=function(t){return t},xt="<!DOCTYPE",kt={type:"literal",value:"<!DOCTYPE",description:'"<!DOCTYPE"'},Ct=/^[^>]/,At={type:"class",value:"[^>]",description:"[^>]"},jt=">",Et={type:"literal",value:">",description:'">"'},Pt=function(t){return["doctype",t.join("")]},St=function(t){return yt(t)},Rt="<!--",Tt={type:"literal",value:"<!--",description:'"<!--"'},Mt="-->",Dt={type:"literal",value:"-->",description:'"-->"'},Nt=function(t){return t},Lt=function(t){return["comment",vt(ht(t.join("")))]},Ft="<script",It={type:"literal",value:"<script",description:'"<script"'},$t="</script>",Bt={type:"literal",value:"</script>",description:'"</script>"'},Ht=function(t,e){return["element","script",t,[["text",vt(e.join(""))]]]},Ut=function(){return n()},qt="<",zt={type:"literal",value:"<",description:'"<"'},Vt="area",Jt={type:"literal",value:"area",description:'"area"'},Kt="base",Gt={type:"literal",value:"base",description:'"base"'},Zt="br",Xt={type:"literal",value:"br",description:'"br"'},Yt="col",Wt={type:"literal",value:"col",description:'"col"'},Qt="command",te={type:"literal",value:"command",description:'"command"'},ee="embed",ne={type:"literal",value:"embed",description:'"embed"'},re="hr",ie={type:"literal",value:"hr",description:'"hr"'},oe="img",se={type:"literal",value:"img",description:'"img"'},ae="input",ce={type:"literal",value:"input",description:'"input"'},ue="keygen",le={type:"literal",value:"keygen",description:'"keygen"'},fe="link",he={type:"literal",value:"link",description:'"link"'},pe="meta",de={type:"literal",value:"meta",description:'"meta"'},ye="param",ve={type:"literal",value:"param",description:'"param"'},ge="source",me={type:"literal",value:"source",description:'"source"'},be="track",we={type:"literal",value:"track",description:'"track"'},_e="wbr",Oe={type:"literal",value:"wbr",description:'"wbr"'},xe="/>",ke={type:"literal",value:"/>",description:'"/>"'},Ce=function(t,e,n){return n&&t!=n.name&&r("</"+t+">"),["element",t,e,[]]},Ae="</",je={type:"literal",value:"</",description:'"</"'},Ee=function(t){return{name:t}},Pe=function(t,e,n){return t.name!=n.name&&r("</"+t.name+">"),["element",t.name,t.attributes,e]},Se=function(t){return["text",vt(pt(t.join("")))]},Re="{{",Te={type:"literal",value:"{{",description:'"{{"'},Me=function(t){return t},De=function(t){return["element",t.name,t.attributes,[]]},Ne=function(t,e){return{name:t,attributes:e}},Le=function(t){return t},Fe=/^[a-zA-Z0-9:_.\-]/,Ie={type:"class",value:"[a-zA-Z0-9:_\\.\\-]",description:"[a-zA-Z0-9:_\\.\\-]"},$e=function(t){return t.join("")},Be="=",He={type:"literal",value:"=",description:'"="'},Ue=function(t,e){return["attribute",t,e]},qe=function(t,e){return["property",t,e]},ze=function(t){return["attribute",t,[]]},Ve='"',Je={type:"literal",value:'"',description:'"\\""'},Ke=/^[^"]/,Ge={type:"class",value:'[^"]',description:'[^"]'},Ze=function(){return["string",n()]},Xe=function(t){return dt(t)},Ye="'",We={type:"literal",value:"'",description:'"\'"'},Qe=/^[^']/,tn={type:"class",value:"[^']",description:"[^']"},en="}}",nn={type:"literal",value:"}}",description:'"}}"'},rn=function(t){return["script",t]},on=function(t){return["block",t[1]]},sn="?",an={type:"literal",value:"?",description:'"?"'},cn=":",un={type:"literal",value:":",description:'":"'},ln=function(t,e,n){return["condition",t,e,n]},fn="(",hn={type:"literal",value:"(",description:'"("'},pn=")",dn={type:"literal",value:")",description:'")"'},yn=function(t){return t},vn="()",gn={type:"literal",value:"()",description:'"()"'},mn=function(){return[]},bn=",",wn={type:"literal",value:",",description:'","'},_n=function(t,e){return[t].concat(e.map(function(t){return t[1]}))},On=function(t,e){return["assign",t,e]},xn="&&",kn={type:"literal",value:"&&",description:'"&&"'},Cn="||",An={type:"literal",value:"||",description:'"||"'},jn="===",En={type:"literal",value:"===",description:'"==="'},Pn="==",Sn={type:"literal",value:"==",description:'"=="'},Rn="!==",Tn={type:"literal",value:"!==",description:'"!=="'},Mn="!=",Dn={type:"literal",value:"!=",description:'"!="'},Nn=">==",Ln={type:"literal",value:">==",description:'">=="'},Fn=">=",In={type:"literal",value:">=",description:'">="'},$n="<==",Bn={type:"literal",value:"<==",description:'"<=="'},Hn="<=",Un={type:"literal",value:"<=",description:'"<="'},qn="+",zn={type:"literal",value:"+",description:'"+"'},Vn="-",Jn={type:"literal",value:"-",description:'"-"'},Kn="%",Gn={type:"literal",value:"%",description:'"%"'},Zn="*",Xn={type:"literal",value:"*",description:'"*"'},Yn="/",Wn={type:"literal",value:"/",description:'"/"'},Qn=function(t,e,n){return["operator",e,t,n]},tr=function(t){return t},er=function(t,e){for(var n=0,r=e.length;r>n;n++)t=["modifier",e[n].name,[t].concat(e[n].parameters)];return t},nr="|",rr={type:"literal",value:"|",description:'"|"'},ir=function(t,e){return{name:t,parameters:e||[]}},or=function(t){return t},sr="!",ar={type:"literal",value:"!",description:'"!"'},cr=function(t,e){return["not",e]},ur=function(t,e){return["negative",e]},lr=/^[0-9]/,fr={type:"class",value:"[0-9]",description:"[0-9]"},hr=function(t){return["literal",parseFloat(n())]},pr=".",dr={type:"literal",value:".",description:'"."'},yr=function(t){return["group",t]},vr=function(t){return t},gr="true",mr={type:"literal",value:"true",description:'"true"'},br="false",wr={type:"literal",value:"false",description:'"false"'},_r=function(t){return["literal","true"===t]},Or="undefined",xr={type:"literal",value:"undefined",description:'"undefined"'},kr=function(){return["literal",void 0]},Cr="NaN",Ar={type:"literal",value:"NaN",description:'"NaN"'},jr=function(){return["literal",NaN]},Er="Infinity",Pr={type:"literal",value:"Infinity",description:'"Infinity"'},Sr=function(){return["literal",1/0]},Rr="null",Tr={type:"literal",value:"null",description:'"null"'},Mr="NULL",Dr={type:"literal",value:"NULL",description:'"NULL"'},Nr=function(){return["literal",null]},Lr=function(t,e){return["call",t,e]},Fr="^",Ir={type:"literal",value:"^",description:'"^"'},$r="~>",Br={type:"literal",value:"~>",description:'"~>"'},Hr="<~>",Ur={type:"literal",value:"<~>",description:'"<~>"'},qr="~",zr={type:"literal",value:"~",description:'"~"'},Vr="<~",Jr={type:"literal",value:"<~",description:'"<~"'},Kr=function(t,e,n){return["reference",[e].concat(n),t]},Gr=function(t){return t},Zr="[",Xr={type:"literal",value:"[",description:'"["'},Yr="]",Wr={type:"literal",value:"]",description:'"]"'},Qr=function(t){return t},ti=/^[a-zA-Z_$0-9]/,ei={type:"class",value:"[a-zA-Z_$0-9]",description:"[a-zA-Z_$0-9]"},ni=function(t){return n()},ri="{",ii={type:"literal",value:"{",description:'"{"'},oi="}",si={type:"literal",value:"}",description:'"}"'},ai=function(t){return["hash",t]},ci=function(t){for(var e={},n=0,r=t.length;r>n;n++)e[t[n].key]=t[n].value;return e},ui=function(t,e){return[t].concat(e.length?e[0][1]:[])},li=function(t,e){return{key:t,value:e}},fi=function(t){return t[1]},hi=function(t){return t},pi={type:"other",description:"string"},di=function(t){return["string",t.join("")]},yi="\\",vi={type:"literal",value:"\\",description:'"\\\\"'},gi=function(){return n()},mi='\\"',bi={type:"literal",value:'\\"',description:'"\\\\\\""'},wi="\\'",_i={type:"literal",value:"\\'",description:'"\\\\\'"'},Oi={type:"any",description:"any character"},xi=/^[ \n\r\t]/,ki={type:"class",value:"[ \\n\\r\\t]",description:"[ \\n\\r\\t]"},Ci=0,Ai=0,ji=[{line:1,column:1,seenCR:!1}],Ei=0,Pi=[],Si=0;if("startRule"in mt){if(!(mt.startRule in wt))throw new Error("Can't start parsing from rule \""+mt.startRule+'".');_t=wt[mt.startRule]}if(gt=_t(),gt!==bt&&Ci===t.length)return gt;throw gt!==bt&&Ci<t.length&&s({type:"end",description:"end of input"}),a(null,Pi,Ei<t.length?t.charAt(Ei):null,Ei<t.length?o(Ei,Ei+1):o(Ei,Ei))}return t(e,Error),{SyntaxError:e,parse:n}}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return o.extendClass(s,{initialize:t||function(){},_update:e||function(){}})}var o=n(38),s=function(){function t(e,n){r(this,t),this._attrBindings={},this.ref=e,this.view=n,this.options=n.template.options,this._attributeClasses=this.options.attributes}return t.prototype.setAttribute=function(t,e){this.setAsRegisteredAttribute(t,e)||void 0!=e&&this.ref.setAttribute(t,e)},t.prototype.setProperty=function(t,e){this.setAsRegisteredAttribute(t,e)||(this.ref.nodeType?this.ref[t]=e:this.ref.setAttribute(t,e))},t.prototype.setAsRegisteredAttribute=function(t,e){if(this._attrBindings[t])this._attrBindings[t].value=e;else{var n=this._attributeClasses.get(t);if(!n)return!1;this._attrBindings[t]=new n(this.ref,t,e,this.view)}return!0},t.prototype.update=function(t){this._update();for(var e in this._attrBindings)this._attrBindings[e].update()},t.prototype.destroy=function(){for(var t in this._attrBindings)this._attrBindings[t].destroy()},t}();e.Binding=s,e.binding=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},c=n(6),u=n(5),l=n(61),f=n(33),h=n(23)("stick:factory:controller"),p=function(t,e,n){var r=document.createElement("controller");return r.setAttribute("name",e),n!=e&&r.setAttribute("as",n),r.appendChild(t),r},d=function(t){function e(t,n,o){r(this,e);var s=i(this,Object.getPrototypeOf(e).call(this));if(s.container=o,s.controller=n,s.name=t,s._id=c.uniqueId("ctrl"),"function"==typeof n&&""==n.name)try{Object.defineProperty(n,"name",{value:t})}catch(a){}return h("%s: Controller factory created: '%s', container %s",s.id,t,s.container.id),s}return o(e,t),s(e,[{key:"create",value:function(t){return a(this,void 0,Promise,regeneratorRuntime.mark(function e(){var n,r,i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.container.hasInstance(this.name)){e.next=2;break}return e.abrupt("return",c.Promise.resolve(this.container.get(this.name)));case 2:return this.container.registerSingleton(this.name,this.controller),n=t.contextName||this.name,e.next=6,this.container.get("$state");case 6:return r=e.sent,r=r.createChild(this.container,t.state),this.container.registerInstance("$state",r,!0),e.next=11,this.resolveTemplate(r,t);case 11:return i=e.sent,h("%s: Created template: %s",this.id,i.id),this.container.registerInstance("template",i,!0),h("%s: Instantiating controller '%s' as '%s'",this.id,this.name,n),e.next=17,this.container.get(this.name);case 17:return o=e.sent,r.set(n,o),i.setTarget(o),this.trigger("before:template:render"),s=i.render(),11!==s.nodeType&&3!==s.nodeType||(s=1===s.children.length?3===s.firstChild.nodeType?p(s,this.name,n):s.firstChild:p(s,this.name,n)),this.container.registerInstance("$el",s,!0),"function"==typeof o.onTemplateRender&&o.onTemplateRender.call(o,s,i),this.trigger("template:render"),t.el&&(this.trigger("before:element:attached",t.el),t.el.innerHTML="",t.el.appendChild(s),"function"==typeof o.onElementAttached&&o.onElementAttached.call(o,s,t.el),this.trigger("element:attached",s,t.el)),e.abrupt("return",o);case 28:case"end":return e.stop()}},e,this)}))}},{key:"resolveTemplate",value:function(t,e){return a(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,i,o,s,a,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.container.get("$templateCreator");case 2:return r=n.sent,n.next=5,this.container.get("$templateResolver");case 5:if(i=n.sent,o=void 0,!e.el||e.template){n.next=12;break}s=e.el.innerHTML,o=c.Promise.resolve(s),n.next=20;break;case 12:if(!e.template){n.next=19;break}if(!(e.template instanceof f.Template)){n.next=16;break}return a=e.template.view(t,{container:this.container,parentView:e.parentView}),n.abrupt("return",a);case 16:o=i(e.template),n.next=20;break;case 19:return n.abrupt("return",c.Promise.reject(new l.StickError("no element or template")));case 20:return n.next=22,o;case 22:return u=n.sent,n.abrupt("return",r(u,t));case 24:case"end":return n.stop()}},n,this)}))}},{key:"destroy",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h("%s: Destroying controller '%s'",this.id,this.name),t.next=3,this.container.get(this.name);case 3:e=t.sent,"function"==typeof e.onDestroy&&e.onDestroy.call(e),this.container.clear(),this.container.entries.clear();case 7:case"end":return t.stop()}},t,this)}))}},{key:"id",get:function(){return this._id}}]),e}(u.EventEmitter);e.ControllerFactory=d},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(t){function e(t){n(this,e);var i=r(this,Object.getPrototypeOf(e).call(this,t));return i.message=t,i}return i(e,t),e}(Error);e.StickError=o;var s=function(t){function e(t,i){n(this,e);var o=r(this,Object.getPrototypeOf(e).call(this,t));return o.errors=i,o}return i(e,t),e}(o);e.StickDependencyError=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){i=!0,o=c}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},u=n(16),l=n(5),f=n(30),h=n(61),p=n(17),d=n(6),y=n(33),v=n(63),g=n(60),m=n(23)("stick:factory:module"),b=function(t,e){var n=document.createElement("module");return n.setAttribute("name",e),n.appendChild(t),n},w=function(t){function e(t,n,o){r(this,e);var s=i(this,Object.getPrototypeOf(e).call(this));if(3!=arguments.length)throw new Error;if(s.name=t,s.module=n,s.container=o,"function"==typeof n&&""==n.name)try{Object.defineProperty(n,"name",{value:t})}catch(a){}return s._id=d.uniqueId("mod"),m("%s: Module factory created: '%s', container: %s",s.id,t,s.container.id),s.container.registerSingleton(t,n),s.container.registerInstance("$container",s.container),s}return o(e,t),a(e,[{key:"controller",value:function(t,e){var n=u.getDependencies(e),r=s(n,2),i=r[0],o=r[1];if(!i)throw new h.StickError("controller definition should be a function, function constructor or a object literal");var a=void 0;if("function"!=typeof i&&d.isObject(i)){var c=d.extend({},i);"function"==typeof i.initialize?(a=i.initialize,delete c.initialize):"function"==typeof i.constructor&&(a=i.constructor,delete c.constructor),o&&0!=o.length||u.getDependencies(a),d.assign(a.prototype,c)}else"function"==typeof i&&(a=i);if("function"!=typeof a)throw new h.StickError("controller defition should be a function or an object literal");u.setDependencyType(u.DependencyType.Controller)(a);var l=new g.ControllerFactory(t,a,this.container.createChild());return this.container.registerInstance(t,l,!0),m("%s: Register controller: '%s', %s",this.id,t,l.id),this}},{key:"service",value:function(t,e){var n=u.getDependencies(e),r=s(n,1),i=r[0];if(!i||"function"!=typeof i)throw new h.StickError("service should be a function");return u.setDependencyType(u.DependencyType.Service)(i),this.container.registerService(t,i),m("%s Register service %s",this.id,t),this}},{key:"factory",value:function(t,e){var n=u.getDependencies(e),r=s(n,1),i=r[0];if(!i)throw new h.StickError("factory");return m("%s Register factory %s",this.id,t),"function"==typeof i?(u.setDependencyType(u.DependencyType.Factory)(i),u.setActivator(i,p.FactoryActivator.instance),this.container.registerSingleton(t,i)):this.container.registerInstance(t,i),this}},{key:"create",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return c(this,void 0,Promise,regeneratorRuntime.mark(function e(){var n,r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.container.hasInstance(this.name)){e.next=3;break}return m("%s: Resolving module %s",this.id,this.name),e.abrupt("return",this.container.get(this.name));case 3:return this.container.registerSingleton("$state",v.State),e.next=6,this.container.get("$state");case 6:if(n=e.sent,m("%s: Creating module %s",this.id,this.name),!t.template&&!t.el){e.next=27;break}return e.next=11,this.resolveTemplate(n,t);case 11:return r=e.sent,m("%s: Created template: %s",this.id,r.id),this.container.registerInstance("template",r,!0),m("%s: Instantiating module '%s'",this.id,this.name),e.next=17,this.container.get(this.name);case 17:return i=e.sent,r.setTarget(i),this.trigger("before:template:render"),o=r.render(),11!==o.nodeType&&3!==o.nodeType||(o=1===o.children.length?3===o.firstChild.nodeType?b(o,this.name):o.firstChild:b(o,this.name)),this.container.registerInstance("$el",o,!0),"function"==typeof i.onTemplateRender&&i.onTemplateRender.call(i,o,r),this.trigger("template:render"),t.el&&(this.trigger("before:element:attached",t.el),t.el.innerHTML="",t.el.appendChild(o),"function"==typeof i.onElementAttached&&i.onElementAttached.call(i,o,t.el),this.trigger("element:attached",o,t.el)),e.abrupt("return",i);case 27:return e.abrupt("return",this.container.get(this.name));case 28:case"end":return e.stop()}},e,this)}))}},{key:"configure",value:function(t){return c(this,void 0,Promise,regeneratorRuntime.mark(function e(){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,/Provider$/.test(t)?t=t.replace("Provider",""):n=t+"Provider",r=void 0,!this.container.hasHandler(n,!1,!1)){e.next=7;break}return e.abrupt("return",this.container.get(t));case 7:if(!f.Repository.has(u.DependencyType.Service,t)){e.next=12;break}if(i=f.Repository.get(u.DependencyType.Service,t),this.container.register(i),!this.container.hasHandler(n,!1,!1)){e.next=12;break}return e.abrupt("return",this.container.get(n));case 12:throw new Error("No provider for "+t.replace("Provider",""));case 13:case"end":return e.stop()}},e,this)}))}},{key:"resolveTemplate",value:function(t,e){return c(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,i,o,s,a,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.container.get("$templateCreator");case 2:return r=n.sent,
n.next=5,this.container.get("$templateResolver");case 5:if(i=n.sent,o=void 0,!e.el||e.template){n.next=12;break}s=e.el.innerHTML,o=d.Promise.resolve(s),n.next=20;break;case 12:if(!e.template){n.next=19;break}if(!(e.template instanceof y.Template)){n.next=16;break}return a=e.template.view(t,{container:this.container}),n.abrupt("return",a);case 16:o=i(e.template),n.next=20;break;case 19:return n.abrupt("return",d.Promise.reject(new h.StickError("no element or template")));case 20:return n.next=22,o;case 22:return c=n.sent,n.abrupt("return",r(c,t));case 24:case"end":return n.stop()}},n,this)}))}},{key:"destroy",value:function(){}},{key:"id",get:function(){return this._id}}]),e}(l.EventEmitter);e.ModuleFactory=w},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){return t===Object(t)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function g(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:g(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},l=function(t,e,n,r){var i,o=arguments.length,s=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(3>o?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},f=n(64),h=n(6),p=n(15),d=n(23)("stick:state");e.get_atributes=function(t){var e=Object.keys(t),n={},r={};return e.map(function(e){return{key:e,value:t[e]}}).filter(function(e){return h.has(t,e.key)?e.value&&h.isPromise(e.value)?(n[e.key]=e.value,delete t[e.key],!1):!0:!1}).forEach(function(t){r[t.key]=t.value}),{attr:r,deferred:n}};var y=void 0,v=y=function(t){function n(t,e){r(this,n);var o=i(this,Object.getPrototypeOf(n).call(this,e));return o._container=t,d("%s: State created",o.uid),o}return o(n,t),a(n,[{key:"get",value:function(t){return d("%s: Get attribute: %s",this.uid,t),c(Object.getPrototypeOf(n.prototype),"get",this).call(this,t)}},{key:"set",value:function(t,r){var i=this,o={},a={},u={};"string"==typeof t?null==r?u[t]=r:a[t]=r:s(t)&&(a=t);var l=e.get_atributes(a),f=l.attr,p=l.deferred;return h.isEmpty(p)||(d("%s: Resolve deferred values: %j",this.uid,Object.keys(p)),h.objectToPromise(p).then(function(t){i.set(t)})),h.isEmpty(f)||(d("%s: Set attributes: %j",this.uid,Object.keys(f)),c(Object.getPrototypeOf(n.prototype),"set",this).call(this,f,o)),h.isEmpty(u)||(d("%s: Unset attributes: %j",this.uid,Object.keys(u)),c(Object.getPrototypeOf(n.prototype),"set",this).call(this,u)),this}},{key:"createChild",value:function(t,e){t||(t=this.container.createChild());var n=new y(t,e);return n._parent=n,d("%s: Create child %s",this.uid,n.uid),n}},{key:"$destroy",value:function(){c(Object.getPrototypeOf(n.prototype),"destroy",this).call(this),d("%s: State destroyed",this.uid)}},{key:"parent",get:function(){return this._parent}},{key:"container",get:function(){return this._container}}]),n}(f.NestedModel);v=y=l([p.inject("$container")],v),e.State=v},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(65)),r(n(68)),r(n(69)),r(n(70)),r(n(71)),r(n(73))},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(66),o=n(68),s=n(9),a=n(7),c=n(8),u={add:!0,remove:!0,merge:!0},l={add:!0,remove:!1},f=function(t){function e(e,n){void 0===n&&(n={}),t.call(this),this.options=n,this.options.model&&(this.Model=this.options.model),e&&this.add(e)}return r(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.models.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Model",{get:function(){return this._model||(this._model=o.Model),this._model},set:function(t){this._model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"models",{get:function(){return this._models||(this._models=[])},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){var n=this;void 0===e&&(e={}),Array.isArray(t)?t=t.map(function(t){return t instanceof n.Model?t:n._prepareModel(t)}):t instanceof this.Model||(t=this._prepareModel(t)),this.set(t,s.extend({merge:!1},e,l))},e.prototype.set=function(t,e){void 0===e&&(e={}),e=s.extend({},u,e),e.parse&&(t=this.parse(t,e));var n,r,i,o,a,c,l,f=!Array.isArray(t),h=f?t?[t]:[]:t.slice(),p=e.at,d=this.comparator&&null==p&&e.sort!==!1,y="string"==typeof this.comparator?this.comparator:null,v=[],g=[],m={},b=e.add,w=e.merge,_=e.remove,O=!d&&b&&_?[]:null;for(n=0,r=h.length;r>n;n++){if(o=h[n],o=this._prepareModel(o),i=o.get(o.idAttribute)||o.uid,c=this.get(i))_&&(m[c.uid]=!0),w&&(a=o.toJSON(),c.set(a,e),d&&!l&&c.hasChanged(y)&&(l=!0)),h[n]=c;else if(b){if(h[n]=o,!o)continue;v.push(o),this._addReference(o,e)}o=c||o,O&&!m[o.id]&&O.push(o),m[o.uid]=!0}if(_){for(n=0,r=this.length;r>n;++n)m[(o=this.models[n]).uid]||g.push(o);g.length&&this.remove(g,e)}if(v.length||O&&O.length)if(d&&(l=!0),null!=p)for(n=0,r=v.length;r>n;n++)this.models.splice(p+n,0,v[n]);else{O&&(this.models.length=0);var x=O||v;for(n=0,r=x.length;r>n;n++)this.models.push(x[n])}if(l&&this.sort({silent:!0}),!e.silent){for(n=0,r=v.length;r>n;n++)(o=v[n]).trigger("add",o,this,e);(l||O&&O.length)&&this.trigger("sort",this,e),(v.length||g.length)&&this.trigger("update",this,e)}return f?h[0]:h},e.prototype.remove=function(t,e){void 0===e&&(e={});var n=!Array.isArray(t);t=n?[t]:t.slice();var r,i,o,s;for(r=0,i=t.length;i>r;r++)s=t[r]=this.get(t[r]),s&&(o=this.indexOf(s),this.models.splice(o,1),e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s,e));return n?t[0]:t},e.prototype.get=function(t){return this.find(t)},e.prototype.at=function(t){return this.models[t]},e.prototype.clone=function(t){return t=t||this.options,new this.constructor(this.models,t)},e.prototype.sort=function(t){if(void 0===t&&(t={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");return"string"==typeof this.comparator||1===this.comparator.length?this._models=this.sortBy(this.comparator,this):this.models.sort(this.comparator.bind(this)),t.silent||this.trigger("sort",this,t),this},e.prototype.sortBy=function(t,e){return a.sortBy(this._models,t,e)},e.prototype.push=function(t,e){return void 0===e&&(e={}),this.add(t,s.extend({at:this.length},e))},e.prototype.reset=function(t,e){var n=this;return void 0===e&&(e={}),this.forEach(function(t){n._removeReference(t,e)}),e.previousModels=this.models,this._reset(),t=this.add(t,e),e.silent||this.trigger("reset",this,e),t},e.prototype.create=function(t,e){void 0===e&&(e={add:!0});var n=new this.Model(t,e);return e.add&&this.add(n),n},e.prototype.parse=function(t,e){return void 0===e&&(e={}),t},e.prototype.find=function(t){var e;return e="function"==typeof t?a.find(this.models,t):a.find(this.models,function(e){return e.id==t||e.uid==t||t===e})},e.prototype.forEach=function(t,e){for(var n=0,r=this.models.length;r>n;n++)t.call(e||this,this.models[n],n);return this},e.prototype.filter=function(t){var e=[];return this.forEach(function(n,r){t(n,r)&&e.push(n)}),e},e.prototype.indexOf=function(t){return this.models.indexOf(t)},e.prototype.toJSON=function(){return this.models.map(function(t){return t.toJSON()})},e.prototype._prepareModel=function(t){if(t instanceof o.Model)return t;if(s.isObject(t))return new this.Model(t,{parse:!0});throw new Error("Value not an Object or an instance of a model, but was: "+typeof t)},e.prototype._removeReference=function(t,e){this===t.collection&&delete t.collection,this.stopListening(t)},e.prototype._addReference=function(t,e){t.collection||(t.collection=this),this.listenTo(t,"all",this._onModelEvent)},e.prototype._reset=function(){this._models=[]},e.prototype._onModelEvent=function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),c.callFunc(this.trigger,this,a.slice(arguments)))},e.prototype.destroy=function(){var e=this;this.models.forEach(function(t){"function"==typeof t.destroy&&t.collection==e&&t.destroy()}),t.prototype.destroy.call(this)},e}(i.BaseObject);e.Collection=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(67),o=n(8),s=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.extend=function(t,e){return o.inherits(this,t,e)},e}(i.EventEmitter);e.BaseObject=s},function(t,e){"use strict";function n(){return""+ ++i}function r(t,e){void 0===e&&(e=[]);var n=t.length,r=-1,i=e[0],o=e[1],s=e[2],a=e[3];switch(e.length){case 0:for(;++r<n;)t[r].handler.call(t[r].ctx);return;case 1:for(;++r<n;)t[r].handler.call(t[r].ctx,i);return;case 2:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o);return;case 3:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s);return;case 4:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s,a);return;default:for(;++r<n;)t[r].handler.apply(t[r].ctx,e);return}}var i=0;e.callFunc=r;var o=function(){function t(){}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){void 0===r&&(r=!1);var i=(this._listeners||(this._listeners={}))[t]||(this._listeners[t]=[]);return i.push({name:t,once:r,handler:e,ctx:n||this}),this},t.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},t.prototype.off=function(t,e){if(this._listeners=this._listeners||{},null==t)this._listeners={};else if(this._listeners[t]){var n=this._listeners[t];if(null==e)this._listeners[t]=[];else for(var r=0;r<n.length;r++){n[r];n[r].handler==e&&this._listeners[t].splice(r,1)}}},t.prototype.trigger=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=(this._listeners||(this._listeners={}))[e]||(this._listeners[e]=[]).concat(this._listeners.all||[]);t.debugCallback&&t.debugCallback(this.constructor.name,this.name,e,n);for(var s,a,c,u=(o.length,[]),l=0,f=o.length;f>l;l++)s=o[l],a=n,"all"==s.name?(a=[e].concat(n),r([s],a)):u.push(s),s.once===!0&&(c=this._listeners[s.name].indexOf(s),this._listeners[s.name].splice(c,1));return u.length&&this._executeListener(u,n),this},t.prototype._executeListener=function(t,e){var n=r;this.constructor.executeListenerFunction&&(n=this.constructor.executeListenerFunction),n(t,e)},t.prototype.listenTo=function(t,e,r,i,o){void 0===o&&(o=!1);var s,a,c;return s=this._listeningTo||(this._listeningTo={}),a=t.listenId||(t.listenId=n()),s[a]=t,c=o?"once":"on",t[c](e,r,this),this},t.prototype.listenToOnce=function(t,e,n,r){return this.listenTo(t,e,n,r,!0)},t.prototype.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;var i=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t.listenId]=t);for(var o in r)t=r[o],t.off(e,n,this),!i&&Object.keys(t.listeners).length||delete this._listeningTo[o];return this},t.prototype.destroy=function(){this.stopListening(),this.off()},t}();e.EventEmitter=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(66),o=n(8),s=n(9),a=function(t){function e(e,n){void 0===e&&(e={}),void 0===n&&(n={}),t.call(this),n=n||{},this._attributes={},this.options=n,n.parse&&(e=this.parse(e)),this.set(e,null,{silent:!0}),this.uid=o.uniqueId("uid"),this._changed={},this.collection=n.collection,this.idAttribute=n.idAttribute||this.idAttribute||"id"}return r(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.idAttribute in this._attributes?this._attributes[this.idAttribute]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNew",{get:function(){return null==this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDirty",{get:function(){return this.hasChanged()},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,n){void 0===n&&(n={});var r,i,a,c,u,l,f,h={};if(null==t)return this;"object"==typeof t?(h=t,n=e):h[t]=e,n||(n={}),i=n.unset,c=n.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=s.extend(Object.create(null),this._attributes),this._changed={}),f=this._attributes,l=this._previousAttributes;for(r in h)e=h[r],o.equal(f[r],e)||a.push(r),o.equal(l[r],e)?delete this._changed[r]:this._changed[r]=e,i?delete f[r]:f[r]=e;if(!c){a.length&&(this._pending=!!n);for(var p=0,d=a.length;d>p;p++)this.trigger("change:"+a[p],this,f[a[p]],n)}if(u)return this;if(!c)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},e.prototype.get=function(t){return this._attributes[t]},e.prototype.unset=function(t,e){this.set(t,void 0,s.extend({},e,{unset:!0}))},e.prototype.has=function(t){return null!=this.get(t)},e.prototype.hasChanged=function(t){return null==t?!!Object.keys(this.changed).length:s.has(this.changed,t)},e.prototype.clear=function(t){var e={};for(var n in this._attributes)e[n]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},Object.defineProperty(e.prototype,"changed",{get:function(){return s.extend({},this._changed)},enumerable:!0,configurable:!0}),e.prototype.changedAttributes=function(t){if(!t)return this.hasChanged()?s.extend(Object.create(null),this.changed):!1;var e,n={},r=this._changing?this._previousAttributes:this._attributes;for(var i in t)o.equal(r[i],e=t[i])||((n||(n={}))[i]=e);return n},e.prototype.previous=function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},e.prototype.previousAttributes=function(){return s.extend(Object.create(null),this._previousAttributes)},e.prototype.toJSON=function(){return JSON.parse(JSON.stringify(this._attributes))},e.prototype.clone=function(){return new this.constructor(this._attributes,this.options)},e.prototype.parse=function(t,e){return t},e.prototype.remove=function(t){this.trigger("remove",this,this.collection,t)},e}(i.BaseObject);e.Model=a},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e=".");var n={};if(!t)return t;for(var i in t){var o=t[i];if(!o||o.constructor!==Object&&o.constructor!==Array||l.isEmpty(o))n[i]=o;else{var s=r(o);for(var a in s){var c=s[a];n[i+e+a]=c}}}return n}function i(t,e,n){void 0===n&&(n=".");var r=e?e.split(n):[];if(!t)return!1;for(var i=t,o=0,s=r.length;s>o;o++){if(i instanceof f.Model)return!0;if(!i)return!1;i=i[r[o]]}return!1}function o(t,e,n,r){if(void 0===r&&(r="."),!t)return null;for(var i=e?e.split(r):[],o=t,s=0,a=i.length;a>s;s++){if(n&&!l.has(o,i[s]))return!1;if(o=o instanceof f.Model?o.get(i[s]):o[i[s]],null==o&&a-1>s&&(o={}),"undefined"==typeof o)return n?!0:o}return n?!0:o}function s(t,e,n,r){if(r=r||{},!t)return null;for(var i=r.separator||".",o=e?e.split(i):[],s=t,a=0,c=o.length;c>a&&void 0!==s;a++){var u=o[a];if(a===c-1)r.unset?delete s[u]:s[u]=n;else{if("undefined"==typeof s[u]||!l.isObject(s[u])){if(r.unset)return void delete s[u];var h=o[a+1];s[u]=/^\d+$/.test(h)?[]:{}}if(s=s[u],s instanceof f.Model){var p=o.slice(a+1);return s.set(p.join("."),n,r)}}}}function a(t,e){s(t,e,null,{unset:!0})}var c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=n(8),l=n(9),f=n(68),h=function(t){function e(){t.apply(this,arguments)}return c(e,t),e.prototype.get=function(t){return o(this._attributes,t)},e.prototype.set=function(t,n,c){var h,p,d,y,v,g,m,b,w=this;if(null==t)return this;"object"==typeof t?(p=t,c=n||{}):(p={})[t]=n,c||(c={}),d=c.unset,v=c.silent,y=[],g=this._changing,this._changing=!0,g||(this._previousAttributes=l.extend({},this._attributes),this._changed={}),b=this._attributes,m=this._previousAttributes,p=r(p);var _={},O=e.keyPathSeparator;this._nestedListener||(this._nestedListener={});for(h in p){n=p[h];var x=o(b,h);if(u.equal(x,n)||(y.push(h),this._changed[h]=n),u.equal(o(m,h),n)?a(this.changed,h):s(this.changed,h,n),x instanceof f.Model){var k=this._nestedListener[h];k&&(x.off("change",k),delete this._nestedListener[h])}if(d)a(b,h);else{if(i(b,h,O))_[h]=!0;else if(n instanceof f.Model){var k=function(t){if(void 0!=t.changed&&!l.isEmpty(t.changed)){for(var e in t.changed)w._changed[h+O+e]=t.changed[e],w.trigger("change:"+h+O+e,t.changed[e]);w.trigger("change",w,c)}};this._nestedListener[h]=k,n.on("change",k)}s(b,h,n)}}if(!v){y.length&&(this._pending=!0);for(var C=0,A=y.length;A>C;C++){var j=y[C];_.hasOwnProperty(j)&&_[j]||(_[j]=!0,this.trigger("change:"+j,this,o(b,j),c));for(var E=j.split(O),P=E.length-1;P>0;P--){var S=E.slice(0,P).join(O),R=S+O+"*";_.hasOwnProperty(R)&&_[R]||(_[R]=!0,this.trigger("change:"+R,this,o(b,S),c)),_.hasOwnProperty(S)&&_[S]||(_[S]=!0,this.trigger("change:"+S,this,o(b,S),c))}}}if(g)return this;if(!v)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},e.prototype.clear=function(t){var e={},n=r(this._attributes);for(var i in n)e[i]=void 0;return this.set(e,l.extend({},t,{unset:!0}))},e.prototype.hasChanged=function(t){return null==t?!Object.keys(this.changed).length:void 0!==o(this.changed,t)},e.prototype.changedAttributes=function(t){if(!t)return this.hasChanged()?r(this.changed):!1;var e=this._changing?this._previousAttributes:this._attributes;t=r(t),e=r(e);var n,i=!1;for(var o in t)u.equal(e[o],n=t[o])||((i||(i={}))[o]=n);return i},e.prototype.previous=function(t){return null!=t&&this._previousAttributes?o(this._previousAttributes,t):null},e.prototype.previousAttributes=function(){return l.extend({},this._previousAttributes)},e.prototype.destroy=function(){for(var e in this._nestedListener){var n=this._nestedListener[e];if(n){var r=this.get(e);r&&r.off(e,n)}}t.prototype.destroy.call(this)},e.keyPathSeparator=".",e}(f.Model);e.NestedModel=h},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(9),o=n(65),s=n(71),a=n(11),c=n(72),u=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,e,n),n.url&&(this.url=n.url),this.options.queryParameter=this.options.queryParameter||"q"}return r(e,t),e.prototype.getURL=function(){return"function"==typeof this.url?this.url():this.url},e.prototype.fetch=function(t){var e=this;t=t?i.extend({},t):{};var n=this.getURL();return null==n?a.Promise.reject(new Error("Url or rootURL no specified")):(t.url=n,this.trigger("before:fetch"),this.sync(c.RestMethod.Read,this,t).then(function(n){return e[t.reset?"reset":"set"](n.content,t),e.trigger("fetch"),e})["catch"](function(t){throw e.trigger("error",t),t}))},e.prototype.create=function(t,e){var n=this;e=e?i.extend({},e):{};var r,o=this.getURL();if(null==o)throw new Error("Url or rootURL no specified");return e.url=o,r=t instanceof s.RestModel?t:new this.Model(t,{parse:!0}),void 0===e.wait&&(e.wait=!0),e.wait||this.add(r,e),this.trigger("before:create",this,r,t,e),r.save().then(function(){e.wait||n.add(r,e),n.trigger("create",n,r,t,e),e.complete&&e.complete(null,r)})["catch"](function(t){n.trigger("error",t),e.complete&&e.complete(t,null)}),r},e.prototype.query=function(t,e){var n=this;void 0===e&&(e={});var r=(s={},s[this.options.queryParameter]=t,s),o=this.getURL();return null==o?a.Promise.reject(new Error("Url or rootURL no specified")):(e.url=o,e.params||(e.params={}),i.extend(e.params,r),this.trigger("before:query"),this.sync(c.RestMethod.Read,this,e).then(function(t){return n.reset(t.content,e),n.trigger("query"),n.models})["catch"](function(t){throw n.trigger("error",t),t}));var s},e.prototype.sync=function(t,e,n){return c.sync(t,e,n)},e}(o.Collection);e.RestCollection=u},function(t,e,n){"use strict";function r(t,e){var n,r="";return(n=t.indexOf("?"))>=0&&(r=t.substr(n),t=t.substr(0,n)),"/"!==t[t.length-1]&&(t+="/"),t+e+r}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(9),s=n(11),a=n(69),c=n(72);e.normalize_path=r;var u=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,e,n),this.idAttribute="id",n.url&&(this.rootURL=n.url)}return i(e,t),e.prototype.getURL=function(t){var e=this.rootURL;return this.collection&&this.collection.getURL()&&(e=this.collection.getURL()),t&&e&&(e=r(e,this.id)),e},e.prototype.fetch=function(t){var e=this;t=t?o.extend({},t):{};var n=this.getURL();return null==n?s.Promise.reject(new Error("Url or rootURL no specified")):(t.url=n,this.trigger("before:fetch",this,t),this.sync(c.RestMethod.Read,this,t).then(function(n){return n&&e.set(e.parse(n.content,t),t),e.trigger("fetch",e,n,t),e})["catch"](function(t){if(e.trigger("error",e,t),t)throw t;return e}))},e.prototype.save=function(t){var e=this;t=t?o.extend({},t):{},this.trigger("before:save",this,t);var n=c.RestMethod[this.isNew?"Create":t.changed?"Patch":"Update"],r=this.getURL(this.id);return null==r?s.Promise.reject(new Error("Url or rootURL no specified")):(t.url=r,this.sync(n,this,t).then(function(n){return e.set(n.content,t),e.trigger("save",e,n,t),e})["catch"](function(t){throw e.trigger("error",e,t),t}))},e.prototype.remove=function(e){var n=this;if(e=e?o.extend({},e):{},this.isNew)return t.prototype.remove.call(this,e),s.Promise.resolve(this);var r=this.getURL(this.id);return null==r?s.Promise.reject(new Error("Url or rootURL no specified")):(this.trigger("before:remove",this,e),e.wait||t.prototype.remove.call(this,e),e.url=r,this.sync(c.RestMethod.Delete,this,e).then(function(r){return e.wait||t.prototype.remove.call(n,e),n})["catch"](function(t){throw n.trigger("error",n,t),t}))},e.prototype.sync=function(t,e,n){return c.sync(t,e,n)},e}(a.NestedModel);e.RestModel=u},function(t,e,n){"use strict";function r(t,e,n){var r;switch(t){case a.Create:r="POST";break;case a.Update:r="PUT";break;case a.Patch:r="PATCH";break;case a.Delete:r="DELETE";break;case a.Read:r="GET";break;default:return i.Promise.reject(new Error("Sync: does not recognise method: "+t))}var c,u=o.ajax(),h=n.url;if(n.params&&(c=s.queryParam(n.params)),c){var p=-1===n.url.indexOf("?")?"?":"&";h+=p+c.substring(1)}return new i.Promise(function(i,s){if(u.onreadystatechange=function(){if(4===u.readyState){var e={method:t,status:u.status,content:l(n.headers.Accept,u)};if(o.proxy(e,u,["getAllResponseHeaders","getResponseHeader"]),f(u))return i(e);var r=new Error("Server responded with status of "+u.statusText);return s(r)}},u.open(r,h,!0),n.headers&&n.headers.Accept||(n.headers={Accept:"application/json"}),n.headers)for(var a in n.headers)u.setRequestHeader(a,n.headers[a]);n.beforeSend&&n.beforeSend(u),u.send(JSON.stringify(e.toJSON()))})}var i=n(11),o=n(8),s=n(13);!function(t){t[t.Create=0]="Create",t[t.Update=1]="Update",t[t.Read=2]="Read",t[t.Patch=3]="Patch",t[t.Delete=4]="Delete"}(e.RestMethod||(e.RestMethod={}));var a=e.RestMethod,c=/^(?:application|text)\/xml/,u=/^application\/json/,l=function(t,e){return null==t&&(t=e.getResponseHeader("content-type")),c.test(t)?e.responseXML:u.test(t)&&""!==e.responseText?JSON.parse(e.responseText):e.responseText},f=function(t){return t.status>=200&&t.status<300||304===t.status||0===t.status&&"file:"===window.location.protocol};e.sync=r},function(t,e,n){"use strict";function r(t){for(var e,n,r,i,o={},s=decodeURIComponent,a=t.split("&"),c=0,u=a.length;u>c;c++){var l=a[c];e=l.split("="),n=e[0],r=e[1],null==r&&(r=!0),n=s(n),r=s(r),i=o[n],Array.isArray(i)?i.push(r):i?o[n]=[i,r]:o[n]=r}return o}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(65),s=n(70),a=n(11),c=n(72),u=n(9),l=n(13),f=/[\s'"]/g,h=/[<>\s'"]/g,p=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,e,n),this._state={first:1,last:-1,current:1,size:10},this._link={},this.queryParams={page:"page",size:"pageSize"},n.queryParams&&u.extend(this.queryParams,n.queryParams),n.firstPage&&(this._state.first=n.firstPage),n.pageSize&&(this._state.size=n.pageSize),this._state.current=this._state.first,this._page=new o.Collection,this._page.Model=this.Model}return i(e,t),Object.defineProperty(e.prototype,"page",{get:function(){return this._page},enumerable:!0,configurable:!0}),e.prototype.hasNext=function(){return this.hasPage(this._state.current+1)},e.prototype.hasPrevious=function(){return this.hasPage(this._state.current-1)},e.prototype.hasPage=function(t){return this._state.last>-1?t<=this._state.last:!1},e.prototype.getPreviousPage=function(t){return t=t?u.extend({},t):{},t.page=this._state.current-1,this.getPage(t)},e.prototype.getNextPage=function(t){return t=t?u.extend({},t):{},t.page=this._state.current+1,this.getPage(t)},e.prototype.getPage=function(t){return t=t?u.extend({},t):{},void 0===t.page?a.Promise.reject(new Error("No page")):(this._state.last<t.page&&-1!=this._state.last?t.page=this._state.last:t.page<this._state.first&&(t.page=this._state.first),this.fetch(t))},e.prototype.fetch=function(t){var e=this;void 0===t&&(t={}),t=t?u.extend({},t):{};var n;u.has(t,"page")||(t.page=this._state.current);var i=t.params?u.extend({},t.params):{};if(u.has(i,this.queryParams.page)&&delete i[this.queryParams.page],n=this._link[t.page],n||(n=this.getURL()),!n)return a.Promise.reject(new Error("no url specified"));var o=n.indexOf("?");return o>-1&&(i=u.extend(i,r(n.substr(o+1))),n=n.substr(0,o)),u.has(i,this.queryParams.page)||(i[this.queryParams.page]=t.page),t.params=i,t.url=n,this.trigger("before:fetch",this,t),i[this.queryParams.size]=this._state.size,this._link[t.page+""]||(this._link[t.page]=n+l.queryParam({page:t.page})),this.sync(c.RestMethod.Read,this,t).then(function(n){return e._processResponse(n,t),e.trigger("fetch",e,n,t),e})["catch"](function(t){throw e.trigger("error",t),t})},e.prototype._processResponse=function(t,e){var n=e.page,i=this._parseLinkHeaders(t);if(i.first&&(this._link[this._state.first]=i.first),i.prev&&(this._link[n-1]=i.prev),i.next&&(this._link[n+1]=i.next),i.last){var o=i.last,s=o.indexOf("?");if(s>-1){var a=r(o.substr(s+1));u.has(a,this.queryParams.page)&&(this._link[a[this.queryParams.page]]=o,this._state.last=parseInt(a[this.queryParams.page]))}}this._state.current=n;var c=t.content;if(c&&!Array.isArray(c)&&(c=[c]),!c)return this;c=this.parse(c);for(var l=0,f=c.length;f>l;l++)c[l]=this._prepareModel(c[l]);return this[e.reset?"reset":"set"](c,e),this.page.reset(c),this},e.prototype._parseLinkHeaders=function(t){var e={};if("function"!=typeof t.getResponseHeader)return e;var n=t.getResponseHeader("Link");if(!n)return e;n=n.split(",");for(var r=["first","prev","next","last"],i=0,o=n.length;o>i;i++)for(var s=n[i].split(";"),a=s[0].replace(h,""),c=s.slice(1),u=0,l=c.length;l>u;u++){var p=c[u].split("="),d=p[0].replace(f,""),y=p[1].replace(f,"");"rel"==d&&~r.indexOf(y)&&(e[y]=a)}return e},e}(s.RestCollection);e.PaginatedCollection=p},function(t,e,n){"use strict";function r(t,e){var n=f.getDependencies(e),r=l(n,1),i=r[0];if(!i||"function"!=typeof i)throw new h.StickError("service should be a function");p.Repository.add(f.DependencyType.Service,t,i)}function i(t,e){var n=f.getDependencies(e),r=l(n,1),i=r[0];if(!i)throw new h.StickError("factory");p.Repository.add(f.DependencyType.Factory,t,i)}function o(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null==e){var n=void 0;if(w.hasHandler(t))n=w.get(t);else{if(!p.Repository.has(f.DependencyType.Module,t))throw new h.StickError("no module named "+t);var r=p.Repository.get(f.DependencyType.Module,t);n=new y.ModuleFactory(t,r.handler,w.createChild()),w.registerInstance(t,n)}return n}var i=f.getDependencies(e),o=l(i,2),s=o[0],a=o[1];if(s){var c=void 0;if("function"!=typeof s&&d.isObject(s)){var u=d.extend({},s);"function"==typeof s.initialize?(c=s.initialize,delete u.initialize):"function"==typeof s.constructor&&(c=s.constructor,delete u.constructor),a&&0!=a.length?c.inject=a:f.getDependencies(c),d.assign(c.prototype,u)}else"function"==typeof s&&(c=s);if("function"!=typeof c)throw new h.StickError("controller defition should be a function or an object literal");var v=new y.ModuleFactory(t,c,w.createChild());return w.registerInstance(t,v,!0),v}throw new h.StickError("controller defition should be a function or an object literal")}function s(t,e){var n=void 0;if("function"==typeof e)n=e;else{if(!d.isObject(e)||"function"!=typeof e.initialize)throw new h.StickError("component should be a function or an object");n=d.inherits(g.BaseComponent,e)}m.component(t,n)}function a(t,e){m.attribute(t,e)}function c(t,e){if(d.has(b,t))throw new Error("decorator called "+t+" already defined!");b[t]=e}function u(t,e){m.modifier(t,e)}var l=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){i=!0,o=c}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=n(16),h=n(61),p=n(30),d=n(6),y=n(62),v=n(75),g=n(76),m=n(31),b=n(15);e.service=r,e.factory=i;var w=new v.Container;e.module=o,e.component=s,e.attribute=a,e.decorator=c,e.modifier=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function a(t,e,n){var r=void 0,i=void 0;try{r=y.callFunc(t,e,n)}catch(o){i=o}return[r,i]}var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function m(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:m(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){
t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},f=n(17),h=n(61),p=n(30),d=n(16),y=n(6),v=n(60);s(n(17)),e.tryCatch=a;var g=function(t){function e(t){r(this,e);var n=i(this,Object.getPrototypeOf(e).call(this,t));return n.__instances=new Map,n}return o(e,t),c(e,[{key:"hasInstance",value:function(t){return this.__instances.has(t)}},{key:"hasHandler",value:function(t,n,r){var i=u(Object.getPrototypeOf(e.prototype),"hasHandler",this).call(this,t,n);return!i&&r?p.Repository.hasAny(t):i}},{key:"get",value:function(t,e){return l(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t&&void 0!==t){n.next=2;break}throw new f.DIBadKeyError;case 2:if(t!==f.DIContainer){n.next=4;break}return n.abrupt("return",this);case 4:if(!(t instanceof f.Resolver)){n.next=6;break}return n.abrupt("return",t.get(this));case 6:if(r=this.entries.get(t),void 0===r){n.next=9;break}return n.abrupt("return",r[0](this));case 9:if(!this.parent||!this.parent.hasHandler(t)){n.next=11;break}return n.abrupt("return",this.parent.get(t,e));case 11:if(r=p.Repository.any(t),null==r){n.next=15;break}return this.register(r),n.abrupt("return",this.entries.get(t)[0](this));case 15:if("string"!=typeof t){n.next=17;break}throw new h.StickDependencyError("no component registered for key: "+t);case 17:return this.autoRegister(t,e),r=this.entries.get(t),n.abrupt("return",r[0](this));case 20:case"end":return n.stop()}},n,this)}))}},{key:"registerSingleton",value:function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];return this.registerHandler(t,function(i){if(n.__instances.has(t))return n.__instances.get(t);var o=n.invoke(e,null,r);return y.isPromise(o),n.__instances.set(t,o),o})}},{key:"registerService",value:function(t,e){var n=this,r=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],i=void 0;i="string"==typeof t?t:t.name;var o=i+"Provider",s=f.Metadata.getOwn(d.DIServiceConfig,e,r);if(null!=s){if(this.hasHandler(o,!1,!1))throw new Error("Provider for '"+i+"' already defined");var a=new s;this.registerInstance(o,a)}return this.registerHandler(t,function(i){if(n.__instances.has(t))return n.__instances.get(t);var s=n.invoke(e,null,r);return n.__instances.set(t,s),n.unregister(o),s})}},{key:"registerInstance",value:function(t,n){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];u(Object.getPrototypeOf(e.prototype),"registerInstance",this).call(this,t,n),r&&this.__instances.set(t,n)}},{key:"invoke",value:function(t,e,n){var r=this._getOrCreateConstructionSet(t,n);try{var i,o;return o=r.dependencyResolver?r.dependencyResolver.resolveDependencies(t):this.resolveDependencies(t,n),void 0!==e&&Array.isArray(e)&&(o=o.concat(e)),y.arrayToPromise(o).then(function(e){return r.activator.invoke(t,e,n,i)})}catch(s){var a=r.activator instanceof f.ClassActivator?"instantiating":"invoking",c="Error "+a+" "+t.name+".";throw c+=" Check the inner error for details.",new h.StickDependencyError(c,[s])}}},{key:"clear",value:function(){var t=this.__instances.keys(),e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value;this.destroy(s)}}catch(a){n=!0,r=a}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"destroy",value:function(){var t=arguments.length<=0||void 0===arguments[0]?null:arguments[0],e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null==t){var n=!0,r=!1,i=void 0;try{for(var o,s=this.__instances.keys()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;this.destroy(a,e)}}catch(c){r=!0,i=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw i}}return delete this.constructionInfo,void(this.constructionInfo=new Map)}var u=this.__instances.get(t);u?(e?e(u):"function"==typeof u.$destroy&&u.$destroy(),this.__instances["delete"](t),u=void 0):console.log("could not find key ",t)}},{key:"register",value:function(t){switch(t.type){case d.DependencyType.Controller:var e=new v.ControllerFactory(t.name,t.handler,this.createChild());this.registerInstance(t.name,e,!0);break;case d.DependencyType.Service:this.registerService(t.name,t.handler);break;case d.DependencyType.Factory:"function"==typeof t.handler?(d.setActivator(t.handler,f.FactoryActivator.instance),this.registerSingleton(t.name,t.handler)):this.registerInstance(t.name,t.handler)}}},{key:"createChild",value:function(){var t=new e;return t.parent=this,t}}]),e}(f.DIContainer);e.Container=g},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(6),s=n(33),a=function(){function t(e,n,i,a){r(this,t),this.update&&(this.update=o.bind(this.update,this)),this.section=e,this.vnode=n,this.attributes=i,this.view=a,this.document=a.template.options.document,n.childNodes&&(this.childTemplate=s.template(s.fragment(n.childNodes),a.template.options));for(var c in i)this.setAttribute(c,i[c]);var u=this.view.container;this.initialize.call(this,u)}return i(t,[{key:"initialize",value:function(){}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e}},{key:"removeAttribute",value:function(t){this.attributes[t]=void 0}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"destroy",value:function(){var t=this;"function"==typeof t.onDestroy&&t.onDestroy()}}]),t}();e.BaseComponent=a},function(t,e,n){"use strict";function r(t){var e=document.getElementById(t);return null==e?a.Promise.reject(new Error("template with id: '"+t+"' not found")):a.Promise.resolve(e.innerHTML)}var i=n(74),o=n(78),s=n(31),a=n(6);e.templateResolver=r,i.factory("$templateResolver",function(){return r}),i.factory("$templateCreator",["$templateResolver","$container",function(t,e){return function(t,n){var r=s.compile(t,{viewClass:o.TemplateView}),i=r.view(n,{container:e});return i}}])},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function p(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:p(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=n(49),u=n(64),l=n(6),f=n(23)("stick:template:view"),h=function(t){function e(t,n,o,s){r(this,e);var a=i(this,Object.getPrototypeOf(e).call(this,t,n,null,s));if(a._onModelChange=l.bind(a._onModelChange,a),a.context=o,s.delegator&&(a._delegator=s.delegator),s.container&&(a._container=s.container),a._target=s.target,a._id=l.uniqueId("templ"),!a.container)throw new Error("template view: no container set");return f("%s: Template view created with state %s",a.id,a.context.uid),a}return o(e,t),s(e,[{key:"setTarget",value:function(t){this._target=t}},{key:"_onModelChange",value:function(t){if(void 0==this.context)return void console.log("context is undefined",t,this);this.context.changed;this.update()}},{key:"set",value:function(t,n){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(!r){if(!(this.context instanceof u.Model))return a(Object.getPrototypeOf(e.prototype),"set",this).call(this,t,n),this.update();if(Array.isArray(t)||(t=t.split(/[,.]/)),"this"===t[0])return t.shift(),void(0===t.length?(this.root.context=n,this.root.update()):(this.root.set(t,n),this.root.update()));"root"===t[0]?(t.shift(),this.root.set(t,n)):this.context.set(t.join("."),n)}this.update()}},{key:"render",value:function(){return f("%s: Render",this.id),a(Object.getPrototypeOf(e.prototype),"render",this).call(this)}},{key:"update",value:function(){f("%s: Update",this.id),a(Object.getPrototypeOf(e.prototype),"update",this).call(this)}},{key:"get",value:function(t){f("%s: Get value for key: %j",this.id,t),Array.isArray(t)||(t=t.split(/[,.]/));var n=void 0,r=this.context;return"$root"===t[0]&&(t.shift(),r=this.root.context),t=t.join("."),n||(n=this.context instanceof u.Model?r.get(t):a(Object.getPrototypeOf(e.prototype),"get",this).call(this,t),null==n&&null!=this.target&&(n=this.target[t],"function"==typeof n&&(n=l.bind(n,this.target)))),n}},{key:"remove",value:function(){this._context&&this._context instanceof u.Model&&this._context.off("change",this._onModelChange,this),f("%s: Remove",this.id),a(Object.getPrototypeOf(e.prototype),"remove",this).call(this)}},{key:"$destroy",value:function(){f("%s: Destroy",this.id),this.remove()}},{key:"id",get:function(){return this._id}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}},{key:"container",get:function(){return this._container?this._container:this.parent?this.parent.container:void 0}},{key:"context",set:function(t){this._context&&this._context instanceof u.Model&&this._context.off("change",this._onModelChange,this),this._context=t,null!=t&&t instanceof u.Model&&t.on("change",this._onModelChange,this)},get:function(){return this._context}},{key:"target",get:function(){return this._target?this._target:this.parent?this.parent.target:void 0}}]),e}(c.View);e.TemplateView=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=function(t,e,n,r){var i,s=arguments.length,a=3>s?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(3>s?i(a):s>3?i(e,n,a):i(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},a=n(15),c=n(6),u=function(){function t(){r(this,t)}return i(t,[{key:"get",value:function(t){return c.request.get(t)}},{key:"post",value:function(t){return c.request.post(t)}},{key:"put",value:function(t){return c.request.put(t)}},{key:"del",value:function(t){return c.request.del(t)}}]),t}();u=s([a.service("$http")],u),e.HttpService=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=function(t,e,n,r){var i,s=arguments.length,a=3>s?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(a=(3>s?i(a):s>3?i(e,n,a):i(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},a=n(15),c=n(5),u=function(){function t(){r(this,t),this.emitter=new c.EventEmitter}return i(t,[{key:"publish",value:function(t){for(var e,n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];(e=this.emitter).trigger.apply(e,[t].concat(r))}},{key:"subscribe",value:function(t,e,n){this.emitter.on(t,e,n)}},{key:"unsubscribe",value:function(t,e){this.emitter.off(t,e)}}]),t}();u=s([a.service("$mediator")],u),e.Mediator=u},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),a=n(74),c=function(){function t(e){i(this,t),this._elements=e||[]}return o(t,[{key:"get",value:function(t){return t=void 0===t?0:t,t>=this.length?void 0:this._elements[t]}},{key:"addClass",value:function(t){return this.forEach(function(e){s.addClass(e,t)})}},{key:"removeClass",value:function(t){return this.forEach(function(e){s.removeClass(e,t)})}},{key:"hasClass",value:function(t){return this._elements.reduce(function(e,n){return s.hasClass(n,t)},!1)}},{key:"attr",value:function e(t,n){var e=void 0;if("string"==typeof t&&n)e=r({},t,n);else if("string"==typeof t){if(this.length)return this.get(0).getAttribute(t)}else s.isObject(t)&&(e=t);return this.forEach(function(t){for(var n in e)t.setAttribute(n,e[n])})}},{key:"parent",value:function(){var e=[];return this.forEach(function(t){t.parentElement&&e.push(t.parentElement)}),new t(e)}},{key:"find",value:function(e){var n=[];return this.forEach(function(t){n=n.concat(s.slice(t.querySelectorAll(e)))}),new t(n)}},{key:"forEach",value:function(t){return this._elements.forEach(t),this}},{key:"length",get:function(){return this._elements.length}}]),t}();e.Html=c,a.factory("$html",function(){return function(t,e){"string"==typeof e&&(e=document.querySelectorAll(e));var n=void 0,r=void 0;if("string"==typeof t)if(e){if(!(e instanceof HTMLElement))return n=new c(s.slice(e)),n.find(t);r=s.slice(e.querySelectorAll(t))}else r=s.slice(document.querySelectorAll(t));else t&&t instanceof Element?r=[t]:t&&t instanceof NodeList&&(r=s.slice(t));return new c(r)}})},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var i=n(74);r(n(78));var o=n(83),s=n(84),a=n(85),c=n(86),u=n(87),l=n(88);i.component("controller",o.Controller),i.component("repeat",s.Repeat),i.component("hide",a.Hide),i.component("show",a.Show),i.component("unsafe",c.Unsafe),i.component("delegate",u.Delegate),i.component("view",l.View),r(n(76))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function p(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:p(i,e,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},c=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},u=n(6),l=n(76),f=n(60),h=function(t){function e(){return r(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),s(e,[{key:"initialize",value:function(){this.attributes.name&&(this.name=this.attributes.name,this.as=this.attributes.as||this.name)}},{key:"update",value:function(){return c(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,i,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.factory){t.next=7;break}if(!this.factory.container.hasHandler("template")){t.next=6;break}return t.next=4,this.factory.container.get("template");case 4:e=t.sent,e.update();case 6:return t.abrupt("return");case 7:if(!this.resolving){t.next=9;break}return t.abrupt("return");case 9:return this.resolving=!0,t.next=12,this.view.container.get(this.name);case 12:if(this.factory=t.sent,this.factory instanceof f.ControllerFactory){t.next=15;break}throw new Error(this.name+" is not a controller");case 15:if(n=this.childTemplate,this.attributes.template&&(n=this.attributes.template),r={},this.attributes.state){i=this.attributes.state;try{r=u.isString(i)?JSON.parse(i):Object(i)}catch(a){console.warn("Could not parse model tag")}}return t.next=21,this.factory.create({template:n,contextName:this.as,parentView:this.view,state:r});case 21:return o=t.sent,t.next=24,this.factory.container.get("$el");case 24:s=t.sent,this.section.appendChild(s),this.resolving=!1;case 27:case"end":return t.stop()}},t,this)}))}},{key:"destroy",value:function(){this.factory&&(this.factory.destroy(),this.factory=void 0),a(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(l.BaseComponent);e.Controller=h},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=n(64);e.Repeat={initialize:function(){this._children=[],this._collection=[]},update:function(){var t=(this.as,this.each);this.key||"key",this.view;t!==this._collection&&t&&(this._collection&&this._collection instanceof i.Collection&&this.__removeEventListeners(this._collection),this._collection=t,this._update(),t instanceof i.Collection&&this.__addEventListeners(t))},_update:function(){var t,e=this.as,n=this.view,o=0,s=this.filter||function(t){return!0};this._collection.forEach(function(a){if(s(a)){var c;if(e){var u;t=new i.NestedModel((u={},r(u,e,a),r(u,"self",this.view.context),u))}else t=a;o>=this._children.length?(c=this.childTemplate.view(t,{parent:n}),this._children.push(c),this.section.appendChild(c.render(t))):(c=this._children[o],c.context=t,c.update()),o++}},this),this._children.splice(o).forEach(function(t){t.$destroy()})},__addEventListeners:function(t){t.on("add",this._update,this),t.on("remove",this._update,this),t.on("reset",this._update,this),t.on("filter",this._update,this)},__removeEventListeners:function(t){t.off("remove",this._update),t.off("add",this._update),t.off("reset",this._update),t.off("filter",this._update)},setAttribute:function(t,e){this[t]=e},setProperty:function(){console.log(arguments)},onDestroy:function(){this._collection&&"function"==typeof this._collection.destroy&&this._collection.destroy();var t=!0,e=!1,n=void 0;try{for(var r,i=this._children[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.$destroy()}}catch(s){e=!0,n=s}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}}},function(t,e){"use strict";e.Show={initialize:function(){},update:function(){var t=this.attributes.when;return this._show===t?void(this._subview&&this._subview.update()):(this._show=t,void(t?this._subview||(this._subview=this.childTemplate.view(this.view.context,{parent:this.view}),this.section.appendChild(this._subview.render())):(this._subview&&this._subview.$destroy(),this._subview=void 0)))},onDestroy:function(){this._subview&&this._subview.$destroy()}},e.Hide={initialize:function(){},update:function(){var t=this.attributes.when;return this._hide===t?void(this._subview&&this._subview.update()):(this._hide=t,void(t?(this._subview&&this._subview.$destroy(),this._subview=void 0):this._subview||(this._subview=this.childTemplate.view(this.view.context,{parent:this.view}),this.section.appendChild(this._subview.render()))))},onDestroy:function(){this._subview&&this._subview.$destroy()}}},function(t,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.Unsafe={initialize:function(){},update:function(){var t=this.attributes.html;if("object"===("undefined"==typeof t?"undefined":n(t))&&t.evaluate&&(t=void 0),this.currentValue&&this.currentValue===t)return void(this.currentValue.__isView&&this.currentValue.update(this.currentValue.context));if(this.currentValue&&this.currentValue.remove&&this.currentValue.remove(),this.currentValue=t,!t)return this.section.removeChildNodes();var e;if(t.render)t.remove(),e=t.render();else if(null!=t.nodeType)e=t;else{var r=this.document.createElement("div");r.innerHTML=String(t),e=this.document.createDocumentFragment();for(var i=Array.prototype.slice.call(r.childNodes),o=0,s=i.length;s>o;o++)e.appendChild(i[o])}this.section.removeChildNodes(),this.section.appendChild(e)},onDestroy:function(){this._subview&&this._subview.remove()}}},function(t,e,n){"use strict";var r=n(49),i=n(6);e.Delegate={initialize:function(t){this._onEvent=i.bind(this._onEvent,this);var e=this.childTemplate.view(this.view.context,{parent:this.view});this._subview=e,this._container=this.document.createElement("div"),this._container.appendChild(e.render()),this.section.appendChild(this._container),i.delegate(this._container,this.attributes.selector,"click",this._onEvent)},update:function(){},_onEvent:function(t){var e=this.attributes.click;if(e instanceof r.Assignment&&(e=e.assign),"function"!=typeof e)throw new Error("[event] value is not a function");e(t)},onDestroy:function(){i.undelegate(this._container,this.attributes.selector,"click",this._onEvent),this._subview.$destroy()}}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(e){o(e)}}function a(t){try{c(r["throw"](t))}catch(e){o(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e)).next())})},c=n(76),u=function(t){function e(){var t;r(this,e);for(var n=arguments.length,o=Array(n),s=0;n>s;s++)o[s]=arguments[s];var a=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(o)));return a.resolving=!1,a}return o(e,t),s(e,[{key:"update",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.subview){t.next=2;break}return t.abrupt("return",this.subview.update());case 2:if(!this.resolving){t.next=4;break}return t.abrupt("return");case 4:if(this.resolving=!0,e=this.attributes.template,e&&""!=e){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,this.view.container.get("$templateCreator");case 10:return n=t.sent,t.next=13,this.view.container.get("$templateResolver");case 13:return r=t.sent,t.next=16,r(e);case 16:i=t.sent,o=n(i,this.view.context),o.parent=this.view,this.subview=o,this.section.appendChild(o.render()),this.resolving=!1;case 22:case"end":return t.stop()}},t,this)}))}}]),e}(c.BaseComponent);e.View=u}])});